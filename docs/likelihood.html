<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>17&nbsp; Maximum-Likelihood (MLE) – Skriptum - Fortgeschrittene Statistik</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./mlm_title.html" rel="next">
<link href="./slm_prediction.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-70a47bd5681a7291082a5b9f83d58762.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>
<script>

  MathJax = {

    tex: {

      tags: 'ams'  // should be 'ams', 'none', or 'all'

    }

  };

</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./slm_title.html">Das einfache Regressionmodell</a></li><li class="breadcrumb-item"><a href="./likelihood.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Maximum-Likelihood (MLE)</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Skriptum - Fortgeschrittene Statistik</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vorwort</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./r_startup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Eine Einführung in die Programmiersprache R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Eine Übersicht über <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_vars_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Variablen und Datentypen in <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_flowcontrol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Ablaufkontrolle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Funktionen in <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Datenverarbeitung mit <code>tidyverse</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Datenvisualisierung mit <code>ggplot2</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_literate_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Literate programming in <code>R</code></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stats_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistik - Die Grundlagen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Eine kleine Welt der Unsicherheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_significance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Statistische Signifikanz</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Hypothesentests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Theoretische Verteilungen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_hypotheses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Weitere Grundlagen der Statistik</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./slm_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Das einfache Regressionmodell</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Einführung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Inferenz</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_model_fit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Modellfit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Vorhersage</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./likelihood.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Maximum-Likelihood (MLE)</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./mlm_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Einführung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_interactions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Interaktionseffekte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_dummy_coding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Integration von nominalen Variablen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_hierarchies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Modellhierarchien</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Polynome und Prädiktion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_lmm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Gemischte Lineare Modelle</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ed_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelles Design</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Einführung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_reliability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Messfehler und Reliabilität</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_crd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Completely Randomized Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_linear_contrasts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Lineare Kontraste</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_crfd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Completely Randomized Factorial Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_ancova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_crbd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Block Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_split_plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Split-Unit Designs</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix_math.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Mathematische Grundlagen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literatur</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#likelihood" id="toc-likelihood" class="nav-link active" data-scroll-target="#likelihood"><span class="header-section-number">17.1</span> Likelihood</a></li>
  <li><a href="#maximum-likelihood-methode-bei-der-einfachen-linearen-regression" id="toc-maximum-likelihood-methode-bei-der-einfachen-linearen-regression" class="nav-link" data-scroll-target="#maximum-likelihood-methode-bei-der-einfachen-linearen-regression"><span class="header-section-number">17.2</span> Maximum-likelihood Methode bei der einfachen linearen Regression</a>
  <ul class="collapse">
  <li><a href="#maximum-likelihood-bei-der-einfachen-regression-in-r" id="toc-maximum-likelihood-bei-der-einfachen-regression-in-r" class="nav-link" data-scroll-target="#maximum-likelihood-bei-der-einfachen-regression-in-r"><span class="header-section-number">17.2.1</span> Maximum-likelihood bei der einfachen Regression in <code>R</code></a></li>
  </ul></li>
  <li><a href="#take-away" id="toc-take-away" class="nav-link" data-scroll-target="#take-away"><span class="header-section-number">17.3</span> Take-away</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./slm_title.html">Das einfache Regressionmodell</a></li><li class="breadcrumb-item"><a href="./likelihood.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Maximum-Likelihood (MLE)</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Maximum-Likelihood (MLE)</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Bei der Herleitung der Gerade bei der einfachen linearen Regression wurde zunächst ein Kriterium angesetzt, die Minimierung der quadrierten Abweichungen der beobachteten Punkte <span class="math inline">\(Y_i\)</span> von den auf der Gerade liegenden vorhergesagten Punkten <span class="math inline">\(\hat{Y}_i\)</span>, den Residuen. Bei diesem Ansatz sind zunächst keine statistischen Überlegungen notwendig gewesen. Anschließend im Rahmen der Inferenz zu den Modellparametern <span class="math inline">\(\beta_0\)</span> und <span class="math inline">\(\beta_1\)</span> wurde dann die Modellannahme der Normalverteilung der Residuen <span class="math inline">\(\epsilon_i \sim \mathbf{N}(0,\sigma^2)\)</span> dazugenommen um eine statistische Analyse der Modellkoeffizienten und der statistischer Signifikanz bzw. Hypothesentestung einzuführen. Im folgenden wird eine alternative Herleitung entwickelt über die Maximum-Likelihood Methode. Diese Herleitung bildet dabei ein grundlegendes Verfahren, dass im Fall der linearen Regression zu den gleichen Ergebnissen kommt, aber einen allgemeineren Ansatz darstellt der dann auch im späteren Verlauf die Betrachtung von Modellen erlaubt die mit dem RMS Ansatz nicht möglich sind.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tipp
</div>
</div>
<div class="callout-body-container callout-body">
<p>Um den folgenden Inhalten einfacher folgen zu können, kann es sinnvoll sein, sich noch einmal kurz die Inhalte aus <a href="appendix_math.html" class="quarto-xref"><span>Anhang A</span></a> aus den Abschnitten Logarithmus, Ableitungen und Extremwerte zu vergegenwärtigen.</p>
</div>
</div>
<section id="likelihood" class="level2" data-number="17.1">
<h2 data-number="17.1" class="anchored" data-anchor-id="likelihood"><span class="header-section-number">17.1</span> Likelihood</h2>
<p>Im ersten Schritt muss zunächst der Begriff des Likelihood erarbeitet werden. Die Likelihood ist eng mit dem Konzept der Dicht- bzw. Wahrscheinlichkeitfunktion verbunden. Sei zum Beispiel nochmal das Beispiel des n-fachen MÜnzwurfes betrachtet, welches mit Hilfe der Binomialverteilung (siehe <a href="stats_distributions.html#eq-binom-distribution" class="quarto-xref">Gleichung&nbsp;<span>11.4</span></a>) beschrieben werden kann.</p>
<p><span class="math display">\[
\text{Binom}(Y, N, p) = P(Y = y \mid N, p) = \binom{N}{y}p^y (1-p)^{N-y} = \binom{N}{y}p^y q^{N-y}
\]</span></p>
<p>Hier ist <span class="math inline">\(Y\)</span> die Anzahl der Köpfe, <span class="math inline">\(N\)</span> die Anzahl der Würfe und <span class="math inline">\(p\)</span> die Wahrscheinlichkeit bei einem Wurf Kopf zu beobachten. In <a href="#fig-likelihood-binom-1" class="quarto-xref">Abbildung&nbsp;<span>17.1</span></a> ist die Binomialverteilung für den Fall <span class="math inline">\(N = 10, p = 0.05\)</span> dargestellt.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-likelihood-binom-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-likelihood-binom-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="likelihood_files/figure-html/fig-likelihood-binom-1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-likelihood-binom-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.1: Beispiel für die Binomialverteilungen mit <span class="math inline">\(N=10, p=0.5\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Nun kann die Schreibweise <span class="math inline">\(\text{Binom}(Y,N,p)\)</span> etwas umgeändert werden, wenn für der Parameter <span class="math inline">\(p\)</span> durch <span class="math inline">\(\theta\)</span> ersetzt werden. Dies hat inhaltlich keine Folgen sondern ist lediglich eine Änderung der Schreibweise. Es folgt <span class="math inline">\(\text{Binom}(Y,N,p)=\text{Binom}(Y,N,\theta)\)</span>. Seien nun die Daten <span class="math inline">\(y\)</span> beobachtet worden. D.h. es wurde ein <em>Münzexperiment</em>, z.B. <span class="math inline">\(N = 10\)</span>-mal durchgeführt worden und es wurde sechsmal Kopf beobachtet worden, d.h. <span class="math inline">\(y = 6\)</span>. Der unbekannte Parameter in <span class="math inline">\(\text{Binom}\)</span> ist nun lediglich <span class="math inline">\(\theta\)</span>, da <span class="math inline">\(\text{Binom}(6, 10, \theta)\)</span> gilt. Wird zunächst die Reihenfolge der Parameter nach <span class="math inline">\(\text{Binom}(\theta, 6, 10)\)</span> geändert, kann dieser Ausdruck als Funktion von <span class="math inline">\(\theta\)</span> interpretiert werden. Wenn nun noch die Werte <span class="math inline">\(y = 6\)</span> und <span class="math inline">\(N = 10\)</span> als <em>gegeben</em> interpretiert werden, dann wird eine Funktion <span class="math inline">\(\text{Binom}(\theta)\)</span> erhalten. D.h. in Verbindung mit einem beobachteten Datensatz, durch den zwei der drei Parameter von <span class="math inline">\(\text{Binom}\)</span> definiert werden, wird eine <em>neue</em> Funktion erhalten, welche nur noch einen Parameter <span class="math inline">\(\theta\)</span> besitzt. Dieser Parameter war ursprüngliche das <span class="math inline">\(p\)</span>, die Wahrscheinlichkeit Kopf bei einem Wurf zu beobachten, wird nun aber mit dem Symbol <span class="math inline">\(\theta\)</span> bezeichnet. Diese Umbenennung erscheint zunächst als überflüssige Arbeit, hilft im weiteren Verlauf, da beispielsweise in der Literatur die Konvention herrscht den <em>freien</em> Parameter der Likelihood-Funktion mit dem Symbol <span class="math inline">\(\theta\)</span> zu bezeichnen. Wird nun noch eine weitere Umbenennung vorgenommen, und <span class="math inline">\(\text{Binom}\)</span> durch das Symbol <span class="math inline">\(\mathcal{L}\)</span> ersetzt, wird aus <span class="math inline">\(\text{Binom}(\theta) \equiv \mathcal{L}(\theta)\)</span>. Das stylisierte L in <span class="math inline">\(\mathcal{L}\)</span> steht dann, entsprechend für Likelihood.</p>
<p>Die Likelihood-Funktion <span class="math inline">\(\mathcal{L}(\theta)\)</span> kann nun entsprechend für verschiedene Wert von <span class="math inline">\(\theta\)</span>, im vorliegenden Fall <span class="math inline">\(p\)</span> Kopf, abgetragen werden, wenn die beobachteten Daten <span class="math inline">\(X\)</span> als gegeben angesehen werden. In <a href="#fig-likelihood-binom-2" class="quarto-xref">Abbildung&nbsp;<span>17.2</span></a> ist die Likelihood-Funktion nun für Werte zwischen <span class="math inline">\(0\)</span> und <span class="math inline">\(1\)</span> für <span class="math inline">\(\theta\)</span> abgetragen.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-likelihood-binom-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-likelihood-binom-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="likelihood_files/figure-html/fig-likelihood-binom-2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-likelihood-binom-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.2: Likelihood <span class="math inline">\(\mathcal{L}(\theta)\)</span> für <span class="math inline">\(N=10, y=6\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Zunächst fällt auf, dass im Unterschied zu <a href="#fig-likelihood-binom-1" class="quarto-xref">Abbildung&nbsp;<span>17.1</span></a> der Graph in diesem Fall kontinuierlich ist. Die Wahrscheinlichkeitsfunktion der Binomialverteilung ist diskrete, da Wahrscheinlichkeiten für eine endliche Anzahl von Ausgängen (=Anzahl der Köpfe) berechnet werden. Im Gegensatz dazu, ist der Likelihood-Graph kontinuierlich, da er eine Funktion von <span class="math inline">\(\theta\)</span> ist und in diesem Fall <span class="math inline">\(\theta\)</span> alle Werte in <span class="math inline">\([0,1]\)</span> annehmen kann.</p>
<p>Der Likelihood-Graph ändert sich nun entsprechend, wenn ein anderes Ergebnis beobachtet wird. Seien zum Beispiel bei <span class="math inline">\(N = 10\)</span> Würfen nur drei Köpfe (<span class="math inline">\(y = 3\)</span>) beobachte worden ergibt sich der folgende Graph:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-likelihood-binom-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-likelihood-binom-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="likelihood_files/figure-html/fig-likelihood-binom-3-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-likelihood-binom-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.3: Likelihood <span class="math inline">\(\mathcal{L}(\theta)\)</span> für <span class="math inline">\(N=10, y=3\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-likelihood-binom-3" class="quarto-xref">Abbildung&nbsp;<span>17.3</span></a> ist zu sehen, dass sich die Form der Likelihood-Funktion <span class="math inline">\(\mathcal{L}(\theta)\)</span> verändert hat. D.h. die Ausprägung des Likelihood-Graphen ist immer von den als gegeben angenommen Daten <span class="math inline">\(Y\)</span> abhängig. Die zentrale Einsicht ist aber immernoch, dass die ursprüngliche Dichte- bzw. Wahrscheinlichkeitsfunktion als eine Funktion eines Modellparameters interpretiert werden, während die beobachteten Daten als fixiert angesehen werden. Insgesamt kann nun eine Definition für die Likelihood gegeben werden.</p>
<div id="def-likelihood" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 17.1 (Likelihood )</strong></span> Seien <span class="math inline">\(X\)</span> die beobachtete Daten und <span class="math inline">\(\theta\)</span> ein unbekannter Parameter eines statistischen Modells. Die <strong>Likelihood-Funktion</strong> <span class="math inline">\(\mathcal{L}(\theta)\)</span> ist die Wahrscheinlichkeit (bzw. Dichte) der beobachteten Daten, aufgefasst als Funktion des Parameters <span class="math inline">\(\theta\)</span>:</p>
<p><span class="math display">\[\begin{align*}
\mathcal{L}(\theta) &amp;= P(\theta \mid X = x) \quad \text{diskrete Verteilung} \\
\mathcal{L}(\theta) &amp;= f_X(\theta \mid X = x) \quad \text{kontinuierliche Verteilung}
\end{align*}\]</span></p>
<p>Die Daten <span class="math inline">\(X\)</span> werden als <strong>fixiert</strong> betrachtet, während der Parameter <span class="math inline">\(\theta\)</span> variiert. Die Likelihood <span class="math inline">\(\mathcal{L}\)</span> misst, wie plausibel verschiedene Parameterwerte <span class="math inline">\(\theta\)</span>, für die gegeben Daten <span class="math inline">\(X\)</span>, sind.</p>
</div>
<p>Eine wichtige Eigenschaft der Likelihood ist, dass es sich <strong>nicht um Wahrscheinlichkeitsverteilung</strong> handelt. Das Integral <span class="math inline">\(\int \mathcal{L}(\theta)d\theta\)</span> ist nicht <span class="math inline">\(1\)</span> wie es für eine Dichtefunktion notwendig wäre.</p>
<p>Nun stellt sich daher die Frage wofür die Likelihood-Funktion <span class="math inline">\(\mathcal{L}(\theta)\)</span> überhaupt nützlich ist. Die Antwort ist, dass sich mit Hilfe der Likelihood-Funktion Vergleiche anstellen lassen, wie <em>plausibel</em> verschiedene Wert für <span class="math inline">\(\theta\)</span> unter den beobachteten Daten sind. <span class="math inline">\(\mathcal{L}(\theta)\)</span> ermöglicht es, denjenigen Parameterwert zu bestimmen, für den die Wahrscheinlichkeit der beobachteten Daten maximal wird. In <a href="#fig-likelihood-binom-1" class="quarto-xref">Abbildung&nbsp;<span>17.1</span></a> zeigt <span class="math inline">\(\mathcal{L}(\theta)\)</span> ein Maximum für <span class="math inline">\(p \equiv \theta = 0.6\)</span>. Dagegen ist im zweiten Beispiel in <a href="#fig-likelihood-binom-2" class="quarto-xref">Abbildung&nbsp;<span>17.2</span></a> das Maximum bei <span class="math inline">\(\theta = 0.3\)</span>. Das Maximum von <span class="math inline">\(\mathcal{L}(\theta)\)</span> kann nun als derjenige Wert von <span class="math inline">\(\theta\)</span> interpretiert werden, der unter den beobachteten Daten als <em>plausibelsten</em> erscheint. D.h. die Frage nach dem Besten Modellparameterwert, wird nun eine Optimierungsaufgabe für die Likelihood-Funktion <span class="math inline">\(\mathcal{L}(\theta)\)</span>. Die Likelihood-Funktion wird verwendet um einen Schätzer für den Modellparameter <span class="math inline">\(\theta\)</span> zu erhalten. Unter dieser Betrachungsweise wird damit auch das Konzept des <em>Maximum Likelihood-Schätzers</em> einsehbar.</p>
<div id="def-maximum-likelihood" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 17.2 (Maximum-Likelihood )</strong></span> Seien <span class="math inline">\(x\)</span> die beobachteten Daten und <span class="math inline">\(\theta\)</span> ein unbekannter Parameter eines statistischen Modells mit Likelihood-Funktion <span class="math inline">\(\mathcal{L}(\theta)\)</span>. Der <strong>Maximum-Likelihood-Schätzer (ML-Schätzer)</strong> ist derjenige Parameterwert <span class="math inline">\(\hat{\theta}\)</span>, der die Likelihood maximiert:</p>
<p><span class="math display">\[
\hat{\theta} = \arg\max_{\theta} \mathcal{L}(\theta).
\]</span></p>
<p>Das heißt: Der Maximum-Likelihood-Schätzer ist der Parameterwert, unter dem <strong>die beobachteten Daten am wahrscheinlichsten sind</strong>.</p>
</div>
<p>Sei nun wieder das Beispiel der Binomialverteilung gegeben und es wurden bei <span class="math inline">\(N = 10\)</span> insgesamt sechsmal Kopf (<span class="math inline">\(y = 6\)</span>) beobachtet. Angewendet auf <a href="stats_distributions.html#eq-binom-distribution" class="quarto-xref">Gleichung&nbsp;<span>11.4</span></a> ergibt sich somit.</p>
<p><span class="math display">\[
\mathcal{L}(\theta) = \binom{10}{6}\theta^6 (1-\theta)^{10-6} = \binom{10}{6}\theta^6(1-\theta)^4
\]</span></p>
<p>Für diese Funktion soll nun das Maximum bestimmt werden. Allerdings ist das direkte Maximieren der Likelihood-Funktion rechnerisch oft aufwendig. Um sich dies zu vereinfachen wird ein mathematischer Trick angewendet. Es ist möglich unter bestimmten Voraussetzungen, die die Logarithmusfunktion erfüllt (siehe Anhang A), das Maximum einer Funktion <span class="math inline">\(f(x)\)</span> bzw. im vorliegenden Fall <span class="math inline">\(\mathcal{L}(\theta)\)</span> zu bestimmen nachdem die Logarithmusfunktion <span class="math inline">\(log(x)\)</span> auf <span class="math inline">\(f(x)\)</span> angewendet wurde. D.h. es wird eine neue Funktion <span class="math inline">\(log(f(x))\)</span> verwendet. Dies wird gemacht, da der Logarithmus, nach den Rechenregeln <span class="math inline">\(\log(a\cdot b) = \log(a) + \log(b)\)</span> aus der Multiplikation eine Addition macht. Angewendet auf die Likelihood-Funktion resultiert daraus der Loglikelihood <span class="math inline">\(\ell(\theta) = \log \mathcal{L}(\theta)\)</span>.</p>
<p>Angewendet auf den vorliegenden Fall führt dieser Ansatz zu unter Beachtung einer weiteren Rechenregel für den Logarithmus <span class="math inline">\(\log(a^b) = b\log(a)\)</span>:</p>
<p><span class="math display">\[\begin{align*}
\ell(\theta) &amp;= \log \mathcal{L}(\theta) \\
&amp;= \log\left(\binom{10}{6}\cdot \theta^6 \cdot (1-\theta)^{4}\right) \\
&amp;= \log\left(\binom{10}{6}\right) + \log\left(\theta^6\right) + \log\left((1-\theta)^{4}\right) \\
&amp;= \log \binom{10}{6} + 6 \log(\theta) + 4\log(1-p)
\end{align*}\]</span></p>
<p>Um nun das Maximum dieser Funktion zu bestimmen, muss die Ableitung berechnet werden und gleich Null gesetzt werden. Bei der Berechnung der Ableitung kann der erste Term direkt gestrichen werden, da es sich um eine Konstante handelt, deren Ableitung gleich Null ist. Dadurch erhält man die Gleichung unter Beachtung das <span class="math inline">\(\frac{d \log(x)}{dx} = \frac{1}{x}\)</span> und der Kettenregel (siehe Anhang A):</p>
<p><span class="math display">\[
\frac{d \ell{\theta}}{d\theta} = \frac{6}{\theta} - \frac{4}{1-p} = 0.
\]</span></p>
<p>Durch Umformen folgt daraus:</p>
<p><span class="math display">\[
\hat{\theta} = \frac{6}{10}.
\]</span></p>
<p>Dieses Ergebnis sollte intuitiv auch nachvollziehbar sein, wenn bei <span class="math inline">\(N = 10\)</span> Münzwürfen sechsmal Kopf beobachtet wurde, dann ist der <em>beste</em> Schätzer wohl <span class="math inline">\(\hat{p} = \hat{\theta} = \frac{y}{N}\)</span>. Der Maximum-Likelihood-Schätzer für die Erfolgswahrscheinlichkeit <span class="math inline">\(p\)</span> ist also der Anteil der beobachteten Erfolge an der Gesamtzahl der Versuche und entspricht genau der relativen Häufigkeit der Erfolge. Die Maximum-Likelihood-Methode liefert in diesem Fall also ein Ergebnis, das sehr gut mit unserer intuitiven Vorstellung übereinstimmt.</p>
<p>Im Zuge der theoretischen Verteilungen wird die Dichtefunktion betrachtet. Für eine gegebene Zufallsvariable kann die Dichte für einen gegebenen Wert, z.B. <span class="math inline">\(y_i\)</span>, über die Dichtefunktion berechnet werden. Wenn eine Zufallsvariable <span class="math inline">\(X\)</span> einer Normalverteilung folgt, wird die Verteilung von <span class="math inline">\(X\)</span> mittels der bekannten Dichtefunktion der Normalverteilung beschrieben:</p>
<p><span class="math display">\[\begin{equation*}
f(X|\mu,\sigma^2) = \frac{1}{\sqrt{2 \pi \sigma^2}} \exp\left(-\frac{1}{2}\frac{(X - \mu)^2}{\sigma^2}\right)
\end{equation*}\]</span></p>
<p>Hier wird die Dichte von <span class="math inline">\(X\)</span> als eine Funktion von <span class="math inline">\(\mu\)</span> und <span class="math inline">\(\sigma^2\)</span> aufgefasst. Das bedeutet, die Werte für <span class="math inline">\(\mu\)</span> und <span class="math inline">\(\sigma\)</span> müssen vorgegeben sein, da diese benötigt werden, um die Dichte zu berechnen.</p>
<p>Für die Likelihood erfolgt nun wieder der Perspektivwechsel. Die Zufallsvariable <span class="math inline">\(X\)</span> wird als gegeben angesehen und die Dichte für verschiedene Werte von <span class="math inline">\(\mu\)</span> und <span class="math inline">\(\sigma^2\)</span> abzutragen. Der Einfachheit halber wird angenommen, dass <span class="math inline">\(\sigma^2\)</span> ebenfalls bekannt und konstant ist. Die Problemstellung ist nun, analog zu dem Binomialbeispiel, einen Wert für <span class="math inline">\(\mu\)</span> zu ermitteln der am plausibelsten ist. Dazu können nun wieder verschiedene Dichtewerte für ein gegebenes <span class="math inline">\(x\)</span> in Abhängigkeit von <span class="math inline">\(\mu\)</span> darstellen, also die Likelihood.</p>
<p><span class="math display">\[
\mathcal{L}(\mu) = f(\mu|x,\sigma^2) = \frac{1}{\sqrt{2 \pi \sigma^2}} \exp\left(-\frac{1}{2}\frac{(X - \mu)^2}{\sigma^2}\right)
\]</span></p>
<p>Das Maximum dieser Funktion stellt dementsprechend wieder den Maximumlikelihood-Wert dar und ist derjenige Wert der am plausibelsten ist.</p>
<p>Sei der Wert <span class="math inline">\(x = 3\)</span> beobachtet, und es ist bekannt, dass <span class="math inline">\(\sigma = 1\)</span> ist. Natürlich reicht ein einzelner Wert nicht aus, um definitive Aussagen zu treffen, aber das Prinzip soll verdeutlicht werden. Eine Tabelle wird erstellt, die verschiedene Werte von <span class="math inline">\(\mu_i = [0,1,2,3,4,5,6]\)</span> enthält und die Likelihood <span class="math inline">\(\mathcal{L}(\mu) = f(\mu|x=3,\sigma^2=1)\)</span> für jeden dieser Werte berechnet (siehe <a href="#tbl-slm-inf-ml-01" class="quarto-xref">Tabelle&nbsp;<span>17.1</span></a>).</p>
<div class="cell">
<div id="tbl-slm-inf-ml-01" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-slm-inf-ml-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;17.1: Likelihood für verschiedene Werte für <span class="math inline">\(\mu\)</span> für <span class="math inline">\(x = 3\)</span>
</figcaption>
<div aria-describedby="tbl-slm-inf-ml-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;"><span class="math inline">\(\mu\)</span></th>
<th style="text-align: right;">Dichte</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.004</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.054</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.242</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.399</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.242</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.054</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.004</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Beim Betrachten der Werte in <a href="#tbl-slm-inf-ml-01" class="quarto-xref">Tabelle&nbsp;<span>17.1</span></a> zeigt sich, dass der Wert bei <span class="math inline">\(\mu = 3\)</span> die größte Dichte aufweist. Um dies weiter zu verdeutlichen, wird das Ganze als kontinuierlicher Graph dargestellt (siehe <a href="#fig-likelihood-normal-01" class="quarto-xref">Abbildung&nbsp;<span>17.4</span></a>)</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-likelihood-normal-01" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-likelihood-normal-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="likelihood_files/figure-html/fig-likelihood-normal-01-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-likelihood-normal-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.4: Likelihood-Funktion von <span class="math inline">\(\mathcal{L}(\mu) = \frac{1}{\sqrt{2 \pi}} \exp\left(-\frac{1}{2}(3 - \mu)^2\right)\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-likelihood-normal-01" class="quarto-xref">Abbildung&nbsp;<span>17.4</span></a> ist zu erkennen, dass das Maximum der Likelihood-Funktion beim Wert <span class="math inline">\(\mu = 3\)</span> liegt. Die Normalverteilung mit <span class="math inline">\(\mathcal{N}(\mu=3, \sigma=1)\)</span> ist diejenige, die die höchste Dichte produziert und daher auch die höchste Likelihood hat, den beobachteten Wert zu erzeugen. Dies ist intuitiv nachvollziehbar: Wenn ein Wert aus einer Normalverteilung stammt und nur ein einziger Wert vorliegt, macht es Sinn, diejenige Normalverteilung mit dem Mittelwert <span class="math inline">\(\mu\)</span> zu wählen, die an der Stelle des beobachteten Werts liegt.</p>
<p>Sei diese Beispiel erweitert: Es werden zwei Werte <span class="math inline">\(x_1 = 1\)</span> und <span class="math inline">\(x_2 = 2\)</span> beobachtet. Es wird angenommen, dass beide Werte unabhängig voneinander sind und aus der gleichen Normalverteilung stammen. Dadurch das die Wert unabhängig voneinander sind, die Dichten für die beiden Werte miteinander multipliziert werden. Analog wie bei zwei Münzwürfen, die Wahrscheinlichkeit Kopf für beide Münzen zu beobachten ist <span class="math inline">\(P(KK) = \frac{1}{2}\cdot \frac{1}{2} = \frac{1}{4}\)</span>. Die Likelihood-Funktion <span class="math inline">\(\mathcal{L}\)</span> folgt dementsprechend:</p>
<p><span class="math display">\[\begin{equation*}
\mathcal{L} = f(\mu|x_1,\sigma) \cdot f(\mu|x_2,\sigma)
\end{equation*}\]</span></p>
<p>Ein Graph von <span class="math inline">\(\mathcal{L}\)</span> für verschiedene <span class="math inline">\(\mu\)</span> bei gegebenem <span class="math inline">\(\sigma = 1\)</span> hat die folgende Form (<a href="#fig-likelihood-normal-02" class="quarto-xref">Abbildung&nbsp;<span>17.5</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-likelihood-normal-02" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-likelihood-normal-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="likelihood_files/figure-html/fig-likelihood-normal-02-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-likelihood-normal-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.5: Likelihood-Funktion <span class="math inline">\(L\)</span> für <span class="math inline">\(x_1 = 1\)</span> und <span class="math inline">\(x_2 = 2\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <span class="quarto-unresolved-ref">?fig-slm-inf-ml-02</span> liegt das Maximum von <span class="math inline">\(L\)</span> bei <span class="math inline">\(\mu = 1.5\)</span>, was dem Mittelwert <span class="math inline">\(\bar{x} = \frac{1}{2}\sum_{i=1}^2 x_i\)</span> entspricht. Intuitiv ist dies nachvollziehbar: Wenn beiden Werten die gleiche Bedeutung zugemessen wird, liegt die Verteilung, die genau in der Mitte zwischen den beiden Werten liegt, am ehesten mit der Erzeugung der beiden Werte im Einklang.</p>
<p>Die Berechnung führt zum gleichen Ergebnis. Es wird wieder der Loglikelihood <span class="math inline">\(\log\mathcal{L}\)</span> verwendet und der Konsistenz wegen wird das Symbol <span class="math inline">\(\mu\)</span> durch das Symbol <span class="math inline">\(\theta\)</span> ersetzt und <span class="math inline">\(\sigma^2=1, x_1=1, x_2=2\)</span>.</p>
<p><span class="math display">\[
\begin{align*}
\log\mathcal{L}(\theta) &amp;=  \log\left( \frac{1}{\sqrt{2\pi}}\exp\left(-\frac{1}{2}(1-\theta)^2\right)\frac{1}{\sqrt{2\pi}}\exp\left(-\frac{1}{2}(2-\theta)^2\right)\right) \\
&amp;= \log\left( \left(\frac{1}{\sqrt{2\pi}}\right)^2\exp\left(-\frac{1}{2}(1-\theta)^2\right)\exp\left(-\frac{1}{2}(2-\theta)^2\right)\right) \\
&amp;= \log\left( \left(\frac{1}{\sqrt{2\pi}}\right)^2\exp\left(-\frac{1}{2}(1-\theta)^2 -\frac{1}{2}(2-\theta)^2\right)\right) \\
&amp;= 2 \log\left(\frac{1}{\sqrt{2\pi}}\right) - \frac{1}{2}(1-\theta)^2 -\frac{1}{2}(2-\theta)^2
\end{align*}
\]</span></p>
<p>Dieser Ausdruck wird nun wieder nach <span class="math inline">\(\frac{d}{d\theta}\)</span> abgeleitet wobei der erste Term verschwindet und es folgt.</p>
<p><span class="math display">\[
\begin{align*}
\frac{d}{d\theta}\ell(\theta) &amp;= \frac{d}{d\theta}\left( - \frac{1}{2}(1-\theta)^2 -\frac{1}{2}(2-\theta)^2\right) \\
&amp;= \frac{d}{d\theta}\left( - \frac{1}{2}(1-\theta)^2\right) + \frac{d}{d\theta}\left(-\frac{1}{2}(2-\theta)^2\right) \\
&amp;=  -\frac{1}{2}\cdot 2(1-\theta) \cdot(-1) -\frac{1}{2}\cdot 2(2-\theta)\cdot (-1) \\
&amp;=  (1-\theta) + (2-\theta) \\
&amp;=  3-2\theta \\
\end{align*}
\]</span></p>
<p>Durch Nullsetzen folgt:</p>
<p><span class="math display">\[
3-2\theta = 0 \Leftrightarrow \theta = \frac{3}{2} = 1.5
\]</span></p>
<p>D.h. mit <span class="math inline">\(\theta = \mu\)</span> wurde über die Maximumlikelihood-Methode der gleiche Wert erhalten, welcher auch intuitive am meisten Sinn macht. Allgemein wird also für die Anwendung der Maximumlikelihood-Methode immer ein theoretisches, statistisches Modell benötigt und es wird der plausibelste Modellparameterwert <span class="math inline">\(\theta\)</span> anhand des Modells bestimmt. Dieser Wert ist dann der <strong>Maximumlikelihood-Schätzer</strong> <span class="math inline">\(\hat{\theta}\)</span>.</p>
</section>
<section id="maximum-likelihood-methode-bei-der-einfachen-linearen-regression" class="level2" data-number="17.2">
<h2 data-number="17.2" class="anchored" data-anchor-id="maximum-likelihood-methode-bei-der-einfachen-linearen-regression"><span class="header-section-number">17.2</span> Maximum-likelihood Methode bei der einfachen linearen Regression</h2>
<p>Dieser Ansatz lässt sich auch auf das Modell der einfachen linearen Regression anwenden. Bei der einfachen linearen Regression wird angenommen, dass die <span class="math inline">\(Y\)</span>-Werte für jeden <span class="math inline">\(X\)</span>-Wert einer Normalverteilung mit einer Varianz <span class="math inline">\(\sigma^2\)</span> folgen. Formal:</p>
<p><span id="eq-likelihood-reg-00"><span class="math display">\[
Y_i = \mathcal{N}(\beta_0 + \beta_1 X_i, \sigma^2)
\tag{17.1}\]</span></span></p>
<p>Für einen einzelnen Wert bedeutet dies nun für die Likelihood-Funktion <span class="math inline">\(\mathcal{L}\)</span>:</p>
<p><span id="eq-likelihood-reg-01"><span class="math display">\[
\mathcal{L}(\beta_0, \beta_1, \sigma^2|y_i) = \frac{1}{\sqrt{2\pi\sigma^2}} \exp\left(-\frac{(y_i - \beta_0 - \beta_1 x_i)^2}{2\sigma^2}\right)
\tag{17.2}\]</span></span></p>
<p>In diesem Fall ist also <span class="math inline">\(\theta\)</span> nicht ein einzelnen Wert sondern ein Vektor <span class="math inline">\(\theta = (\beta_0, \beta_1, \sigma^2)\)</span>. Mit einem einzelnen Wert lässt sich <span class="math inline">\(\theta\)</span> nicht bestimmen, da wird nach Ableitung drei Gleichung mit drei Unbekannten erhalten würden, die nicht gelöst werden können. Nun kommt die nächste Annahme zum tragen, nämlich das bei mehreren Werten diesen unabhängig voneinander sind. Dann können die <em>individuellen</em> Likelihoods miteinander multipliziert werden.Dies führt zu einer Gesamt-Likelihood-Funktion <span class="math inline">\(\mathcal{L}\)</span> in der folgenden Form:</p>
<p><span class="math display">\[
\begin{align*}
L(\beta_0, \beta_1, \sigma^2\mid x_i, y_i) &amp;= \prod_{i=1}^{N} f(\beta_0, \beta_1, \sigma^2\mid x_i, y_i) \\
&amp;= \prod_{i=1}^{N} \frac{1}{\sqrt{2\pi\sigma^2}} \exp\left(-\frac{(y_i - \beta_0 - \beta_1 x_i)^2}{2\sigma^2}\right)
\end{align*}
\]</span></p>
<p>Durch Anwendung der Rechenregel <span class="math inline">\(e^a e^b = e^{a+b}\)</span> kann die Formel vereinfacht werden:</p>
<p><span class="math display">\[
\begin{align*}
\mathcal{L}(\beta_0, \beta_1, \sigma^2|y_i) &amp;= \left(\frac{1}{\sqrt{2\pi \sigma^2}}\right)^N \exp\left(-\frac{\sum_{i=1}^N (y_i - \beta_0 - \beta_1 x_i)^2}{2 \sigma^2}\right) \\
&amp;= \left(\frac{1}{2\pi \sigma^2}\right)^{N/2} \exp\left(-\frac{\sum_{i=1}^N (y_i - \beta_0 - \beta_1 x_i)^2}{2 \sigma^2}\right)
\end{align*}
\]</span></p>
<p>Das Maximum von <span class="math inline">\(\mathcal{L}\)</span> wird wie immer gefunden, indem die Likelihoodfunktion abgeleitet und gleich Null gesetzt wird. Um die Berechnungen zu vereinfachen, wird wieder der Logarithmus der Likelihood-Funktion verwendet. Die Loglikelihood <span class="math inline">\(\ell(\beta_0, \beta_1, \sigma^2\)</span> ergibt die folgende Funktion:</p>
<p><span class="math display">\[
\begin{align*}
\ell(\beta_0, \beta_1, \sigma^2) &amp;= \ln \mathcal{L}(\beta_0, \beta_1, \sigma^2) \\
&amp;= \ln \left[\left(\frac{1}{2\pi \sigma^2}\right)^{N/2} \exp\left(-\sum_{i=1}^N \frac{(y_i - \beta_0 - \beta_1 x_i)^2}{2 \sigma^2}\right)\right] \\
&amp;= \ln \left[\left(\frac{1}{2\pi \sigma^2}\right)^{N/2} \right] + \ln \left[\exp\left(-\sum_{i=1}^N \frac{(y_i - \beta_0 - \beta_1 x_i)^2}{2 \sigma^2}\right)\right] \\
&amp;= \frac{N}{2} \ln \left[\left(\frac{1}{2\pi \sigma^2}\right) \right] -\sum_{i=1}^N \frac{(y_i - \beta_0 - \beta_1 x_i)^2}{2 \sigma^2} \\
&amp;= -\frac{n}{2}\ln(2\pi) - \frac{n}{2}\ln(\sigma^2) - \frac{1}{2\sigma^2}\sum_{i=1}^{N}(y_i - \beta_0 - \beta_1 x_i)^2
\end{align*}
\]</span></p>
<p>Durch partielle Ableitung der Funktion <span class="math inline">\(\ell(\beta_0, \beta_1, \sigma^2)\)</span> nach <span class="math inline">\(\beta_0\)</span> und <span class="math inline">\(\beta_1\)</span> und anschließendes Nullsetzen ergibt sich das gleiche Gleichungssystem wie bei den vorherigen Herleitungen durch Minimierung der quadrierten Abweichungen, d.h. den Normalengleichungen. Beispielsweise ergibt sich für <span class="math inline">\(\beta_0\)</span>:</p>
<p><span class="math display">\[\begin{align*}
\frac{\partial \ell(\beta_0, \beta_1, \sigma^2)}{\partial \beta_0} &amp;= \frac{\partial}{\partial \beta_0} \left[-\frac{n}{2}\ln(2\pi) - \frac{n}{2}\ln(\sigma^2) - \frac{1}{2\sigma^2}\sum_{i=1}^{N}(y_i - \beta_0 - \beta_1 x_i)^2\right] \\
&amp;= \frac{2}{2\sigma^2}\sum_{i=1}^N (y_i - \beta_0 - \beta_1 x_i)
\end{align*}\]</span></p>
<p>Wenn dieser Ausdruck gleich Null gesetzt wird, ergibt sich der gleiche Ausdruck wie formal bei den Normalengleichungen für <span class="math inline">\(\beta_0\)</span>:</p>
<p><span class="math display">\[\begin{alignat}{2}
&amp;&amp; \frac{2}{2\sigma^2}\sum_{i=1}^N (y_i - \beta_0 - \beta_1 x_i) = 0 \nonumber \\
\Leftrightarrow\mkern40mu &amp;&amp; \sum (y_i - \beta_0- \beta_1 x_i) = 0 \nonumber \\
\Leftrightarrow\mkern40mu &amp;&amp; \sum y_i - \sum \beta_0- \sum \beta_1 x_i = 0 \nonumber \\
\Leftrightarrow\mkern40mu &amp;&amp; n \bar{y} - n \beta_0- \beta_1 n \bar{x} = 0 \nonumber \\
\Leftrightarrow\mkern40mu &amp;&amp; \bar{y} - \beta_0- \beta_1 \bar{x} = 0 \nonumber \\
\Leftrightarrow\mkern40mu &amp;&amp; \bar{y} - \beta_1 \bar{x} = \beta_0\nonumber \\
\Leftrightarrow\mkern40mu &amp;&amp; \beta_0= \bar{y} - \beta_1 \bar{x}
\end{alignat}\]</span></p>
<p>Die Herleitung für <span class="math inline">\(\beta_1\)</span> entspricht ebenfalls derjenigen, die auf Basis der Normalengleichungen (siehe <a href="slm_basics.html#eq-slm-basics-norm" class="quarto-xref">Gleichung&nbsp;<span>13.5</span></a>) hergeleitet wurden. Der Unterschied liegt darin, dass bei den Normalengleichungen keine Annahmen über die Verteilung der Werte gemacht wurden. Stattdessen wurde eine Methode gesucht, die die quadrierten Residuen minimiert. Im Gegensatz dazu basiert die Herleitung der Gleichungen durch die Maximum-Likelihood-Methode auf spezifischen Verteilungsannahmen und stellt damit ein allgemeineres Verfahren da. Im Fall der linearen Regression führen beide Methoden zum gleichen Ergebnis. Die Maximum-Likelihood-Methode kann jedoch auch in Fällen angewendet werden, bei denen die Methode der quadrierten Abweichungen nicht funktioniert. Für die Anwendung ist es entscheidend, das zugrunde liegende Prinzip und den Unterschied zwischen den beiden Ansätzen zu verstehen.</p>
<section id="maximum-likelihood-bei-der-einfachen-regression-in-r" class="level3" data-number="17.2.1">
<h3 data-number="17.2.1" class="anchored" data-anchor-id="maximum-likelihood-bei-der-einfachen-regression-in-r"><span class="header-section-number">17.2.1</span> Maximum-likelihood bei der einfachen Regression in <code>R</code></h3>
<p>Es folgt ein kleines Beispiel um zu zeigen, wie über die Maximumlikelihood-Methode numerisch die Modellparameter bestimmt werden können, wenn es nicht möglich die Parameter über eine geschlossene Gleichung zu lösen. Es seien <span class="math inline">\(N = 20\)</span> zufällige Punkte generiert und <span class="math inline">\(\sigma\)</span> sei bekannt mit <span class="math inline">\(\sigma=1\)</span> und zwischen <span class="math inline">\(X\)</span> und <span class="math inline">\(Y\)</span> besteht der Zusammenhang <span class="math inline">\(Y = 2 + 3x\)</span>. Seien nun die Daten beobachtet worden und es sollen die Parameter <span class="math inline">\(\hat{\beta_0}\)</span> und <span class="math inline">\(\hat{\beta_1}\)</span> anhand der Daten bestimmt werden.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">20</span>, <span class="dv">3</span>, <span class="dv">7</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, sigma)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Als Streudiagramm sehen die Daten wie folgt aus (siehe <a href="#fig-likelihood-reg-lik" class="quarto-xref">Abbildung&nbsp;<span>17.6</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-likelihood-reg-lik" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-likelihood-reg-lik-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="likelihood_files/figure-html/fig-likelihood-reg-lik-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-likelihood-reg-lik-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.6: Beispieldaten mit <span class="math inline">\(N=20\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Über die <code>lm()</code>-Funktion ist die Berechnung der Koeffizienten simpel.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(mod)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)           x 
   4.134989    2.602081 </code></pre>
</div>
</div>
<p>Nun soll die Likelihood <span class="math inline">\(\mathcal{L}(\theta)\)</span> bzw. die Loglikelihood <span class="math inline">\(\ell(\theta)\)</span> und deren Maximum numerisch bestimmt werden. Um die Likelihood zu bestimmen wird die Funktion <code>dnorm()</code> verwendet, mit der die Dichtewerte für die Daten berechnet werden können (siehe <a href="#eq-likelihood-reg-01" class="quarto-xref">Gleichung&nbsp;<span>17.2</span></a>). Der Mittelwert der Normalverteilung für ein bestimmtes <span class="math inline">\(X\)</span> folgt der Geraden, also <span class="math inline">\(\beta_0 + \beta_1 \cdot X\)</span> (siehe <a href="#eq-likelihood-reg-00" class="quarto-xref">Gleichung&nbsp;<span>17.1</span></a>), während <span class="math inline">\(\sigma^2 = 1\)</span> gegeben ist. Es wird dazu eine neue Funktion in <code>R</code> erstellt, die der Einfachheit halber <code>log_likelihood</code> genannt wird. Der Parameter von <code>log_likelihood()</code> wird der Konvention folgend mit <span class="math inline">\(\theta\)</span> bezeichnet und ist ein Vektor mit zwei Einträgen <span class="math inline">\(\theta = (\beta_0, \beta_1)\)</span>.</p>
<p>Für jedes Wertpaar wird nun die Dichte bestimmt indem der jeweilige <span class="math inline">\(y_i\)</span> Wert als erstes Argument an <code>dnorm()</code> übergeben wird und der dazugehörigen Mittelwert <span class="math inline">\(\mu\)</span> mittels der Regressionsgleichung <span class="math inline">\(\beta_0 + \beta_1 * x_i\)</span> berechnet wird. Die Funktion <code>dnorm()</code> hat ein zusätzliches Argument <code>log</code> mit dem angegeben wird, ob der Dichtewert oder der Logarithmus des Dichtewertes zurückgegeben werden soll. Dies ist dem Umstand geschuldet, dass diese Funktion tatsächlich oft dazu benutzt wird den Loglikelihood <span class="math inline">\(\ell\)</span> zu berechnen. Da <code>dnorm()</code> auch Vektoren verarbeiten kann, werden alle Werte direkt übergeben. <code>dnorm()</code> berechnet den Loglikelihood für jeden Wert und gibt diese in einem Vektor der gleichen Länge zurück. Dieser Vektor muss dann nur aufaddiert werden um den Loglikelihood zu bestimmen.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>log_likelihood <span class="ot">&lt;-</span> <span class="cf">function</span>(theta) {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  beta_0 <span class="ot">&lt;-</span> theta[<span class="dv">1</span>]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  beta_1 <span class="ot">&lt;-</span> theta[<span class="dv">2</span>]</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  ll <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(y, beta_0 <span class="sc">+</span> beta_1 <span class="sc">*</span> x, sigma, <span class="at">log=</span>T)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">sum</span>(ll)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Um nun, das Maximum dieser Funktion zu finden wird die Funktion <code>optim()</code> verwendet. Diese berechnet für eine übergebene Funktion das <strong>Minimum</strong>. Daher wird in <code>log_likelihood()</code> die negative Summe <code>-sum(ll)</code> zurück gegeben. Ein Maximum der Funktion <span class="math inline">\(f(x)\)</span> ist ein Minimum der Funktion <span class="math inline">\(-f(x)\)</span>. Als ersten Parameter benötigt <code>optim()</code> Startwerte für <span class="math inline">\(\theta\)</span> für die Optimierung. Diese sind jetzt einfach auf <span class="math inline">\(\theta_{\text{Start}} = c(1,2)\)</span> gesetzt worden.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>theta_start <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">optim</span>(theta_start, log_likelihood)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>$par
[1] 4.135080 2.602148

$value
[1] 26.03103

$counts
function gradient 
      73       NA 

$convergence
[1] 0

$message
NULL</code></pre>
</div>
</div>
<p>Der Rückgabewert von <code>optim()</code> hat einen Eintrag <code>par</code> der die gefunden Werte für das Maximum (respektive Minimum) enthält. Diese stimmen auch tatächlich mit denjenigen von <code>coef(mod)</code> überein. Dies zeigt somit auch noch mal direkter, wie mittels der Likelihood-Funktion Modellparameter bestimmt werden können, sobald eine statistisches Modell des DGP vorhanden ist. D.h. dieser Ansatz funktioniert auch für deutlich kompliziertere Modell bei denen eine algebraische Herleitung nicht mehr möglich ist.</p>
</section>
</section>
<section id="take-away" class="level2" data-number="17.3">
<h2 data-number="17.3" class="anchored" data-anchor-id="take-away"><span class="header-section-number">17.3</span> Take-away</h2>
<ol type="1">
<li>Das Ziel von MLE ist sehr intuitiv: Finde genau die Parameterwerte <span class="math inline">\(\theta\)</span>, die die beobachteten Daten am wahrscheinlichsten machen.<br>
</li>
<li>Die Likelihood ist keine Wahrscheinlichkeit, sondern nur zum Vergleich.</li>
<li>Meistens wird die <span class="math inline">\(\log\mathcal{L}\)</span> maximiert. Das Maximieren von <span class="math inline">\(\log\mathcal{L}\)</span> ist dasselbe wie Maximieren von <span class="math inline">\(\mathcal{L}\)</span></li>
<li>Bei normalverteilten Residuen ist MLE äquivalent zur Methode der kleinsten Quadrate.</li>
<li>MLE ist sehr allgemein gültig und kann auch bei komplizierteren Fällen angewendet werden. Die Ergebnisse beruhen dann nicht auf einer geschlossen Lösungsgleichung sondern werden über numerische Optimierung ermittelt.</li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Kopiert");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Kopiert");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./slm_prediction.html" class="pagination-link" aria-label="Vorhersage">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Vorhersage</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./mlm_title.html" class="pagination-link" aria-label="Multiple Regression">
        <span class="nav-page-text">Multiple Regression</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>