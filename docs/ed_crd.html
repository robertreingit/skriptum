<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Skriptum - Fortgeschrittene Statistik - 23&nbsp; Completely Randomized Design</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ed_linear_contrasts.html" rel="next">
<link href="./ed_basics.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>
<script>
  MathJax = {
    tex: {
      tags: 'ams'  // should be 'ams', 'none', or 'all'
    }
  };
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ed_title.html">Experimentelles Design</a></li><li class="breadcrumb-item"><a href="./ed_crd.html"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Completely Randomized Design</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Skriptum - Fortgeschrittene Statistik</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vorwort</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./r_startup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Eine Einführung in die Programmiersprache `R`</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Eine Übersicht über <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_vars_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Variablen und Datentypen in <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_flowcontrol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Ablaufkontrolle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Eigene Funktionen in <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Einfache Datenbearbeitung in <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Visualisierung mit <code>ggplot2</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_literate_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Literate programming in <code>R</code></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stats_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistik</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Eine kleine Welt der Unsicherheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_significance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Statistische Signifikanz, p-Wert und Power</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Parameterschätzung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Theoretische Verteilungen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_hypotheses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Hypothesen testen</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./slm_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Das einfache Regressionmodell</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Einführung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Inferenz</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_model_fit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Modellfit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Vorhersage</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./mlm_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Einführung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_interactions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Interaktionseffekte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_dummy_coding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Integration von nominalen Variablen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_hierarchies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Modellhierarchien</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./lm_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Das allgemeine lineare Modell</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lm_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Synthese</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ed_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelles Design</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Einführung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_crd.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Completely Randomized Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_linear_contrasts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Lineare Kontraste</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_crfd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Completely Randomized Factorial Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_ancova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_crbd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Completely Randomized Block Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_split_plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Split-plot Design</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literatur</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#das-modell" id="toc-das-modell" class="nav-link active" data-scroll-target="#das-modell"><span class="header-section-number">23.1</span> Das Modell</a>
  <ul class="collapse">
  <li><a href="#schätzung-der-residualvarianz-sigma2" id="toc-schätzung-der-residualvarianz-sigma2" class="nav-link" data-scroll-target="#schätzung-der-residualvarianz-sigma2"><span class="header-section-number">23.1.1</span> Schätzung der Residualvarianz <span class="math inline">\(\sigma^2\)</span></a></li>
  </ul></li>
  <li><a href="#beispieldaten" id="toc-beispieldaten" class="nav-link" data-scroll-target="#beispieldaten"><span class="header-section-number">23.2</span> Beispieldaten</a></li>
  <li><a href="#crd-in-r" id="toc-crd-in-r" class="nav-link" data-scroll-target="#crd-in-r"><span class="header-section-number">23.3</span> CRD in <code>R</code></a></li>
  <li><a href="#effektstärke-im-crd" id="toc-effektstärke-im-crd" class="nav-link" data-scroll-target="#effektstärke-im-crd"><span class="header-section-number">23.4</span> Effektstärke im CRD</a>
  <ul class="collapse">
  <li><a href="#effektstärken-allgemein" id="toc-effektstärken-allgemein" class="nav-link" data-scroll-target="#effektstärken-allgemein"><span class="header-section-number">23.4.1</span> Effektstärken allgemein</a></li>
  <li><a href="#crd-effektstärken-in-r" id="toc-crd-effektstärken-in-r" class="nav-link" data-scroll-target="#crd-effektstärken-in-r"><span class="header-section-number">23.4.2</span> CRD Effektstärken in <code>R</code></a></li>
  </ul></li>
  <li><a href="#replikationsfaktor-a-prior-ermitteln" id="toc-replikationsfaktor-a-prior-ermitteln" class="nav-link" data-scroll-target="#replikationsfaktor-a-prior-ermitteln"><span class="header-section-number">23.5</span> Replikationsfaktor a-prior ermitteln</a>
  <ul class="collapse">
  <li><a href="#replikationsfaktor-a-priori-in-r-ermitteln" id="toc-replikationsfaktor-a-priori-in-r-ermitteln" class="nav-link" data-scroll-target="#replikationsfaktor-a-priori-in-r-ermitteln"><span class="header-section-number">23.5.1</span> Replikationsfaktor a-priori in <code>R</code> ermitteln</a></li>
  </ul></li>
  <li><a href="#verbindung-modellhierarchien-und-ba-anova-advanced" id="toc-verbindung-modellhierarchien-und-ba-anova-advanced" class="nav-link" data-scroll-target="#verbindung-modellhierarchien-und-ba-anova-advanced"><span class="header-section-number">23.6</span> Verbindung Modellhierarchien und BA-ANOVA (advanced)</a></li>
  <li><a href="#zum-nach--und-weiterlesen" id="toc-zum-nach--und-weiterlesen" class="nav-link" data-scroll-target="#zum-nach--und-weiterlesen"><span class="header-section-number">23.7</span> Zum Nach- und Weiterlesen</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ed_title.html">Experimentelles Design</a></li><li class="breadcrumb-item"><a href="./ed_crd.html"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Completely Randomized Design</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Completely Randomized Design</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Das erste experimentelle Design, das wir uns anschauen, ist das completeley randomized design. Wir haben unterschiedliche experimentelle Konditionen von denen wir ausgehen, dass diese sich unterschiedlich auf die experimentellen units (EU) auswirken. Beispielsweise wollen wir die Balancierfähigkeit unter drei verschiedenen Konditionen, z.B. fester Untergrund, weicher Untergrund und wackeliger Untergrund. Die Balancierfähigkeit ist aber auch durch zahlreiche andere Einflussfaktoren beeinflusst, z.B. Vorerfahrung, Kraftfähigkeit etc. Viele von diesen Einflussfaktoren kennen wir vielleicht gar nicht bzw. für diese zu kontrollieren wäre zu aufwendig. Um jedoch dennoch für diese Störgrößen zu <em>kontrollieren</em> setzen wir Randomisierung ein. Jeder einzelne Versuchsteilnehmer bzw. Versuchsteilnehmerinn muss dazu randomisiert auf <strong>eine</strong> der drei Kondition verteilt werden. Damit werden die Teilnehmer(innen) zu den EUs. Nach Durchsicht der Literatur könnte die Balancierfähigkeit z.B. mit einer Kraftmessplatte erfasst werden. Hieran schließt sich noch die Festsetzung der observational units, d.h. in diesem Falle, der Anzahl der Messwiederholungen an um die Reliabität auf ein gewünschtes Niveau zu heben. Diesen Teil vernachlässigen wir zunächst einmal.</p>
<section id="das-modell" class="level2" data-number="23.1">
<h2 data-number="23.1" class="anchored" data-anchor-id="das-modell"><span class="header-section-number">23.1</span> Das Modell</h2>
<p>Um diesem Design ein statistisches Modell anzupassen, müssen wir uns nun Gedanken über den DGP machen. Zunächst einmal wird jede(r) Teilnehmer(in) eine bestimmte Balancierfähigkeit haben. Bzw. wenn wir die Kondition mit dem festen Untergrund als eine Referenzkondition festlegen, können wir davon ausgehen, dass es eine mittlere Balancierfähigkeit gibt und die einzelnen Personen aus der Population um diesen Mittelwert schwanken. Dieser Mittelwert bekommt einen eigenen Parameter <span class="math inline">\(\mu\)</span>. Jetzt gegen wir davon aus, dass die unterschiedlichen Konditionen dazu führen, dass die <em>Basisbalancierfähigkeit</em> von den Konditionen beeinflusst wird. D.h. es kommt zu einer Veränderung oder Abweichung von <span class="math inline">\(\mu\)</span>. Diese Abweichungen bezeichnen wird mit <span class="math inline">\(\tau_i\)</span> wobei der Index <span class="math inline">\(i\)</span> dann die jeweilige Kondition <span class="math inline">\(i\)</span> kennzeichnet. Insgesamt führen diese Überlegungen zu dem folgenden Modell:</p>
<p><span class="math display">\[\begin{equation}
Y_{ij} = \mu + \tau_i + \epsilon_{ij}, \qquad \epsilon_{ij}\sim \mathcal{N}(0,\sigma^2)
\label{eq-ed-crd-model}
\end{equation}\]</span></p>
<p>i = Gruppenindikator, j = experimental unit-indikator, <span class="math inline">\(\mu\)</span> = Gesamtmittelwert, , K = Anzahl der Faktorstufen</p>
<p>Um den Einfluss <span class="math inline">\(\tau_i\)</span> der verschiedenen Konditionen zu bestimmen können benötigen wir Replikationen der EUs. In unserem Fall erreichen wird die Replikation dadurch, dass mehrere Versuchspersonen, die EUs, unter jeder Kondition <span class="math inline">\(i\)</span> beobachtete werden. Die einzelnen EUs erhalten dabei den Index <span class="math inline">\(j\)</span>.</p>
<p>Um ein statistisches Modell formulieren zu können benötigen wir wie immer bestimmte Annahmen. Diese sind jedoch immer noch die gleichen Annahmen, die wir schon vorher bei der multiplen Regression angesetzt haben.</p>
<ul>
<li>Unabhängige Experimental Units (EU)</li>
<li>Die EUs sind <strong>randomisiert</strong> in K Gruppen eingeteilt worden</li>
<li>Die Konditionen wurden unabhängig auf die individuellen experimentellen Einheiten angewendet</li>
<li>Die Werte in jeder Gruppe sind Normalverteilt <span class="math inline">\(Y_{ij} \sim \mathcal{N}(\mu_i, \sigma_i^2)\)</span></li>
<li>Die Varianzen <span class="math inline">\(\sigma_i^2\)</span> in jeder Gruppe <span class="math inline">\(i\)</span> sind gleich, <span class="math inline">\(\sigma_i^2 = \sigma^2, i = 1,2,\ldots,K\)</span> (Homoskedastizität).</li>
</ul>
<p>Die statistische Überprüfung führen wir nun wieder mit dem uns bekannten Modellvergleichen durch. Das Modell <span class="math inline">\(\eqref{eq-ed-crd-model}\)</span> wird als das Full Model angesehen und wir definieren das reduzierte Modell mittels:</p>
<p><span class="math display">\[\begin{equation*}
Y_{ij} = \mu + \epsilon_{ij}
\end{equation*}\]</span></p>
<p>D.h. im reduzierten Modell fällt diei Faktorvariable komplett raus und als Modellparameter wird nur ein <span class="math inline">\(y\)</span>-Achsenabschnitt, der dann gleich dem Mittelwert <span class="math inline">\(\bar{y}\)</span> ist, verwendet. Die Teststatistik beruht daher wieder auf dem Vergleich der Residuen zwischen den beiden Modell normiert an den Residuen aus dem vollem Modell.</p>
<p><span class="math display">\[\begin{equation}
F = \frac{\textrm{SSE(R)} - \textrm{SSE(F)}}{\textrm{df}_R - \textrm{df}_F} \frac{\textrm{df}_F}{\textrm{SSE(F)}} \sim F(\textrm{df}_R-\textrm{df}_F,\textrm{df}_F)
\label{eq-ed-crd-modeltest}
\end{equation}\]</span></p>
<p>Die Teststatistik folgt unter der <span class="math inline">\(H_0\)</span> eine <span class="math inline">\(F\)</span>-Statistik mit <span class="math inline">\(\textrm{df}_R - \textrm{df}_F\)</span> und <span class="math inline">\(\textrm{df}_F\)</span> Freiheitsgraden. Die statistischen Hypothesen sind wie bereits bei der Dummyvariablen definiert:</p>
<p><span class="math display">\[\begin{align*}
H_0:&amp; \tau_1 = \tau_2 = \ldots = \tau_k = 0 \\
H_1:&amp; \exists\tau_i \neq \tau_j\ \textrm{mit}\ i \neq j, i,j \in \{1,2,\ldots,k\}
\end{align*}\]</span></p>
<p>D.h. wir überprüfen ob die Hinzunahme der Information über die Konditionen (Faktoren) zu einer statistisch signifikanten Verminderung der Residualvarianz führt. Wenn dem nicht der Fall, dann verbessert sich der Modellfit durch die Faktorstufen <span class="math inline">\(\tau_i\)</span> nicht.</p>
<section id="schätzung-der-residualvarianz-sigma2" class="level3" data-number="23.1.1">
<h3 data-number="23.1.1" class="anchored" data-anchor-id="schätzung-der-residualvarianz-sigma2"><span class="header-section-number">23.1.1</span> Schätzung der Residualvarianz <span class="math inline">\(\sigma^2\)</span></h3>
<p>Zu den Annahmen gehört auch die uns mittlerweile altbekannte Annahme der Varianzgleichheit oder Homeskedastizität für <span class="math inline">\(\sigma^2\)</span>. Wir schätzen <span class="math inline">\(\sigma^2\)</span> mittels der <span class="math inline">\(MSE\)</span> ab. Diese werden im Rahmen der ANOVA oftmals als <em>within error</em> bezeichnet, also als Fehler innerhalb der jeweiligen Gruppen. Durch die Struktur des CRD mit einm nominalen Faktoren sind die Mittelwerte der jeweiligen Gruppen die geschätzen <span class="math inline">\(Y\)</span>-Wert also <span class="math inline">\(\hat{y}_{ij}\)</span>. Daher sind die Residuen <span class="math inline">\(\hat{\epsilon}_i\)</span> immer die jeweiligen Abweichungen der beobachteten Wert <span class="math inline">\(y_i\)</span> vom Gruppenmittelwert <span class="math inline">\(\bar{y}_i\)</span>.</p>
<p>Der Mittelwert <span class="math inline">\(\bar{y}_i\)</span> der <span class="math inline">\(i\)</span>-ten Gruppe wird mit den Zeichen <span class="math inline">\(\bar{y}_{i.}\)</span> bezeichnet. Der Punkt <span class="math inline">\(.\)</span> im Index bedeutet <em>Summation über diesen Index</em>. Formaler:</p>
<p><span class="math display">\[\begin{equation}
\bar{y}_{i.} = \frac{1}{n_i}\sum_{j=1}^{n_i}y_{ij}
\end{equation}\]</span></p>
<p><span class="math inline">\(n_i\)</span> ist die Stichprobengröße in Gruppe <span class="math inline">\(i\)</span>.</p>
<p>Unser allgemeiner Schätzfehler in dem Model <span class="math inline">\(\hat{\sigma}^2 = MSE\)</span> berechnet sich aus der Summer der quadrierten Abweichungen <span class="math inline">\(y_{ij} - \hat{y}_{ij}\)</span> geteilt durch die Freiheitsgrade also <span class="math inline">\(\hat{\sigma}^2 = \frac{SSE}{N-p}\)</span> (<span class="math inline">\(p=\)</span> Anzahl der Modellparameter). Für <span class="math inline">\(SSE\)</span> gilt im CRD:</p>
<p><span class="math display">\[\begin{equation}
\begin{aligned}
SSE &amp;= \sum_{i}\sum_{j}\hat{\epsilon}_{ij}^2 = \sum_{i}\sum_{j} (y_{ij} - \hat{y}_{ij})^2 = \sum_{i}\sum_{j}(y_{ij} - (\hat{\mu} + \hat{\tau}_i))^2 \\
&amp;= \sum_{i}\sum_{j}(y_{it} - \bar{y}_{i.})^2
\end{aligned}
\end{equation}\]</span></p>
<p>Mit etwas Algebra lässt sich zeigen, dass der Erwartungswert von <span class="math inline">\(SSE\)</span> unter dem Modell wie folgt aussieht.</p>
<p><span class="math display">\[\begin{equation}
E[SSE] = (N-K)\sigma^2
\end{equation}\]</span></p>
<p>Damit landen wir wenig überraschend wieder bei dem gleichen <span class="math inline">\(\hat{\sigma}^2\)</span> das wir vorher auch schon unter dem allgemeinen linearem Modell hergeleitet haben.</p>
<p><span class="math display">\[\begin{equation}
\hat{\sigma}^2 = \frac{SSE}{N-K} = MSE
\end{equation}\]</span></p>
<p>Hier nur noch mal angezeigt um die Verbindung mit den Gruppenmittelwerten explizit zu machen bzw. wenn ihr Statistikbücher zur ANOVA anschaut, dann wird meist diese Schreibweise verwendet.</p>
<p>Mit etwas mehr Aufwand, lässt sich zeigen, dass <span class="math inline">\(SSE\)</span> einer <span class="math inline">\(\chi^2\)</span>-Verteilung mit <span class="math inline">\(N-K\)</span> Freiheitsgraden folgt.</p>
<p><span class="math display">\[\begin{equation}
\frac{SSE}{\sigma^2} \sim \chi^2_{N-K}
\end{equation}\]</span></p>
<p>Über diesen Zusammenhang lässt sich eine obere <span class="math inline">\(100(1-\alpha)\%\)</span> Konfidenzgrenze über die folgende Formel herleiten:</p>
<p><span class="math display">\[\begin{equation}
\sigma^2 \leq \frac{SSE}{\chi^2_{N-K,\alpha}}
\label{eq-crd-sigma-chi}
\end{equation}\]</span></p>
<p>Diese Grenze wird später noch einmal interessant werden, wenn wir Stichprobengrößen mittels einer Poweranalse ermitteln wollen.</p>
</section>
</section>
<section id="beispieldaten" class="level2" data-number="23.2">
<h2 data-number="23.2" class="anchored" data-anchor-id="beispieldaten"><span class="header-section-number">23.2</span> Beispieldaten</h2>
<p>Schauen wir uns als nächstes einen Beispieldatensatz an und gehen durch die verschiedenen Schritte der Analyse eines CRD.</p>
<p>In <a href="#fig-ed-crd-coffeine-01" class="quarto-xref">Abbildung&nbsp;<span>23.1</span></a> ist das Ergebnis einer Untersuchung zum Einfluss von Koffein auf die Laufleistung bei einem 8Km Ausdauerlauf zu abgebildet. Insgesamt sind <span class="math inline">\(N=60\)</span> Probanden randomisiert in drei Gruppen eingeteilt worden: Koffein, Placebo und Control. Die Gruppe Koffein hat vor dem Lauf ein Koffeinpräparat eingenommen, während die Placebogruppe ein Präparat ohne Wirkstoff eingenommen hat. Die Kontrollgruppe hat vor dem Lauf kein Zusatzpräparat eingekommen. Jeder Proband lief einmal die Strecke von <span class="math inline">\(8\)</span> Km so schnell wie möglich. Die abhängige Variable war die Laufzeit.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ed-crd-coffeine-01" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ed-crd-coffeine-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_crd_files/figure-html/fig-ed-crd-coffeine-01-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ed-crd-coffeine-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;23.1: Einfluss von Koffeine auf die Laufleistung über 8km
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-ed-crd-coffeine-01" class="quarto-xref">Abbildung&nbsp;<span>23.1</span></a> deute an, das die Einnahme von Koffein zu einer Leistungsverbesserung führt, während der Einfluss des Placebos scheinbar möglicherweise nur zu einer leichten Verbesserung gegenüber der Kontrollkondition geführt hat.</p>
<p>Schauen wir uns die deskriptive Statistik der Daten an. In <a href="#tbl-ed-crd-ex-01" class="quarto-xref">Tabelle&nbsp;<span>23.1</span></a> sind die deskriptiven Werte der Daten abgebildet.</p>
<div id="tbl-ed-crd-ex-01" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ed-crd-ex-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;23.1: Deskriptive Statistik der Laufdaten.
</figcaption>
<section id="descriptive-statistics" class="level3" aria-describedby="tbl-ed-crd-ex-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" data-number="23.2.1">
<h3 data-number="23.2.1" class="anchored" data-anchor-id="descriptive-statistics"><span class="header-section-number">23.2.1</span> Descriptive Statistics</h3>
<section id="zeit-by-gruppe" class="level4" data-number="23.2.1.1">
<h4 data-number="23.2.1.1" class="anchored" data-anchor-id="zeit-by-gruppe"><span class="header-section-number">23.2.1.1</span> Zeit by Gruppe</h4>
<p><strong>N:</strong> 20</p>
<table class="cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">&nbsp;</th>
<th style="text-align: right;">Gruppe = Koffein</th>
<th style="text-align: right;">Gruppe = Placebo</th>
<th style="text-align: right;">Gruppe = Control</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><strong>Mean</strong></td>
<td style="text-align: right;">1914.20</td>
<td style="text-align: right;">1924.68</td>
<td style="text-align: right;">1927.54</td>
</tr>
<tr class="even">
<td style="text-align: right;"><strong>Median</strong></td>
<td style="text-align: right;">1913.24</td>
<td style="text-align: right;">1924.72</td>
<td style="text-align: right;">1928.52</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><strong>Std.Dev</strong></td>
<td style="text-align: right;">6.78</td>
<td style="text-align: right;">5.72</td>
<td style="text-align: right;">7.23</td>
</tr>
<tr class="even">
<td style="text-align: right;"><strong>Q1</strong></td>
<td style="text-align: right;">1909.25</td>
<td style="text-align: right;">1920.46</td>
<td style="text-align: right;">1924.70</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><strong>Q3</strong></td>
<td style="text-align: right;">1917.16</td>
<td style="text-align: right;">1927.32</td>
<td style="text-align: right;">1933.05</td>
</tr>
</tbody>
</table>
</section>
</section>
</figure>
</div>
<p>Die Standardabweichungen in den drei Gruppen sind in <a href="#tbl-ed-crd-ex-01" class="quarto-xref">Tabelle&nbsp;<span>23.1</span></a> relativ ähnlich, so dass hier schon einmal keine größeren Probleme zu erwarten sind. Die Mittelwerte und Mediane liegen ebenfalls ziemlich nahe beieinander. Was unseren Eindruck aus <a href="#fig-ed-crd-coffeine-01" class="quarto-xref">Abbildung&nbsp;<span>23.1</span></a> bestätigt.</p>
<p>Bei der Analyse von CRD Experimenten wird in dem meisten Fällen weniger die einzelnen Koeffzienten gesucht sondern es es wird die Varianz die Aufgrund der Modellparameter aufgeklärt werden kann im Vergleich zum reduzierten Modell untersucht. Formal kommt es zu einer Varianzzerlegung, Analyse der Varianz, analysis of variance = ANOVA.</p>
<p><span class="math display">\[\begin{equation}
\sigma_{Y}^2 = \sigma_{\text{Modell}}^2 + \sigma_{\epsilon}^2 = \sigma_{\text{between}}^2 + \sigma_{\epsilon}^2
\end{equation}\]</span></p>
<p>In der Terminologie der CRD wird die Modellvarianz <span class="math inline">\(\sigma_{\text{Modell}}\)</span> als <span class="math inline">\(\sigma_{\text{between}}\)</span> bezeichnet. Dies soll ausdrücken, dass diese Varianzkomponente die Varianz die durch die verschiedenen Konditionen der nominalen Variablen zustande kommt. Das Ergebnis der Varianzanalyse wird in einer sogenannten <span class="math inline">\(F\)</span>-Tabelle dokumentiert.</p>
<div id="tbl-ed-crd-f-table" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ed-crd-f-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;23.2: Bezeichungen F-Tabelle
</figcaption>
<div aria-describedby="tbl-ed-crd-f-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 24%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><span class="math inline">\(df\)</span></th>
<th><span class="math inline">\(SSQ\)</span></th>
<th><span class="math inline">\(MSQ\)</span></th>
<th style="text-align: center;"><span class="math inline">\(F\)</span></th>
<th>Expected Mean Square</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Between</td>
<td><span class="math inline">\(K-1\)</span></td>
<td><span class="math inline">\(SS_b\)</span></td>
<td><span class="math inline">\(MS_b=\frac{SS_b}{K-1}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\frac{MS_b}{MS_w}\)</span></td>
<td><span class="math inline">\(\sigma^2 + Q(\tau_i)\)</span></td>
</tr>
<tr class="even">
<td>Residual</td>
<td><span class="math inline">\(N-K\)</span></td>
<td><span class="math inline">\(SS_w\)</span></td>
<td><span class="math inline">\(MS_w=\frac{SS_w}{N-K}\)</span></td>
<td style="text-align: center;"></td>
<td><span class="math inline">\(\sigma^2\)</span></td>
</tr>
<tr class="odd">
<td>Total</td>
<td><span class="math inline">\(N-1\)</span></td>
<td><span class="math inline">\(SS_{\text{total}}\)</span></td>
<td><span class="math inline">\(MS_{\text{total}}\)</span></td>
<td style="text-align: center;"></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p><span class="math inline">\(df\)</span> sind die Freiheitsgrade, <span class="math inline">\(SSQ\)</span> die Quadratsummen, <span class="math inline">\(MSQ\)</span> die mittleren Quadratsummen, <span class="math inline">\(F\)</span> der resultierende <span class="math inline">\(F\)</span> Wert und Expected Mean Squared der Erwartungswert der jeweiligen Varianzkomponente.</p>
<p>Beim Erwartungswert für <span class="math inline">\(MS_b\)</span> haben wir einen Term <span class="math inline">\(Q(\tau_i)\)</span> der wie folgt definiert ist wenn die Stichprobengröße <span class="math inline">\(n_i\)</span> gleich <span class="math inline">\(K\)</span> gleich groß <span class="math inline">\(n_i = n, \forall i\)</span> ist.</p>
<p><span class="math display">\[\begin{equation}
Q(\tau_i) = n\frac{\sum_{i=1}^K(\tau_i - \bar{\tau}_.)^2}{K-1}
\label{eq-ed-crd-Q_1}
\end{equation}\]</span></p>
<p>Schauen wir uns die Formel<span class="math inline">\(\eqref{eq-ed-crd-Q_1}\)</span> für <span class="math inline">\(Q(\tau_i)\)</span> genauer an, dann erkennen wir vielleicht etwas verklausuliert die Varianz der Effekte <span class="math inline">\(\tau_i\)</span> der verschiedenen Konditionen. D.h der Erwartungswert von <span class="math inline">\(MS_b\)</span> setzt sich aus zwei Komponenten zusammen. Der Residualvarianz <span class="math inline">\(\sigma^2\)</span> und <span class="math inline">\(Q(\tau_i)\)</span>, der Varianz der Effekte der Konditionen. Unter der <span class="math inline">\(H_0\)</span> gilt <span class="math inline">\(\tau_i = 0\)</span> für alle <span class="math inline">\(i\)</span>. Dadurch wird dann die <span class="math inline">\(Q(\tau_i)\)</span> ebenfalls <span class="math inline">\(=0\)</span> und der Erwartungswert von <span class="math inline">\(MS_b\)</span> wird dann ebenfalls nur noch zu <span class="math inline">\(\sigma^2\)</span>.</p>
<p>Dadurch kann ein Hypothesentest erstellt werden um einen <span class="math inline">\(F\)</span>-Wert berechnen, bzw. mit mittelinvolvierter Algebra lässt sich zeigen, dass dieser Test äquivalent zu dem Modellvergleich in Formel <span class="math inline">\(\eqref{eq-ed-crd-modeltest}\)</span> ist.</p>
<p><span class="math display">\[\begin{equation}
F = \frac{MS_b}{MS_w} = \frac{\sigma^2 + Q(\tau_i)}{\sigma^2}
\end{equation}\]</span></p>
<p>Wie gesagt, wenn die <span class="math inline">\(H_0\)</span> gilt und all <span class="math inline">\(\tau_i = 0\)</span> oder alle <span class="math inline">\(\tau_i\)</span> den gleichen Wert haben, dann wird <span class="math inline">\(Q(\tau_i) = 0\)</span> und es folgt <span class="math inline">\(F = 1\)</span>. D.h. unter der <span class="math inline">\(H_0\)</span> erwarten wir, dass der <span class="math inline">\(F\)</span>-Wert in der Nähe von <span class="math inline">\(1\)</span> ist. Größere Werte sprechen gegen die <span class="math inline">\(H_0\)</span> das alle <span class="math inline">\(\tau_i = 0\)</span> sind. Diese Diese Art der Testherleitung ist nützlich zu können, da in vielen Lehrbüchern diese Herleitung verwendet wird, da in diesem Falle keine Vorkenntnisse zur Regression notwendig sind, hat aber den Nachteil das der Zusammenhang zwischen der ANOVA und der Regression nicht verstanden wird. Letztendlich läuft diese Interpretation aber genauso wieder auf den Vergleich von reduziertem und vollem Modell hinaus.</p>
<p>Für unsere Beispieldaten ergibt sich die folgenden F-Tabelle (siehe <a href="#tbl-ed-crd-ex-tbl-01" class="quarto-xref">Tabelle&nbsp;<span>23.3</span></a>).</p>
<div class="cell">
<div id="tbl-ed-crd-ex-tbl-01" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ed-crd-ex-tbl-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;23.3: ANOVA-Tabelle der Koffein-Laufdaten
</figcaption>
<div aria-describedby="tbl-ed-crd-ex-tbl-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<caption>Summarytabelle von aov()</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">SSQ</th>
<th style="text-align: right;">MSQ</th>
<th style="text-align: right;">F</th>
<th style="text-align: right;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Gruppe</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1973.19</td>
<td style="text-align: right;">986.59</td>
<td style="text-align: right;">22.59</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Residuals</td>
<td style="text-align: right;">57</td>
<td style="text-align: right;">2489.63</td>
<td style="text-align: right;">43.68</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Die Ergebnisse in <a href="#tbl-ed-crd-ex-tbl-01" class="quarto-xref">Tabelle&nbsp;<span>23.3</span></a> deuten auf einen statistisch signifikanter Effekt für die Gruppenvariable. Der <span class="math inline">\(F\)</span>-Wert ist deutlich größer als <span class="math inline">\(1\)</span> und hat unter der Annahme der <span class="math inline">\(H_0\)</span> einen p-Wert von deutlich unter <span class="math inline">\(\alpha = 0.05\)</span>. D.h. die Kenntnis über die Gruppenzugehörigkeit gibt uns relevante Information über die abhängige Variable <span class="math inline">\(y\)</span> der Laufgeschwindikeit. Bezogen auf den Modellvergleich, die Kenntnis der Gruppenzugehörigkeit erlaubt uns bessere Vorhersagen über die Laufgeschwindigkeit zu machen, als wenn wir diese Informationen nicht hätten. Wie immer ist dies kein Beweis dafür, dass es einen Unterschied zwischen den Gruppen gibt, sondern unter der Annahme das kein Unterschied besteht haben wir einen Wert beobachtete der sehr unwahrscheinlich ist.</p>
<p>Um sicherzustellen, dass unser Modell die Daten auch korrekt abbildet, müssen wir natürlich genauso wie auch bei den vorhergehenden Modellen eine Analyse des Modellfits durchführen. Also zum Beispiel eine Residuenanalyse mittels der einfachen Residuen <span class="math inline">\(e_i\)</span> und der standardisierten Residuen <span class="math inline">\(e_{Si}\)</span>.</p>
<div id="fig-ed-crd-ex-01-resid" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ed-crd-ex-01-resid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-ed-crd-ex-01-resid" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-ed-crd-ex-01-resid-1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-ed-crd-ex-01-resid-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_crd_files/figure-html/fig-ed-crd-ex-01-resid-1.png" class="img-fluid figure-img" data-ref-parent="fig-ed-crd-ex-01-resid" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-ed-crd-ex-01-resid-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Residuenplot für die einfachen Residuen <span class="math inline">\(\hat{\epsilon}_i\)</span>.
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-ed-crd-ex-01-resid" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-ed-crd-ex-01-resid-2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-ed-crd-ex-01-resid-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_crd_files/figure-html/fig-ed-crd-ex-01-resid-2.png" class="img-fluid figure-img" data-ref-parent="fig-ed-crd-ex-01-resid" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-ed-crd-ex-01-resid-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Residuenplot für die standardisierten Residuen <span class="math inline">\(\hat{\epsilon}_{Si}\)</span>.
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-ed-crd-ex-01-resid" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-ed-crd-ex-01-resid-3" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-ed-crd-ex-01-resid-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_crd_files/figure-html/fig-ed-crd-ex-01-resid-3.png" class="img-fluid figure-img" data-ref-parent="fig-ed-crd-ex-01-resid" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-ed-crd-ex-01-resid-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) qq-Plot der einfachen Residuen.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ed-crd-ex-01-resid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;23.2: Residuendiagnostik für einfache <span class="math inline">\(\hat{\epsilon}_i\)</span> und standardisierte <span class="math inline">\(\hat{\epsilon}_{Si}\)</span> Residuen.
</figcaption>
</figure>
</div>
<p>In <a href="#fig-ed-crd-ex-01-resid" class="quarto-xref">Abbildung&nbsp;<span>23.2</span></a> sind die verschiedenen Residuenplots abgetragen und deuten insgesamt auf keine groben Verletzungen der Annahmen hin (Warum?). Ein weiterführende Analyse würde sich die weiteren Metriken wie Cooks-Distance, DFFits usw. anschauen. Was wir hier aber überspringen.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tipp
</div>
</div>
<div class="callout-body-container callout-body">
<p>Im Zusammenhang mit einer ANOVA-Analyse wird oft auch ein formaler Test auf Varianzhomogenität erwähnt. Der Levene-Test wird oft dazu verwendet. Der Levene-Test hat als <span class="math inline">\(H_0\)</span>-Hypothese, das die Varianzen in den Gruppen gleich sind.</p>
<p><span class="math display">\[\begin{align*}
H_0 &amp;\text{all } \sigma_i^2 \text{ equal}\\
H_1 &amp;\text{not all } \sigma_i^2 \text{ equal}
\end{align*}\]</span></p>
<p>Da es sich dabei um einen Vorraussetzungtest handelt, wird die Irrtumswahrscheinlichkeit auf <span class="math inline">\(\alpha = 0.1\)</span> angesetzt um die Überprüfung konservativer zu machen (Warum?). Auf die Herleitung des Tests gehen wir nicht näher ein.</p>
<p>Für unsere Beispieldaten ergibt sich ein Testergebnis mit <span class="math inline">\(F(2, 57) = 0.37947\)</span> welcher bei einer Irrtumswahrscheinlichkeit von <span class="math inline">\(\alpha = 0.1\)</span> statistisch nicht signifikant ist. D.h. die <span class="math inline">\(H_0\)</span> das die Varianzen in den Gruppen gleich sind, wird nicht verworfen.</p>
</div>
</div>
<div id="exm-crd-lit-example-01" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 23.1</strong></span> In einer Untersuchung von <span class="citation" data-cites="milanese2011">Milanese u.&nbsp;a. (<a href="references.html#ref-milanese2011" role="doc-biblioref">2011</a>)</span> wurde die Anthropometrie und Körperzusammensetzung bei <span class="math inline">\(43\)</span> weiblichen Handballspielerinnen aus der italienischen Handballliga untersucht. Die Spielerinnen wurden nach ihrer Spielpositionen gruppiert in Torwärtin, Rückraum-, Flügelspielerin oder Kreisläuferin. Für die Körperhöhe konnten die Autoren die folgenden Ergebnisse für vier Gruppen ermitteln.</p>
<table class="table">
<caption>Mittelwertsdaten aus Milanese et al.&nbsp;(2011, S.1304)</caption>
<thead>
<tr class="header">
<th>Position</th>
<th>Körperhöhe[cm]</th>
<th><span class="math inline">\(n_i\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Torwärtin</td>
<td><span class="math inline">\(169.3 \pm 7.41\)</span></td>
<td><span class="math inline">\(7\)</span></td>
</tr>
<tr class="even">
<td>Rückraumspielerin</td>
<td><span class="math inline">\(171.0 \pm 5.80\)</span></td>
<td><span class="math inline">\(14\)</span></td>
</tr>
<tr class="odd">
<td>Kreisspielerin</td>
<td><span class="math inline">\(167.0 \pm 4.32\)</span></td>
<td><span class="math inline">\(4\)</span></td>
</tr>
<tr class="even">
<td>Flügelspielerin</td>
<td><span class="math inline">\(165.2 \pm 4.4\)</span></td>
<td><span class="math inline">\(18\)</span></td>
</tr>
</tbody>
</table>
<p>Ein Analyse der Daten ergab das folgende Ergebnis:</p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><span class="math inline">\(df\)</span></th>
<th><span class="math inline">\(SSQ\)</span></th>
<th><span class="math inline">\(MSQ\)</span></th>
<th><span class="math inline">\(F\)</span></th>
<th><span class="math inline">\(p\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Zwischen</td>
<td><span class="math inline">\(3\)</span></td>
<td><span class="math inline">\(282.7\)</span></td>
<td><span class="math inline">\(94.23\)</span></td>
<td><span class="math inline">\(3.19\)</span></td>
<td><span class="math inline">\(p = 0.034\)</span></td>
</tr>
<tr class="even">
<td>Innerhalb</td>
<td><span class="math inline">\(39\)</span></td>
<td><span class="math inline">\(1151.88\)</span></td>
<td><span class="math inline">\(29.54\)</span></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>D.h. es wurde ein statistisch signifikanter Unterschied zwischen den vier Gruppen beobachtet. Wenn wir uns die Annahme des Modells noch einmal anschauen, dann bemerken wir ein kleines Problem. Die Voraussetzungen wurden insofern nicht eingehalten, da die Gruppen nicht randomisiert in die vier Positionen eingeteilt wurden was bei dieser Art der Untersuchung auch gar nicht möglich ist. Problematisch ist in diesem Fall zusätzlich, dass die Stichprobe nicht zufällig gezogen wurde, sondern im Rahmen einer Leistungsdiagnostik mit insgesamt vier verschiedenen Teams zustande kam. Daher ist die Verallgemeinerung der Ergebnisse ebenfalls kritisch zu betrachten.</p>
</div>
</section>
<section id="crd-in-r" class="level2" data-number="23.3">
<h2 data-number="23.3" class="anchored" data-anchor-id="crd-in-r"><span class="header-section-number">23.3</span> CRD in <code>R</code></h2>
<p>In <code>R</code> können wir CRD mittels der uns bekannten <code>lm()</code>-Funktion und einem nachfolgenden <code>anova()</code> durchgeführt werden oder wir verwenden die Funktion <code>aov()</code> bei der über <code>summary()</code> direkt die <span class="math inline">\(F\)</span>-Tabelle erstellt wird.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>mod_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Zeit <span class="sc">~</span> Gruppe, <span class="at">data =</span> kaffee)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_lm)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Zeit
          Df Sum Sq Mean Sq F value   Pr(&gt;F)    
Gruppe     2 1973.2  986.59  22.588 5.97e-08 ***
Residuals 57 2489.6   43.68                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Alternativ und gleichwertig können wir die beiden Modelle, das volle und das reduzierte Modell selbständig fitten und mittels <code>anova()</code> vergleichen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mod_r <span class="ot">&lt;-</span> <span class="fu">lm</span>(Zeit <span class="sc">~</span> <span class="dv">1</span>, kaffee)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>mod_f <span class="ot">&lt;-</span> <span class="fu">lm</span>(Zeit <span class="sc">~</span> Gruppe, kaffee)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_r, mod_f)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: Zeit ~ 1
Model 2: Zeit ~ Gruppe
  Res.Df    RSS Df Sum of Sq      F   Pr(&gt;F)    
1     59 4462.8                                 
2     57 2489.6  2    1973.2 22.588 5.97e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Oder wir verwenden die <code>aov()</code>-Funktion.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>mod_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(Zeit <span class="sc">~</span> Gruppe, <span class="at">data =</span> kaffee)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_aov)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
Gruppe       2   1973   986.6   22.59 5.97e-08 ***
Residuals   57   2490    43.7                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Da alle drei Methoden zum gleichen Ergebnis kommen, ist jeder selbst überlassen wenn Methode sie bevorzugt.</p>
</section>
<section id="effektstärke-im-crd" class="level2" data-number="23.4">
<h2 data-number="23.4" class="anchored" data-anchor-id="effektstärke-im-crd"><span class="header-section-number">23.4</span> Effektstärke im CRD</h2>
<p>Ein Konzept mit dem wir uns bisher noch nicht eingehender auseinander gesetzt haben, sind die sogenannten Effektstärken.</p>
<section id="effektstärken-allgemein" class="level3" data-number="23.4.1">
<h3 data-number="23.4.1" class="anchored" data-anchor-id="effektstärken-allgemein"><span class="header-section-number">23.4.1</span> Effektstärken allgemein</h3>
<div id="def-effect-size" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 23.1 (Effektstärke)</strong></span> Eine Effektstärke bezeichent einen Wert, der die Stärke der Beziehung zwischen zwei Variablen in einer Population misst, oder eine empirische Schätzung dieser Größe.</p>
</div>
<p>Das einfachste Beispiel für eine Effektstärke ist der Parameter Cohen’s D der Effektstärke für den Unterschied zwischen zwei Gruppenmittelwerten bestimmt. In der Population gilt. <span class="math display">\[\begin{equation}
D = \frac{\mu_1 - \mu_2}{\sigma}
\end{equation}\]</span> bzw. geschätzt anhand der Stichprobe: <span class="math display">\[\begin{equation}
d = \frac{\bar{x}_1 - \bar{x}_2}{\sqrt{s_1^2 + s_2^2}/2}
\end{equation}\]</span> Die Effektstärke ist dabei in praktisch allen relevanten Fällen eine Dimensionslose größe, da im Prinzip immer ein Unterschied <span class="math inline">\(\Delta\)</span> durch des <span class="math inline">\(Streuung\)</span> geteilt wird. Da beide Größen die gleichen Einheiten haben, entsteht dadurch eine dimensionslose Größe. Dies ermöglich die Effektstärke in verschiedene (willkürliche) Bereiche einzuteilen die eine Abschätzung von kleinen, mittleren und großen Effektstärken ermöglicht.</p>
<p>Da wir beim CRD üblicherweise mehr als zwei Faktorstufen haben, ist die Berechnung einer möglichen Effektstärke etwas komplizierter und ein übliche Formel für die Effektstärke <span class="math inline">\(f\)</span> folgt:</p>
<p><span class="math display">\[\begin{equation}
f = \frac{\sigma_{\text{between}}}{\sigma_{\epsilon}} = \frac{\sqrt{\frac{\sum\tau_i^2}{k}}}{\sigma_{\epsilon}}
\label{eq-ed-crd-f}
\end{equation}\]</span></p>
<p>D.h. die mittleren quadrierte Effekte der Faktorstufen <span class="math inline">\(\tau_i\)</span> werden durch die Residualstandardabweichung geteilt. Also letztendlich wieder eine Abweichung, dieses Mal eine gemittelte, geteilt durch eine Streuung.</p>
<p>Ein Problem bei der Effektstärke <span class="math inline">\(f\)</span> im CRD-Design ist, dass wir keine eins-zu-eins Abbildung von <span class="math inline">\(f\)</span> auf eine Verteilung verschiedener Mittelwertswerte haben. In <a href="#fig-ed-crd-f-01" class="quarto-xref">Abbildung&nbsp;<span>23.3</span></a> sind drei verschiedene Anordnungen der Mittelwerte bei identischer Effektstärke <span class="math inline">\(f\)</span> abgetragen.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ed-crd-f-01" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ed-crd-f-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_crd_files/figure-html/fig-ed-crd-f-01-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ed-crd-f-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;23.3: Drei verschiedene Beispiele für die gleiche Effektstärke <span class="math inline">\(f = 0.7\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Dies macht daher die Interpretation von <span class="math inline">\(f\)</span> deutlich schwieriger als das im einfachen Fall von Cohen’s D für den Vergleich zwischen zwei Mittelwerten der Fall ist.</p>
<p>Leider hören hier nicht die Problem auf, sondern es gibt eine ganze Reihe von weiteren Effektstärken die in der Literatur anzutreffen sind. Dazu gehören vor allem das weit verbreitete <span class="math inline">\(\eta^2\)</span> und das weniger bekannte <span class="math inline">\(\omega^2\)</span>.</p>
<p><span class="math display">\[\begin{align*}
\eta^2 &amp;= \frac{SS_{B}}{SS_{Total}} \\
\omega^2 &amp;= \frac{f^2}{1 + f^2} \\
&amp;= \frac{SS_B - (K-1)MS_W}{SS_{\text{Total}}+MS_W} \\
&amp;= \frac{(K-1)(F-1)}{(K-1)(F-1)+N}\\
f^2 &amp;=\frac{\omega^2}{1-\omega^2}
\end{align*}\]</span></p>
<p>Das Problem besteht darin, das oft <span class="math inline">\(\eta^2\)</span> in der Literatur verwendet wird, trotzdem bekannt ist, dass die Effektstärke oft stark überschätzt wird und daher neuere Literatur die Verwendung von <span class="math inline">\(\omega^2\)</span> empfielt (<span class="citation" data-cites="levine2002">Levine und Hullett (<a href="references.html#ref-levine2002" role="doc-biblioref">2002</a>)</span>, <span class="citation" data-cites="olejnik2003">Olejnik und Algina (<a href="references.html#ref-olejnik2003" role="doc-biblioref">2003</a>)</span>, <span class="citation" data-cites="kroes2023">Kroes und Finley (<a href="references.html#ref-kroes2023" role="doc-biblioref">2023</a>)</span>).</p>
<p>In der Literatur werden Einteilungen der Effektstärken anhand von Überlegungen zur Varianzaufklärung verwendet um den Effektstärken eine qualitative Bewertung zu geben (siehe z.B. <span class="citation" data-cites="cohen1988">Cohen (<a href="references.html#ref-cohen1988" role="doc-biblioref">1988</a>)</span>).</p>
<table class="table">
<caption>Einordnung der Effektstärken</caption>
<thead>
<tr class="header">
<th></th>
<th><span class="math inline">\(f\)</span></th>
<th><span class="math inline">\(\omega^2\)</span></th>
<th><span class="math inline">\(\eta^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>klein</td>
<td>0.1</td>
<td>0.01</td>
<td>0.01</td>
</tr>
<tr class="even">
<td>mittel</td>
<td>0.25</td>
<td>0.06</td>
<td>0.06</td>
</tr>
<tr class="odd">
<td>groß</td>
<td>0.40</td>
<td>0.14</td>
<td>0.14</td>
</tr>
</tbody>
</table>
<p>Diese Einteilung wird oft miesverständlich als Maß für praktische Relevanz interpretiert. Das zum Beispiel ein größer Effekt automatisch praktische Relevanz nach sich zieht und ein kleiner Effekt auch keine praktische Relevanz hat. Diese Interpretation ist jedoch in den meisten Fällen zu simpel und eine gegebene Effektstärke sollte immer im Rahmen der konkreten Untersuchung interpretiert werden. Die Hauptnützlichkeit von Effektstärken beruht jedoch wahrscheinlich darin die Berechnung von Stichprobengrößen mittels einer Poweranalyse zu vereinfachen.</p>
</section>
<section id="crd-effektstärken-in-r" class="level3" data-number="23.4.2">
<h3 data-number="23.4.2" class="anchored" data-anchor-id="crd-effektstärken-in-r"><span class="header-section-number">23.4.2</span> CRD Effektstärken in <code>R</code></h3>
<p>In <code>R</code> können die Effektgrößen mittels verschiedener Funktion aus dem package <code>effectsize</code> berechnet werden. Für unser Beispiel mit den <span class="math inline">\(8\)</span>km Laufdaten erhalten wir beispielsweise.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">cohens_f</span>(mod_aov, <span class="at">verbose=</span>F)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA

Parameter | Cohen's f |      95% CI
-----------------------------------
Gruppe    |      0.89 | [0.62, Inf]

- One-sided CIs: upper bound fixed at [Inf].</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">omega_squared</span>(mod_aov, <span class="at">verbose=</span>F)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA

Parameter | Omega2 |       95% CI
---------------------------------
Gruppe    |   0.42 | [0.25, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
</div>
<p>Die Funktionen aus <code>effectsize</code> liefern auch gleich noch Konfidenzintervalle für die Effektstärken mit, da natürlich auch die Schätzung von Effektstärken mit Unsicherheiten behaftet ist.</p>
</section>
</section>
<section id="replikationsfaktor-a-prior-ermitteln" class="level2" data-number="23.5">
<h2 data-number="23.5" class="anchored" data-anchor-id="replikationsfaktor-a-prior-ermitteln"><span class="header-section-number">23.5</span> Replikationsfaktor a-prior ermitteln</h2>
<p>Um bei unserem Experiment sicher zu stellen, dass wir auch eine realistische Chance haben einen gewünschten Effekt zu finden, müssen wir vor dem Experiment eine Power-Analyse durchführen um den notwendig Replikationsfaktor für die experimentellen Einheiten EU zu bestimmen. In dem Fall, dass die EUs äquivalent zu den Untersuchungsteilnehmerinnen und Untersuchungsteilnehmer sind führt dies dementsprechend zur Bestimmung der Stichprobengröße.</p>
<p>Dazu stehen uns in den meisten Fällen drei verschiedene Herangehensweisen zur Verfügung</p>
<ol type="1">
<li>Anhand der Literatur wird <span class="math inline">\(f\)</span> bestimmt.</li>
<li>Es wird ein relevantes/plausibels <span class="math inline">\(\Delta\)</span> als der Unterschied zwischen zwei Gruppen angesetzt.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></li>
<li>Präzision der Konfidenzintervalle</li>
</ol>
<p>Den letzten Fall 3. werden im Zusammenhang mit dem nächsten Kapitel zu linearen Kontrasten behandeln.</p>
<p>Noch einmal grundsätzlich zur Wiederholung wie die Power hergeleitet werden kann. Ausgangspunkt sind wie immer die beiden Hypothesen <span class="math inline">\(H_0\)</span> und <span class="math inline">\(H_1\)</span> unter deren Annahmen wir uns die Verteilung unsere Teststatistik anschauen. Im vorliegenden Fall des CRD ist die Teststatistik der <span class="math inline">\(F\)</span> Wert der einer <span class="math inline">\(F\)</span>-Verteilung folgt. In <a href="#fig-ed-crd-f-power" class="quarto-xref">Abbildung&nbsp;<span>23.4</span></a> ist dies exemplarisch abgebildet.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ed-crd-f-power" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ed-crd-f-power-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_crd_files/figure-html/fig-ed-crd-f-power-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ed-crd-f-power-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;23.4: <span class="math inline">\(F\)</span>-Verteilung unter der <span class="math inline">\(H_0\)</span> und der <span class="math inline">\(H_1\)</span> und der kritische Wert für <span class="math inline">\(\alpha = 0.05\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Unter der <span class="math inline">\(H_1\)</span> folgt <span class="math inline">\(F\)</span> einer <span class="math inline">\(F(df_1, df_2, \lambda)\)</span>-Verteilung. <span class="math inline">\(\lambda\)</span> ist der sogenannten Nichtzentralitätsparameter. Diese Verteilung wird daher auch als nichtzentrale <span class="math inline">\(F\)</span>-Verteilung bezeichnet. Der Nichtzentralitätsparameter hängt dabei mit unserem Wert <span class="math inline">\(Q(\tau_i)\)</span> zusammen. Umso größer der Unterschied zwischen den verschiedenen Faktorstufen, umso größer auch der Nichtzentralitätsparameter.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ed-crd-power-01" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ed-crd-power-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_crd_files/figure-html/fig-ed-crd-power-01-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ed-crd-power-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;23.5: Beispiele für die Veränderung der <span class="math inline">\(F\)</span>-Verteilung bzw. der nichtzentralen <span class="math inline">\(F\)</span>-Verteilung bei <span class="math inline">\(f = 0.4\)</span> und zunehmender Stichprobengröße. rot sind die <span class="math inline">\(1 - \alpha = 0.95\)</span>-Quartilen unter der <span class="math inline">\(H_0\)</span> während schwarz die <span class="math inline">\(\beta = 0.2\)</span>-Quartilen unter der <span class="math inline">\(H_1\)</span> sind.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-ed-crd-power-01" class="quarto-xref">Abbildung&nbsp;<span>23.5</span></a> ist die Veränderung der <span class="math inline">\(F\)</span>-Verteilungen unter der <span class="math inline">\(H_0\)</span> und der entsprechenden <span class="math inline">\(H_1\)</span> bei Veränderung des Replikationsfaktors abgebildet. Wir können erkennen, das die <span class="math inline">\(1-\alpha\)</span>-Quantile unter der <span class="math inline">\(H_0\)</span> immer weiter nach rechts wandert, während die <span class="math inline">\(\beta\)</span>-Quantile unter der <span class="math inline">\(H_1\)</span> immer weiter nach links wandert. D.h. wir suchen die Zahl bei der die <span class="math inline">\(1-\alpha\)</span>-Quantile unter der <span class="math inline">\(H_0\)</span> gleich der <span class="math inline">\(\beta = 0.2\)</span>-Quantile unter der <span class="math inline">\(H_1\)</span> ist. Da sich die Quantilen allerdings in Abhängigkeit von der Stichprobengröße ändern, rechnen wir dies am einfachsten durch einen ausprobieren aus. Für einen gegebene Stichprobengröße wird der Nichtzentralitiätsparameter <span class="math inline">\(\lambda\)</span> bestimmt, der dann dazu benutzt wird den Wert unter der <span class="math inline">\(H_1\)</span> zu bestimmen. Bei Kenntnis von <span class="math inline">\(f\)</span> geht dies ziemlich einfach.</p>
<p>Wir extrahieren die notwendigen Informationen bereits dokumentierter Ergebnisse in der Literatur. Beispielsweise anhand der Quadratsummen aus den <span class="math inline">\(F\)</span>-Tabellen oder im einfachsten Fall direkt mittels der dokumentierten Effektstärke <span class="math inline">\(f\)</span>.</p>
<p>Konkret berechnet sich <span class="math inline">\(\lambda\)</span> nach.</p>
<p><span class="math display">\[\begin{equation}
\lambda = (K-1)Q(\tau_i)/\sigma^2
\end{equation}\]</span></p>
<p><span class="math inline">\(K\)</span> ist die Anzahl der Faktorstufen. Eine alternative Berechnung unter der direkten Verwendung der Effekstärke <span class="math inline">\(f\)</span> lautet.</p>
<p><span class="math display">\[\begin{equation}
\lambda = nKf^2
\label{ed-crd-lambda-02}
\end{equation}\]</span></p>
<p>In <a href="#tbl-ed-crd-power-01" class="quarto-xref">Tabelle&nbsp;<span>23.4</span></a> sind die entsprechenden Werten für die Quantilen und der <span class="math inline">\(H_0\)</span> und der <span class="math inline">\(H_1\)</span> unter den entsprechenden Replikationsfaktoren abgebildet.</p>
<div class="cell">
<div id="tbl-ed-crd-power-01" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ed-crd-power-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;23.4: Aufstellung der Power bei <span class="math inline">\(f = 0.25\)</span> für verschiedene <span class="math inline">\(n\)</span> Replikationen pro Faktorstufe bei <span class="math inline">\(K = 4\)</span> Faktorstufen.
</figcaption>
<div aria-describedby="tbl-ed-crd-power-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">n</th>
<th style="text-align: right;"><span class="math inline">\(df_1\)</span></th>
<th style="text-align: right;"><span class="math inline">\(df_2\)</span></th>
<th style="text-align: right;"><span class="math inline">\(q_{H_0}\)</span></th>
<th style="text-align: right;"><span class="math inline">\(q_{\beta}\)</span></th>
<th style="text-align: right;">power</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">2.87</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: right;">0.21</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">2.78</td>
<td style="text-align: right;">0.70</td>
<td style="text-align: right;">0.30</td>
</tr>
<tr class="odd">
<td style="text-align: right;">18</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">68</td>
<td style="text-align: right;">2.74</td>
<td style="text-align: right;">0.62</td>
<td style="text-align: right;">0.38</td>
</tr>
<tr class="even">
<td style="text-align: right;">22</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">84</td>
<td style="text-align: right;">2.71</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">0.46</td>
</tr>
<tr class="odd">
<td style="text-align: right;">26</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">2.70</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">0.54</td>
</tr>
<tr class="even">
<td style="text-align: right;">30</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">116</td>
<td style="text-align: right;">2.68</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.61</td>
</tr>
<tr class="odd">
<td style="text-align: right;">34</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">132</td>
<td style="text-align: right;">2.67</td>
<td style="text-align: right;">0.33</td>
<td style="text-align: right;">0.67</td>
</tr>
<tr class="even">
<td style="text-align: right;">38</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">148</td>
<td style="text-align: right;">2.67</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.72</td>
</tr>
<tr class="odd">
<td style="text-align: right;">42</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">164</td>
<td style="text-align: right;">2.66</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">0.77</td>
</tr>
<tr class="even">
<td style="text-align: right;">46</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">180</td>
<td style="text-align: right;">2.65</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.81</td>
</tr>
<tr class="odd">
<td style="text-align: right;">50</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">2.65</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.85</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>In <a href="#tbl-ed-crd-power-01" class="quarto-xref">Tabelle&nbsp;<span>23.4</span></a> sehen wir, dass wir bei einem Effekt von <span class="math inline">\(f = 0.25\)</span> bei vier Faktorstufen bei einer Power von power <span class="math inline">\(=0.8\)</span> mehr als <span class="math inline">\(42\)</span> Replikationen brauchen.</p>
<p>Im Fall 2. gehen wir weniger von dokumentierten Effekten sondern über die Überlegung eines für uns praktisch relevanten Effekts aus. Hergeleitet aus theoretischen Überlegungen setzen wir einen minimalen praktisch relevanten Effekt <span class="math inline">\(\Delta\)</span> fest. Dies kann zum Beispiel anhand von Überlegungen welche Effektgröße bei einer Gesundheitsintervention benötigt wird um einen relevanten Effekt bei der Patientenpopulation auszulösen. Ausgehend von diesem minimalen Effekt <span class="math inline">\(\Delta\)</span> wird dann die Abschätzung der Stichprobengröße durchgeführt. Hier gehen wir im konservativen Fall davon aus, dass der Unterschied zwischen zwei Faktorstufen vorliegt, während die anderen Faktorstufen genau in der Mitte zwischen diesen beiden Faktorstuffen liegen. Dies führt dazu, dass die beiden <em>extremen</em> Faktorstufen die Werte <span class="math inline">\(\tau_1 = \Delta/2\)</span> und <span class="math inline">\(tau_2 = -\Delta/2\)</span> während für die verbleibenden Faktorstufen <span class="math inline">\(\Delta_i = 0, i \neq {1,2}\)</span> (siehe <a href="#fig-ed-crd-power-delta" class="quarto-xref">Abbildung&nbsp;<span>23.6</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ed-crd-power-delta" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ed-crd-power-delta-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_crd_files/figure-html/fig-ed-crd-power-delta-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ed-crd-power-delta-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;23.6: Mögliche Abschätzung von <span class="math inline">\(\Delta\)</span>
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-ed-crd-power-delta" class="quarto-xref">Abbildung&nbsp;<span>23.6</span></a> ist diese Abschätzung graphisch abgebildet. Aus der Literatur benötigen wir allerdings dann immernoch eine Abschätzung über die zu erwartenden Residualvarianz <span class="math inline">\(\sigma^2\)</span>. Wenn diese ermittelt ist, dann kann die Effektstärke <span class="math inline">\(f\)</span> nach der folgenden Formel ermittelt werden.</p>
<p><span class="math display">\[\begin{equation}
f = \sqrt{\frac{\Delta^2}{2K\sigma^2}}
\label{eq-ed-crd-f-power}
\end{equation}\]</span></p>
<p>Die ermittelte Effektstärke <span class="math inline">\(f\)</span> kann dann verwendet werden um mittels Formel <span class="math inline">\(\eqref{eq-ed-crd-lambda-02}\)</span> den Nichtzentralitätsparameter zu bestimmen und dadurch die Stichprobengröße zu bestimmen.</p>
<section id="replikationsfaktor-a-priori-in-r-ermitteln" class="level3" data-number="23.5.1">
<h3 data-number="23.5.1" class="anchored" data-anchor-id="replikationsfaktor-a-priori-in-r-ermitteln"><span class="header-section-number">23.5.1</span> Replikationsfaktor a-priori in <code>R</code> ermitteln</h3>
<p>In <code>R</code> können wir direkt die Effektstärke <span class="math inline">\(f\)</span> verwenden um mittels der Funktion <code>pwr.anova.test()</code> aus dem package <code>pwr</code> die Anzahl der Replikationen zu berechnen. Bei der Funktion muss immer einer der Parameter <span class="math inline">\(f\)</span>, <span class="math inline">\(k\)</span>, <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(power\)</span> oder <span class="math inline">\(n\)</span> übergeben werden. Die Funktion bestimmt dann entsprechend den fehlenden Wert. Wollen wir z.B. die notwendige Stichprobengröße pro Faktorstufe für <span class="math inline">\(f = 0.39, K = 3, \alpha = 0.05, \text{power} = 0.8\)</span> bestimmen, dann können wir dies wie folgt erreichen.</p>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>pwr<span class="sc">::</span><span class="fu">pwr.anova.test</span>(<span class="at">f =</span> <span class="fl">0.89</span>, <span class="at">k =</span> <span class="dv">3</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>, <span class="at">power =</span> <span class="fl">0.8</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code> Balanced one-way analysis of variance power calculation 

          k = 3
          n = 5.195473
          f = 0.89
  sig.level = 0.05
      power = 0.8</code></pre>
<p>NOTE: n is number in each group</p>
<p>Da wir immer nur <em>vollständige</em> Untersuchungspersonen einsetzen können wird die Anzahl <span class="math inline">\(n\)</span> pro Gruppe aufgerundet. D.h. im vorliegenden Fall bräuchten wir insgesamt <span class="math inline">\(N = 3 * n = 3 * 5 = 15\)</span> Personen.</p>
<div id="exm-ed-crd-power-01" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 23.2</strong></span> Alternativ, gehen wir zum Beispiel davon aus, dass wir von einem Unterschied von <span class="math inline">\(\Delta = 5s\)</span> ausgehen auf Grund der Koffeingabe. Der Formel <span class="math inline">\(\eqref{eq-ed-crd-f-power}\)</span> folgend würde daraus die folgende Berechnung resultieren bei einer Power von <span class="math inline">\(0.9\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>delta <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>sigma_sqr <span class="ot">&lt;-</span> <span class="fu">sigma</span>(mod_aov)<span class="sc">**</span><span class="dv">2</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(delta<span class="sc">**</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>K<span class="sc">*</span>sigma_sqr))</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>pwr<span class="sc">::</span><span class="fu">pwr.anova.test</span>(<span class="at">f =</span> f, <span class="at">k =</span> K, <span class="at">sig.level =</span> <span class="fl">0.05</span>, <span class="at">power =</span> <span class="fl">0.9</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Balanced one-way analysis of variance power calculation 

              k = 3
              n = 45.23065
              f = 0.308862
      sig.level = 0.05
          power = 0.9

NOTE: n is number in each group</code></pre>
</div>
</div>
<p>D.h. wir bräuchten in diesem Fall schon <span class="math inline">\(n = 46\)</span> Athletinnen pro Gruppe.</p>
</div>
<div id="exm-ed-crd-power-01" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 23.3</strong></span> Alternative unter der Verteilungsfunktionen <code>df()</code> und <code>qf()</code> können wir den Wert auch fußläufig ausrechnen wie in <a href="#tbl-ed-crd-power-01" class="quarto-xref">Tabelle&nbsp;<span>23.4</span></a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">45</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>df_1 <span class="ot">&lt;-</span> K <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>df_2 <span class="ot">&lt;-</span> n<span class="sc">*</span>K <span class="sc">-</span> K</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>q_h0 <span class="ot">&lt;-</span> <span class="fu">qf</span>(<span class="fl">0.95</span>, <span class="at">df1 =</span> df_1, <span class="at">df2 =</span> df_2)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> n <span class="sc">*</span> K <span class="sc">*</span> f<span class="sc">**</span><span class="dv">2</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pf</span>(q_h0, df_1, df_2, lambda)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8984035</code></pre>
</div>
</div>
</div>
<div id="exm-ed-crd-power-02" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 23.4</strong></span> In <span class="citation" data-cites="bradley2009">Bradley u.&nbsp;a. (<a href="references.html#ref-bradley2009" role="doc-biblioref">2009</a>)</span> wurden die Unterschiede in hochintensiven Läufe bei Fußballspielern aus der Premiere League zwischen verschiedenen Spielpositionen untersucht. Es wurden die folgenden Daten gefunden.</p>
<div class="cell">
<div id="tbl-ed-crd-exm-02" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ed-crd-exm-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;23.5: Ergebnisse der Untersuchung aus Bradley et al.&nbsp;2009 bei hochintensiver Distanz (in m) bei Fußballern aus der Premiere League auf den Positionen c = Innenverteidiger, fb = Außenverteidiger, cm = Zentrales Mittelfeld, wm = Äußeres Mittelfeld, at = Angreifer.
</figcaption>
<div aria-describedby="tbl-ed-crd-exm-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Mittelwert</th>
<th style="text-align: right;">STD</th>
<th style="text-align: left;">Position</th>
<th style="text-align: right;">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1834</td>
<td style="text-align: right;">256</td>
<td style="text-align: left;">cd</td>
<td style="text-align: right;">92</td>
</tr>
<tr class="even">
<td style="text-align: right;">2605</td>
<td style="text-align: right;">387</td>
<td style="text-align: left;">fb</td>
<td style="text-align: right;">84</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2825</td>
<td style="text-align: right;">473</td>
<td style="text-align: left;">cm</td>
<td style="text-align: right;">80</td>
</tr>
<tr class="even">
<td style="text-align: right;">3138</td>
<td style="text-align: right;">565</td>
<td style="text-align: left;">wm</td>
<td style="text-align: right;">52</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2341</td>
<td style="text-align: right;">575</td>
<td style="text-align: left;">at</td>
<td style="text-align: right;">62</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Anhand dieser Information können wir mittels Formel <span class="math inline">\(\eqref{eq-ed-crd-sse-total}\)</span> die notwendigen Informationen berechnen. Die Daten aus dem Artikel sind in einem <code>tibble()</code> mit dem Namen <code>bradley</code> gespeichert. Wir vernachlässigen, dass die Spieler keine EUs darstellen, da sie aus clustern aus Mannschaften stammen und damit nicht unabhängig voneinander sind.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>sigma_bet <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>((bradley<span class="sc">$</span>m<span class="sc">-</span><span class="fu">mean</span>(bradley<span class="sc">$</span>m))<span class="sc">**</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">5</span>) </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>sigma_e <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>((bradley<span class="sc">$</span>n<span class="dv">-1</span>)<span class="sc">*</span>bradley<span class="sc">$</span>s<span class="sc">**</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="fu">sum</span>(bradley<span class="sc">$</span>n)<span class="sc">-</span><span class="dv">5</span>))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> sigma_bet<span class="sc">/</span>sigma_e</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>f</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9936008</code></pre>
</div>
</div>
<p>Mit der Effekstärke <span class="math inline">\(f\)</span> kann dann wieder die gewünschte Power berechnet werden.</p>
</div>
</section>
</section>
<section id="verbindung-modellhierarchien-und-ba-anova-advanced" class="level2" data-number="23.6">
<h2 data-number="23.6" class="anchored" data-anchor-id="verbindung-modellhierarchien-und-ba-anova-advanced"><span class="header-section-number">23.6</span> Verbindung Modellhierarchien und BA-ANOVA (advanced)</h2>
<p>Im Bachelor wurde das completely randomized design aller Wahrscheinlichkeit nach unter der Bezeichnung Einfaktorielle ANOVA eingeführt. Was eigentlich nicht viel Sinn macht, da es sich bei der einfaktoriellen ANOVA um eine Analysemethode und streng genommen nicht um ein experimentelles Design handelt. Wenn wir die folgenden beiden Identitäten berücksichtigen.</p>
<p><span class="math display">\[\begin{equation}
\sum_i (y_i - \hat{y}) = \sum_i y_i - n \hat{y} = n \hat{y} - n \hat{y} = 0
\label{eq-ed-crd-bar-sum}
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{align}
\begin{split}
\sum_i \sum_j 2 (y_{ij} - \hat{y}_j)(\hat{y}_j - \hat{y}) &amp;= \sum_j \sum_i 2 (y_{ij} - \hat{y}_j)(\hat{y}_j - \hat{y}) \\
&amp;= 2 \sum_j (\hat{y}_j - \hat{y}) \underbrace{\sum_i (y_{ij} - \hat{y}_j)}_{\text{mit} ~(\ref{eq-ed-crd-bar-sum})=0}\\
&amp;= 2 \sum_j (\hat{y}_j - \hat{y}) 0  = 0 \\
\end{split}
\label{eq-ed-crd-cross-sum}
\end{align}\]</span></p>
<p>Dann können wir <span class="math inline">\(SS_{\text{total}}\)</span> nach dem folgenden Muster aufspalten.</p>
<p><span class="math display">\[\begin{align}
\begin{split}
\underbrace{\sum_i \sum_j (y_{ij} - \hat{y})^2}_{SS_{\text{Total}}} &amp;= \sum_i \sum_j (y_{ij} - \hat{y}_j + \hat{y}_j - \hat{y})^2 \\ &amp;= \sum_i \sum_j (y_{ij} - \hat{y}_j)^2 + \sum_i \sum_j (\hat{y}_j - \hat{y})^2 - \underbrace{\sum_i \sum_j 2 (y_{ij} - \hat{y}_j)(\hat{y}_j - \hat{y})}_{\text{mit}~(\ref{eq-ed-crd-cross-sum})=0}\\
&amp;= \underbrace{\sum_i \sum_j (y_{ij} - \hat{y}_j)^2}_{SS_{\text{Error}}} + \underbrace{\sum_i \sum_j (\hat{y}_j - \hat{y})^2}_{SS_{\text{Regression}}}
\end{split}
\label{eq-ed-crd-sse-total}
\end{align}\]</span></p>
<p>D.h. wir erhalten die schon bekannte Aufteilung in <span class="math inline">\(SS_{\text{Error}}\)</span> und <span class="math inline">\(SS_{\text{Regression}}\)</span> die uns in der Herleitung von <span class="math inline">\(R^2\)</span> begegnet ist. Ziehen wir jetzt <span class="math inline">\(SSE(R) - SSE(F)\)</span> voneinander ab.</p>
<p><span class="math display">\[\begin{align*}
SSE(R) - SSE(F) &amp;= \sum_i \sum_j (y_{ij} - \hat{y})^2 - \sum_i \sum_j (y_{ij} - \hat{y}_j)^2 \\
&amp;= \underbrace{\sum_i \sum_j (y_{ij} - \hat{y}_j)^2 + \sum_i \sum_j (\hat{y}_j - \hat{y})^2}_{\text{mit}~\eqref{eq-ed-crd-sse-total}}  - \sum_i \sum_j (y_{ij} - \hat{y}_j)^2 \\
&amp;= \sum_i \sum_j (\hat{y}_j - \hat{y})^2 \\
\end{align*}\]</span></p>
<p>Dann ist dies der gleiche Term wir ihn in der BA-ANOVA Vorlesung gesehen haben und der dort als <span class="math inline">\(QS_{\text{zwischen}}\)</span> bezeichnet worden ist.</p>
<p><span class="math display">\[\begin{equation*}
QS_{zwischen} = \sum_{j=1}^K \sum_{i=1}^{N_j} (\bar{x}_{j}-\bar{x})^2
\end{equation*}\]</span></p>
<p>Letztendlich kommen wir daher mit dem Ansatz der Modellvergleiche zum gleichen Ergebnis, aber wieder mit dem Vorteil, das das Verfahren der Modellvergleiche leichter zu verallgemeinern ist.</p>
</section>
<section id="zum-nach--und-weiterlesen" class="level2" data-number="23.7">
<h2 data-number="23.7" class="anchored" data-anchor-id="zum-nach--und-weiterlesen"><span class="header-section-number">23.7</span> Zum Nach- und Weiterlesen</h2>
<p>In <span class="citation" data-cites="pos_design_comp_exp">Krzywinski und Altman (<a href="references.html#ref-pos_design_comp_exp" role="doc-biblioref">2014</a>)</span> sind noch weitere Information zu CRD während in <span class="citation" data-cites="kutner2005">Kutner u.&nbsp;a. (<a href="references.html#ref-kutner2005" role="doc-biblioref">2005, p.677–692</a>)</span> noch mal die Herleitung detaillierter erklärt ist.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-bradley2009" class="csl-entry" role="listitem">
Bradley, P. S., W. Sheldon, B. Wooster, P. Olsen, P. Boanas, und P. Krustrup. 2009. <span>„High-intensity running in English FA Premier League soccer matches“</span>. <em>Journal of Sports Sciences</em> 27 (2): 159–68. <a href="https://doi.org/10.1080/02640410802512775">https://doi.org/10.1080/02640410802512775</a>.
</div>
<div id="ref-cohen1988" class="csl-entry" role="listitem">
Cohen, Jacob. 1988. <em>Statistical power analysis for the behavioral sciences</em>. 2. Aufl. Routledge.
</div>
<div id="ref-kroes2023" class="csl-entry" role="listitem">
Kroes, A. D. A., und J. R. Finley. 2023. <span>„Demystifying omega squared: Practical guidance for effect size in common analysis of variance designs“</span>. <em>Psychol Methods</em>. <a href="https://doi.org/10.1037/met0000581">https://doi.org/10.1037/met0000581</a>.
</div>
<div id="ref-pos_design_comp_exp" class="csl-entry" role="listitem">
Krzywinski, Martin, und Naomi Altman. 2014. <span>„Points of view: designing comparative experiments“</span>. <em>Nature methods</em> 11 (6): 597–98.
</div>
<div id="ref-kutner2005" class="csl-entry" role="listitem">
Kutner, Michael H, Christopher J Nachtsheim, John Neter, und William Li. 2005. <em>Applied Linear Statistical Models</em>. 5. Aufl. McGraw-Hill Irwin New York.
</div>
<div id="ref-levine2002" class="csl-entry" role="listitem">
Levine, Timothy R., und Craig R. Hullett. 2002. <span>„Eta Squared, Partial Eta Squared, and Misreporting of Effect Size in Communication Research“</span>. <em>Human Communication Research</em> 28 (4): 612–25. <a href="https://doi.org/10.1111/j.1468-2958.2002.tb00828.x">https://doi.org/10.1111/j.1468-2958.2002.tb00828.x</a>.
</div>
<div id="ref-milanese2011" class="csl-entry" role="listitem">
Milanese, Chiara, Francesco Piscitelli, Chiara Lampis, und Carlo Zancanaro. 2011. <span>„Anthropometry and body composition of female handball players according to competitive level or the playing position“</span>. <em>Journal of sports sciences</em> 29 (12): 1301–9. <a href="https://doi.org/10.1080/02640414.2011.591419">https://doi.org/10.1080/02640414.2011.591419</a>.
</div>
<div id="ref-olejnik2003" class="csl-entry" role="listitem">
Olejnik, S., und J. Algina. 2003. <span>„Generalized eta and omega squared statistics: measures of effect size for some common research designs“</span>. <em>Psychol Methods</em> 8 (4): 434–47. <a href="https://doi.org/10.1037/1082-989X.8.4.434">https://doi.org/10.1037/1082-989X.8.4.434</a>.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p><span class="math inline">\(\sigma\)</span> muss trotzdem anhand der Literatur abgeschätzt werden.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ed_basics.html" class="pagination-link" aria-label="Einführung">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Einführung</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ed_linear_contrasts.html" class="pagination-link" aria-label="Lineare Kontraste">
        <span class="nav-page-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Lineare Kontraste</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>