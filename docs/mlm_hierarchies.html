<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Scriptum - Fortgeschrittene Statistik - 18&nbsp; Modellhierarchien</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./lm_title.html" rel="next">
<link href="./mlm_dummy_coding.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>
<script>
  MathJax = {
    tex: {
      tags: 'ams'  // should be 'ams', 'none', or 'all'
    }
  };
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./mlm_title.html">Multiple Regression</a></li><li class="breadcrumb-item"><a href="./mlm_hierarchies.html"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Modellhierarchien</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Scriptum - Fortgeschrittene Statistik</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vorwort</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./r_startup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Eine Schnelleinführung in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Eine Übersicht über <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_kickoff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title"><code>R</code> Kickoff</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_example_workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Ein Beispielworkflow mit Skripten in <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Einfache Datenbearbeitung und Visualisierung in <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_literate_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Literate programming in <code>R</code></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stats_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistik</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Eine kleine Welt der Unsicherheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_significance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Statistische Signifikanz, p-Wert und Power</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Theoretische Verteilungen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Statistische Signifikanz, p-Wert und Power</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_hypotheses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Hypothesen testen</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./slm_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Das einfache Regressionmodell</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Einführung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Inferenz</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_model_fit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Modellfit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Vorhersage</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./mlm_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Einführung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_interactions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Interaktionseffekte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_dummy_coding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Integration von nominale Variablen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_hierarchies.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Modellhierarchien</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./lm_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Das allgemeine lineare Modell</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lm_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Synthese</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literatur</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#einfaches-modell" id="toc-einfaches-modell" class="nav-link active" data-scroll-target="#einfaches-modell"><span class="header-section-number">18.1</span> Einfaches Modell</a></li>
  <li><a href="#genereller-linearer-modell-testansatz" id="toc-genereller-linearer-modell-testansatz" class="nav-link" data-scroll-target="#genereller-linearer-modell-testansatz"><span class="header-section-number">18.2</span> Genereller Linearer Modell Testansatz</a>
  <ul class="collapse">
  <li><a href="#idee" id="toc-idee" class="nav-link" data-scroll-target="#idee"><span class="header-section-number">18.2.1</span> Idee</a></li>
  <li><a href="#leitfrage" id="toc-leitfrage" class="nav-link" data-scroll-target="#leitfrage"><span class="header-section-number">18.2.2</span> Leitfrage:</a></li>
  </ul></li>
  <li><a href="#genereller-linearer-modell-testansatz---full-model" id="toc-genereller-linearer-modell-testansatz---full-model" class="nav-link" data-scroll-target="#genereller-linearer-modell-testansatz---full-model"><span class="header-section-number">18.3</span> Genereller Linearer Modell Testansatz - Full model</a>
  <ul class="collapse">
  <li><a href="#volles-modell" id="toc-volles-modell" class="nav-link" data-scroll-target="#volles-modell"><span class="header-section-number">18.3.1</span> Volles Modell</a></li>
  <li><a href="#residualvarianz-ssef" id="toc-residualvarianz-ssef" class="nav-link" data-scroll-target="#residualvarianz-ssef"><span class="header-section-number">18.3.2</span> Residualvarianz SSE(F)</a></li>
  </ul></li>
  <li><a href="#genereller-linearer-modell-testansatz---reduced-model" id="toc-genereller-linearer-modell-testansatz---reduced-model" class="nav-link" data-scroll-target="#genereller-linearer-modell-testansatz---reduced-model"><span class="header-section-number">18.4</span> Genereller Linearer Modell Testansatz - Reduced model</a>
  <ul class="collapse">
  <li><a href="#reduziertes-modell" id="toc-reduziertes-modell" class="nav-link" data-scroll-target="#reduziertes-modell"><span class="header-section-number">18.4.1</span> Reduziertes Modell</a></li>
  <li><a href="#residualvarianz-sser" id="toc-residualvarianz-sser" class="nav-link" data-scroll-target="#residualvarianz-sser"><span class="header-section-number">18.4.2</span> Residualvarianz SSE(R)</a></li>
  </ul></li>
  <li><a href="#link-reduziertes-modell-und-stichprobenvarianz" id="toc-link-reduziertes-modell-und-stichprobenvarianz" class="nav-link" data-scroll-target="#link-reduziertes-modell-und-stichprobenvarianz"><span class="header-section-number">18.5</span> Link: Reduziertes Modell und Stichprobenvarianz</a></li>
  <li><a href="#genereller-linearer-modell-testansatz-1" id="toc-genereller-linearer-modell-testansatz-1" class="nav-link" data-scroll-target="#genereller-linearer-modell-testansatz-1"><span class="header-section-number">18.6</span> Genereller Linearer Modell Testansatz</a></li>
  <li><a href="#genereller-linearer-modell-testansatz---teststatistik" id="toc-genereller-linearer-modell-testansatz---teststatistik" class="nav-link" data-scroll-target="#genereller-linearer-modell-testansatz---teststatistik"><span class="header-section-number">18.7</span> Genereller Linearer Modell Testansatz - Teststatistik</a></li>
  <li><a href="#f-wert-als-teststatistik" id="toc-f-wert-als-teststatistik" class="nav-link" data-scroll-target="#f-wert-als-teststatistik"><span class="header-section-number">18.8</span> F-Wert als Teststatistik</a></li>
  <li><a href="#verteilung-der-f-statistik" id="toc-verteilung-der-f-statistik" class="nav-link" data-scroll-target="#verteilung-der-f-statistik"><span class="header-section-number">18.9</span> Verteilung der F-Statistik</a></li>
  <li><a href="#hypothesentest-mit-f-wert" id="toc-hypothesentest-mit-f-wert" class="nav-link" data-scroll-target="#hypothesentest-mit-f-wert"><span class="header-section-number">18.10</span> Hypothesentest mit F-Wert</a></li>
  <li><a href="#teilziel" id="toc-teilziel" class="nav-link" data-scroll-target="#teilziel"><span class="header-section-number">18.11</span> Teilziel</a></li>
  <li><a href="#beispiel-candy-problem" id="toc-beispiel-candy-problem" class="nav-link" data-scroll-target="#beispiel-candy-problem"><span class="header-section-number">18.12</span> Beispiel: Candy-Problem</a></li>
  <li><a href="#modelle-als-hierarchien-auffassen" id="toc-modelle-als-hierarchien-auffassen" class="nav-link" data-scroll-target="#modelle-als-hierarchien-auffassen"><span class="header-section-number">18.13</span> Modelle als Hierarchien auffassen</a>
  <ul class="collapse">
  <li><a href="#full-model" id="toc-full-model" class="nav-link" data-scroll-target="#full-model"><span class="header-section-number">18.13.1</span> Full model</a></li>
  <li><a href="#hierarchie" id="toc-hierarchie" class="nav-link" data-scroll-target="#hierarchie"><span class="header-section-number">18.13.2</span> Hierarchie</a></li>
  </ul></li>
  <li><a href="#modelle-als-hierarchien-auffassen-in-r" id="toc-modelle-als-hierarchien-auffassen-in-r" class="nav-link" data-scroll-target="#modelle-als-hierarchien-auffassen-in-r"><span class="header-section-number">18.14</span> Modelle als Hierarchien auffassen in <code>R</code></a></li>
  <li><a href="#vergleich-m_0-gegen-m_1" id="toc-vergleich-m_0-gegen-m_1" class="nav-link" data-scroll-target="#vergleich-m_0-gegen-m_1"><span class="header-section-number">18.15</span> Vergleich <span class="math inline">\(m_0\)</span> gegen <span class="math inline">\(m_1\)</span></a></li>
  <li><a href="#vergleich-m_1-gegen-m_2" id="toc-vergleich-m_1-gegen-m_2" class="nav-link" data-scroll-target="#vergleich-m_1-gegen-m_2"><span class="header-section-number">18.16</span> Vergleich <span class="math inline">\(m_1\)</span> gegen <span class="math inline">\(m_2\)</span></a></li>
  <li><a href="#vergleich-m_2-gegen-full-model-m_3" id="toc-vergleich-m_2-gegen-full-model-m_3" class="nav-link" data-scroll-target="#vergleich-m_2-gegen-full-model-m_3"><span class="header-section-number">18.17</span> Vergleich <span class="math inline">\(m_2\)</span> gegen full model <span class="math inline">\(m_3\)</span></a></li>
  <li><a href="#vergleich-full-model-m_3-gegen-minmales-modell-m_0" id="toc-vergleich-full-model-m_3-gegen-minmales-modell-m_0" class="nav-link" data-scroll-target="#vergleich-full-model-m_3-gegen-minmales-modell-m_0"><span class="header-section-number">18.18</span> Vergleich full model <span class="math inline">\(m_3\)</span> gegen minmales Modell <span class="math inline">\(m_0\)</span></a></li>
  <li><a href="#in-summary-m_3-gegen-m_0" id="toc-in-summary-m_3-gegen-m_0" class="nav-link" data-scroll-target="#in-summary-m_3-gegen-m_0"><span class="header-section-number">18.19</span> In <code>summary()</code> <span class="math inline">\(m_3\)</span> gegen <span class="math inline">\(m_0\)</span></a></li>
  <li><a href="#eine-nominale-variable-mit-vier-stufen" id="toc-eine-nominale-variable-mit-vier-stufen" class="nav-link" data-scroll-target="#eine-nominale-variable-mit-vier-stufen"><span class="header-section-number">18.20</span> Eine nominale Variable mit vier Stufen</a></li>
  <li><a href="#früher---analysis-of-variance-anova-bzw.-aov" id="toc-früher---analysis-of-variance-anova-bzw.-aov" class="nav-link" data-scroll-target="#früher---analysis-of-variance-anova-bzw.-aov"><span class="header-section-number">18.21</span> Früher - Analysis of Variance (ANOVA bzw. AOV)</a></li>
  <li><a href="#anova-in-r" id="toc-anova-in-r" class="nav-link" data-scroll-target="#anova-in-r"><span class="header-section-number">18.22</span> ANOVA in R</a></li>
  <li><a href="#ansatz-mittels-modellhierarchien" id="toc-ansatz-mittels-modellhierarchien" class="nav-link" data-scroll-target="#ansatz-mittels-modellhierarchien"><span class="header-section-number">18.23</span> Ansatz mittels Modellhierarchien</a>
  <ul class="collapse">
  <li><a href="#full-model-1" id="toc-full-model-1" class="nav-link" data-scroll-target="#full-model-1"><span class="header-section-number">18.23.1</span> Full model</a></li>
  <li><a href="#reduced-model" id="toc-reduced-model" class="nav-link" data-scroll-target="#reduced-model"><span class="header-section-number">18.23.2</span> Reduced model</a></li>
  </ul></li>
  <li><a href="#model-fit---full-model" id="toc-model-fit---full-model" class="nav-link" data-scroll-target="#model-fit---full-model"><span class="header-section-number">18.24</span> Model fit - Full model</a></li>
  <li><a href="#anova-mit-nur-einem-modell" id="toc-anova-mit-nur-einem-modell" class="nav-link" data-scroll-target="#anova-mit-nur-einem-modell"><span class="header-section-number">18.25</span> <code>anova()</code> mit nur einem Modell</a></li>
  <li><a href="#zum-nacharbeiten" id="toc-zum-nacharbeiten" class="nav-link" data-scroll-target="#zum-nacharbeiten"><span class="header-section-number">18.26</span> Zum Nacharbeiten</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Modellhierarchien</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Bisher waren wir damit beschäftigt unsere Modelle immer komplizierter zu machen, angefangen haben dem einfachen linearen Modell, das dann zum multiplen linearen Modell wurde mit mehreren <span class="math inline">\(x\)</span>-Variablen. Die konnten im nächsten Schritt miteinander interagieren und dann im letzten Schritt wurde die Anforderung aufgehoben, das die <span class="math inline">\(x\)</span>-Variablen kontinuierlich sein mussten. Letztendlich konnte aber immer das einfache Modell, die Punkt-Steigungsform, aus der Schule beibehalten werden. Nun werden wir noch eine direkte Verbindung zwischen dem Regressionsmodell und der Varianzanalyse aufzeigen.</p>
<section id="einfaches-modell" class="level2" data-number="18.1">
<h2 data-number="18.1" class="anchored" data-anchor-id="einfaches-modell"><span class="header-section-number">18.1</span> Einfaches Modell</h2>
<p>Wir beginnen mit einem einfachen Modell, das wiederum nur eine <span class="math inline">\(x\)</span> und eine <span class="math inline">\(y\)</span>-Variable hat.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>mod0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, simple)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod0)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x, data = simple)

Residuals:
      1       2       3       4 
-0.5817  0.9898 -0.2345 -0.1736 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   1.8414     0.7008   2.628    0.119
x             0.4574     0.3746   1.221    0.346

Residual standard error: 0.8376 on 2 degrees of freedom
Multiple R-squared:  0.4271,    Adjusted R-squared:  0.1406 
F-statistic: 1.491 on 1 and 2 DF,  p-value: 0.3465</code></pre>
</div>
</div>
<p>Hier ist jetzt zunächst einmal nichts Neues. Setzen wir uns aber noch einmal genauer mit den Abweichungen mit den Residuen auseinander. In der Besprechung des Determinationskoeffizienten <span class="math inline">\(R^2\)</span> haben wir schon die Unterteilung der Quadratsummen kennengelernt. Hier hatten wird auf die Aufteilung der Varianz von <span class="math inline">\(Y\)</span> SSTO in die beiden Komponenten Regressionsvarianz <span class="math inline">\(SSR\)</span> und Fehlervarianz <span class="math inline">\(SSE\)</span>. Es gilt.</p>
<p><span class="math display">\[\begin{equation}
SSTO = SSR + SSE
\end{equation}\]</span></p>
<p>Die Fehlerquadratsumme SSE ist definiert nach:</p>
<p><span class="math display">\[\begin{equation}
SSE = \sum_{i=1}^n (y_i - \hat{y}_i)^2
\end{equation}\]</span></p>
<p>Als die Summe der quadrierten Abweichungen der vorhergesagten Werte <span class="math inline">\(\hat{y}_i\)</span> von den tatsächlich beobachteten Werten <span class="math inline">\(y_i\)</span>.</p>
<p>Um die Werte <span class="math inline">\(\hat{y}_i\)</span> berechnen zu können, benötigen wir unser Modell. Dieses Modell hat zwei Parameter, die beiden Koeffizienten <span class="math inline">\(\beta_0\)</span> und <span class="math inline">\(\beta_1\)</span>. Die Anzahl der Parameter in dem Modell wird meistens per Konvention mit dem Symbol <span class="math inline">\(p\)</span> bezeichnet. In unserem Fall ist gilt daher <span class="math inline">\(p = 2\)</span>. Die Anzahl der Parameter <span class="math inline">\(p\)</span> ist verknüpft mit den sogenannten Freiheitsgraden <span class="math inline">\(df\)</span> (degrees of freedom). Die Freiheitsgrade von SSE berechnen sich nach <span class="math inline">\(N-p\)</span>, wobei <span class="math inline">\(N\)</span> die Anzahl der Beobachtungen, der Datenpunkte ist. In unseren Fall also <span class="math inline">\(N-2\)</span></p>
<p><span class="math display">\[\begin{equation}
df_E := n - p
\end{equation}\]</span></p>
<p>Die Frheitsgerade bestimmen die <em>effektive</em> Anzahl der Beobachtungen die zur Verfügung stehen um die Varianz <span class="math inline">\(\sigma^2\)</span> des Modells abzuschätzen. Dadurch, dass zwei Parameter anhand der Daten für das Modell bestimt werden, fallen zwei Datenpunkt raus als unabhängige Informationsquellen. Anders ausgedrückt, wenn ich die beiden Modellparameter, in unseren Fall <span class="math inline">\(\beta_0\)</span> und <span class="math inline">\(\beta_1\)</span> kenne, dann sind nur noch <span class="math inline">\(N-2\)</span> Datenpunkt frei variierbar. Sobald ich die Werte von <span class="math inline">\(N-2\)</span> Datenpunkten und die beiden Parameter kenne, kann ich die verbleibenden beiden Werte berechnen. Daher die Begriff der Freiheitsgrade.</p>
<p>Wir nun SSE durch die Anzahl der Freiheitsgerade teilen, dann lässt sich zeigen, das dieser Wert ein erwartungstreuer Schätzer für die Residualvarianz <span class="math inline">\(\sigma^2\)</span> in Bezug auf die Verteilungsannahme zu den <span class="math inline">\(\epsilon_i \sim \mathcal{N}(0,\sigma^2)\)</span> der Daten ist. Das Verhältnis von SSE zu <span class="math inline">\(df\)</span> wird als Mean squared error MSE bezeichnet.</p>
<p><span class="math display">\[\begin{equation}
MSE = \frac{SSE}{df_{E}} = \frac{\sum_{i=1}^n (y_i - \hat{y}_i)^2}{n-p} = \hat{\sigma}^2
\end{equation}\]</span></p>
<p>Im ersten Moment erscheint diese Begründung etwas undurchsichtig, aber tatsächlich ist diese Formel schon eine alte Bekannte die uns in Form der Stichprobenvarianz begegnet ist.</p>
<p>Wenn wir eine Stichprobe der Größe <span class="math inline">\(N\)</span> mit Werten <span class="math inline">\(y_i\)</span> haben, dann haben wir gelernt die Varianz mittels der Formel:</p>
<p><span class="math display">\[\begin{equation}
\hat{\sigma}^2 = s^2 = \frac{1}{n-1}\sum_{i=1}^2(y_i - \bar{y})^2
\end{equation}\]</span></p>
<p>zu berechnen. Was bei dieser Formel schon immer etwas quer gesessen hat, ist der Nenner mit <span class="math inline">\(N-1\)</span> anstatt einfach <span class="math inline">\(N\)</span> wie wir es vom Mittelwert kennen. Aber, um die Varianz zu berechnen benötigen wir einen Parameter, eben den Mittelwert. Dies führt wiederum dazu, dass nur <span class="math inline">\(N-1\)</span> Werte frei variiert werden können und wir sobald wir, neben dem Mittelwert <span class="math inline">\(\bar{y}\)</span>, <span class="math inline">\(N-1\)</span> Werte kennen, den verbleibenden Wert berechnen können.</p>
</section>
<section id="genereller-linearer-modell-testansatz" class="level2" data-number="18.2">
<h2 data-number="18.2" class="anchored" data-anchor-id="genereller-linearer-modell-testansatz"><span class="header-section-number">18.2</span> Genereller Linearer Modell Testansatz<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></h2>
<section id="idee" class="level3" data-number="18.2.1">
<h3 data-number="18.2.1" class="anchored" data-anchor-id="idee"><span class="header-section-number">18.2.1</span> Idee</h3>
<p>Wir bauen uns eine Teststatistik die die Verbesserung in der Vorhersage (<span class="math inline">\(=\)</span> Reduktion der Fehlervarianz) als Metrik verwendet. Modelle werden in eine Hierarchie gesetzt mit einfacheren Modellen untergeordnet zu komplexeren Modellen.</p>
</section>
<section id="leitfrage" class="level3" data-number="18.2.2">
<h3 data-number="18.2.2" class="anchored" data-anchor-id="leitfrage"><span class="header-section-number">18.2.2</span> Leitfrage:</h3>
<p><em>Bringt mir die Aufnahme Modellparameter eine in der Vorhersage von Y bzw. bezüglich der Aufklärung der Varianz in Y?</em></p>
</section>
</section>
<section id="genereller-linearer-modell-testansatz---full-model" class="level2" data-number="18.3">
<h2 data-number="18.3" class="anchored" data-anchor-id="genereller-linearer-modell-testansatz---full-model"><span class="header-section-number">18.3</span> Genereller Linearer Modell Testansatz - Full model</h2>
<p>Beispiel einfache lineare Regression</p>
<section id="volles-modell" class="level3" data-number="18.3.1">
<h3 data-number="18.3.1" class="anchored" data-anchor-id="volles-modell"><span class="header-section-number">18.3.1</span> Volles Modell</h3>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1 X_i + \epsilon_i, \quad \epsilon_i \sim \mathcal{N}(0,\sigma^2)
\]</span></p>
</section>
<section id="residualvarianz-ssef" class="level3" data-number="18.3.2">
<h3 data-number="18.3.2" class="anchored" data-anchor-id="residualvarianz-ssef"><span class="header-section-number">18.3.2</span> Residualvarianz SSE(F)</h3>
<p><span class="math display">\[
\textrm{SSE(F)}  = \sum_{i=1}^n(y_i - \hat{y}_i)^2 = \sum_{i=1}^n [y_i - (\beta_0 + \beta_1 x_i)]^2
\]</span></p>
<p>mit <span class="math inline">\(p = 2, dfE(F) = n - 2\)</span></p>
</section>
</section>
<section id="genereller-linearer-modell-testansatz---reduced-model" class="level2" data-number="18.4">
<h2 data-number="18.4" class="anchored" data-anchor-id="genereller-linearer-modell-testansatz---reduced-model"><span class="header-section-number">18.4</span> Genereller Linearer Modell Testansatz - Reduced model</h2>
<section id="reduziertes-modell" class="level3" data-number="18.4.1">
<h3 data-number="18.4.1" class="anchored" data-anchor-id="reduziertes-modell"><span class="header-section-number">18.4.1</span> Reduziertes Modell</h3>
<p><span class="math display">\[
Y_i = \beta_0 + \epsilon_i, \quad \epsilon_i \sim \mathcal{N}(0,\sigma^2)
\]</span></p>
</section>
<section id="residualvarianz-sser" class="level3" data-number="18.4.2">
<h3 data-number="18.4.2" class="anchored" data-anchor-id="residualvarianz-sser"><span class="header-section-number">18.4.2</span> Residualvarianz SSE(R)</h3>
<p><span class="math display">\[
\textrm{SSE(R)} = \sum_{i=1}^n (y_i - \beta_0)^2 = \sum_{i=1}^n(y_i - \bar{y})^2 = \textrm{SSTO}
\]</span></p>
<p>mit <span class="math inline">\(p = 1, dfE(R) = n - 1\)</span></p>
<p>Im Allgemeinen gilt: <span class="math inline">\(SSE(F) \leq SSE(R)\)</span></p>
</section>
</section>
<section id="link-reduziertes-modell-und-stichprobenvarianz" class="level2" data-number="18.5">
<h2 data-number="18.5" class="anchored" data-anchor-id="link-reduziertes-modell-und-stichprobenvarianz"><span class="header-section-number">18.5</span> Link: Reduziertes Modell und Stichprobenvarianz</h2>
<p><span class="math display">\[\begin{align*}
SSE &amp;= \sum_{i=1}^n(y_i - \beta_0)^2 = \sum_{i=1}^n (y_i^2 - 2y_i\beta_0 + \beta_0^2) \\
0 &amp;= \frac{\mathrm{d}}{\mathrm{d} \beta_0}\sum_{i=1}^n (y_i^2 - 2y_i\beta_0 + \beta_0^2) \\
0 &amp;= \sum_{i=1}^n (-2y_i + 2 \beta_0) = -2\sum_{i=1}^n y_i + 2\sum_{i=1}^n \beta_0\\
n\beta_0 &amp;= \sum_{i=1}^n y_i \\
\beta_0 &amp;= \frac{\sum_{i=1}^n y_i}{n} = \bar{y} \rightarrow \frac{SSE}{n-1} = \hat{\sigma}^2 = s^2
\end{align*}\]</span></p>
</section>
<section id="genereller-linearer-modell-testansatz-1" class="level2" data-number="18.6">
<h2 data-number="18.6" class="anchored" data-anchor-id="genereller-linearer-modell-testansatz-1"><span class="header-section-number">18.6</span> Genereller Linearer Modell Testansatz</h2>
<p>Annahme: Das reduzierte Modell ist korrekt. Dann sollte <span class="math display">\[
\textrm{SSE(R)} - \textrm{SSE(F)}
\]</span> eher klein sein (Beide Modelle haben einen gleich guten fit).</p>
<p>Annahme: Das reduzierte Modell ist falsch: Dann sollte <span class="math display">\[
\textrm{SSE(R)} - \textrm{SSE(F)}
\]</span> eher groß sein (Das reduzierte Modell kann die Daten nicht so gut fitten wie das komplizierte Modell)</p>
</section>
<section id="genereller-linearer-modell-testansatz---teststatistik" class="level2" data-number="18.7">
<h2 data-number="18.7" class="anchored" data-anchor-id="genereller-linearer-modell-testansatz---teststatistik"><span class="header-section-number">18.7</span> Genereller Linearer Modell Testansatz - Teststatistik</h2>
<p>Wenn das reduzierte Modell korrekt ist, dann lässt sich zeigen, dass: <span class="math display">\[
MS_{\textrm{test}} = \frac{\textrm{SSE(R)} - \textrm{SSE(F)}}{\textrm{dfE(R)} - \textrm{dfE(F)}}
\]</span> ein Schätzer für die Varianz <span class="math inline">\(\sigma^2\)</span> (<span class="math inline">\(\epsilon_i \sim \mathcal{N}(0,\sigma^2)\)</span>) ist.</p>
<p>Wenn das reduzierte Modell korrekt ist, dann ist auch das volle Modell korrekt. Daher ist dann:</p>
<p><span class="math display">\[
\textrm{MSE(F)} = \frac{\textrm{SSE(F)}}{\textrm{dfE(F)}}
\]</span> auch ein Schätzer für <span class="math inline">\(\sigma^2\)</span></p>
</section>
<section id="f-wert-als-teststatistik" class="level2" data-number="18.8">
<h2 data-number="18.8" class="anchored" data-anchor-id="f-wert-als-teststatistik"><span class="header-section-number">18.8</span> F-Wert als Teststatistik</h2>
<p><span class="math display">\[
F = \frac{MS_{\textrm{test}}}{MSE(F)}= \frac{\frac{\textrm{SSE(R)} - \textrm{SSE(F)}}{\textrm{dfE(R)} - \textrm{dfE(F)}}}{ \frac{\textrm{SSE(F)}}{\textrm{dfE(F)}}}
\]</span></p>
</section>
<section id="verteilung-der-f-statistik" class="level2" data-number="18.9">
<h2 data-number="18.9" class="anchored" data-anchor-id="verteilung-der-f-statistik"><span class="header-section-number">18.9</span> Verteilung der F-Statistik</h2>
<p><span class="math display">\[
F = \frac{MS_{\textrm{test}}}{MSE(F)}  \sim F(\textrm{dfE(R)}-\textrm{dfE(F)},\textrm{dfE(F)})
\]</span></p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mlm_hierarchies_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Beispiele für die F-Verteilung mit verschiedenen Freiheitsgraden <span class="math inline">\(df_1, df_2\)</span></figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="hypothesentest-mit-f-wert" class="level2" data-number="18.10">
<h2 data-number="18.10" class="anchored" data-anchor-id="hypothesentest-mit-f-wert"><span class="header-section-number">18.10</span> Hypothesentest mit F-Wert</h2>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mlm_hierarchies_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">F-Verteilung mit <span class="math inline">\(df_1 = 5, df_2 = 10\)</span> und kritischem Wert bei <span class="math inline">\(\alpha=0.05\)</span></figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
</section>
<section id="teilziel" class="level2" data-number="18.11">
<h2 data-number="18.11" class="anchored" data-anchor-id="teilziel"><span class="header-section-number">18.11</span> Teilziel</h2>
<ul>
<li>Durch den Vergleich von Modellen kann die Verbesserung/Verschlechterung der Modellvorhersage statistisch Überprüft werden</li>
<li>Alternativ: Brauchen ich zusätzliche Parameter oder reicht mir das einfache Modell?</li>
</ul>
</section>
<section id="beispiel-candy-problem" class="level2" data-number="18.12">
<h2 data-number="18.12" class="anchored" data-anchor-id="beispiel-candy-problem"><span class="header-section-number">18.12</span> Beispiel: Candy-Problem</h2>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mlm_hierarchies_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Zusammenhang zwischen der Präferenz für ein Bonbon und dem Süßgrad für verschiedene Weichheitsgrade</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="modelle-als-hierarchien-auffassen" class="level2" data-number="18.13">
<h2 data-number="18.13" class="anchored" data-anchor-id="modelle-als-hierarchien-auffassen"><span class="header-section-number">18.13</span> Modelle als Hierarchien auffassen</h2>
<section id="full-model" class="level3" data-number="18.13.1">
<h3 data-number="18.13.1" class="anchored" data-anchor-id="full-model"><span class="header-section-number">18.13.1</span> Full model</h3>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \beta_3 x_{1i}x_{2i} + \epsilon_i
\]</span></p>
</section>
<section id="hierarchie" class="level3" data-number="18.13.2">
<h3 data-number="18.13.2" class="anchored" data-anchor-id="hierarchie"><span class="header-section-number">18.13.2</span> Hierarchie</h3>
<p><span class="math display">\[\begin{align*}
m_0&amp;: y_i = \beta_0 + \epsilon_i \\
m_1&amp;: y_i = \beta_0 + \beta_1 x_{1i} + \epsilon_i \\
m_2&amp;: y_i = \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \epsilon_i \\
m_3&amp;: y_i = \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \beta_3 x_{1i}x_{2i} + \epsilon_i
\end{align*}\]</span></p>
<p>Es gilt: <span class="math inline">\(m_0 \subseteq m_1 \subseteq m_2 \subseteq m_3\)</span></p>
</section>
</section>
<section id="modelle-als-hierarchien-auffassen-in-r" class="level2" data-number="18.14">
<h2 data-number="18.14" class="anchored" data-anchor-id="modelle-als-hierarchien-auffassen-in-r"><span class="header-section-number">18.14</span> Modelle als Hierarchien auffassen in <code>R</code></h2>
<p>In R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mod_0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(like <span class="sc">~</span> <span class="dv">1</span>, candy)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>mod_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(like <span class="sc">~</span> sweetness, candy)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>mod_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(like <span class="sc">~</span> sweetness <span class="sc">+</span> moisture, candy)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>mod_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(like <span class="sc">~</span> sweetness <span class="sc">*</span> moisture, candy)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="vergleich-m_0-gegen-m_1" class="level2" data-number="18.15">
<h2 data-number="18.15" class="anchored" data-anchor-id="vergleich-m_0-gegen-m_1"><span class="header-section-number">18.15</span> Vergleich <span class="math inline">\(m_0\)</span> gegen <span class="math inline">\(m_1\)</span></h2>
<p><span class="math display">\[\begin{align*}
m_0: y_i &amp;= \beta_0 + \epsilon_i \\
m_1: y_i &amp;= \beta_0 + \beta_1 x_{1i} + \epsilon_i
\end{align*}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_0, mod_1)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Vergleich der Modellfits</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: right;">ResDF</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">SS</th>
<th style="text-align: right;">F</th>
<th style="text-align: right;">p-val</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Model 1: like ~ 1</td>
<td style="text-align: right;">77</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Model 2: like ~ sweetness</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9039.35</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="vergleich-m_1-gegen-m_2" class="level2" data-number="18.16">
<h2 data-number="18.16" class="anchored" data-anchor-id="vergleich-m_1-gegen-m_2"><span class="header-section-number">18.16</span> Vergleich <span class="math inline">\(m_1\)</span> gegen <span class="math inline">\(m_2\)</span></h2>
<p><span class="math display">\[\begin{align*}
m_1: y_i &amp;= \beta_0 + \beta_1 x_{1i} + \epsilon_i \\
m_2: y_i &amp;= \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \epsilon_i
\end{align*}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_1, mod_2)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Vergleich der Modellfits</caption>
<colgroup>
<col style="width: 54%">
<col style="width: 8%">
<col style="width: 4%">
<col style="width: 13%">
<col style="width: 10%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: right;">ResDF</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">SS</th>
<th style="text-align: right;">F</th>
<th style="text-align: right;">p-val</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Model 1: like ~ sweetness</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Model 2: like ~ sweetness + moisture</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16787.44</td>
<td style="text-align: right;">206.06</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="vergleich-m_2-gegen-full-model-m_3" class="level2" data-number="18.17">
<h2 data-number="18.17" class="anchored" data-anchor-id="vergleich-m_2-gegen-full-model-m_3"><span class="header-section-number">18.17</span> Vergleich <span class="math inline">\(m_2\)</span> gegen full model <span class="math inline">\(m_3\)</span></h2>
<p><span class="math display">\[\begin{align*}
m_2: y_i &amp;= \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \epsilon_i  \\
m_3: y_i &amp;= \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \beta_3 x_{1i} x_{2i} + \epsilon_i
\end{align*}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_2, mod_3)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Vergleich der Modellfits</caption>
<colgroup>
<col style="width: 54%">
<col style="width: 8%">
<col style="width: 4%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: right;">ResDF</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">SS</th>
<th style="text-align: right;">F</th>
<th style="text-align: right;">p-val</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Model 1: like ~ sweetness + moisture</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Model 2: like ~ sweetness * moisture</td>
<td style="text-align: right;">74</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5886.88</td>
<td style="text-align: right;">1951.72</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="vergleich-full-model-m_3-gegen-minmales-modell-m_0" class="level2" data-number="18.18">
<h2 data-number="18.18" class="anchored" data-anchor-id="vergleich-full-model-m_3-gegen-minmales-modell-m_0"><span class="header-section-number">18.18</span> Vergleich full model <span class="math inline">\(m_3\)</span> gegen minmales Modell <span class="math inline">\(m_0\)</span></h2>
<p><span class="math display">\[\begin{align*}
m_0: y_i &amp;= \beta_0 + \epsilon_i  \\
m_3: y_i &amp;= \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \beta_3 x_{1i} x_{2i} + \epsilon_i
\end{align*}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_0, mod_3)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Vergleich der Modellfits</caption>
<colgroup>
<col style="width: 53%">
<col style="width: 8%">
<col style="width: 4%">
<col style="width: 13%">
<col style="width: 11%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: right;">ResDF</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">SS</th>
<th style="text-align: right;">F</th>
<th style="text-align: right;">p-val</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Model 1: like ~ 1</td>
<td style="text-align: right;">77</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Model 2: like ~ sweetness * moisture</td>
<td style="text-align: right;">74</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">31713.67</td>
<td style="text-align: right;">3504.75</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="in-summary-m_3-gegen-m_0" class="level2" data-number="18.19">
<h2 data-number="18.19" class="anchored" data-anchor-id="in-summary-m_3-gegen-m_0"><span class="header-section-number">18.19</span> In <code>summary()</code> <span class="math inline">\(m_3\)</span> gegen <span class="math inline">\(m_0\)</span></h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = like ~ sweetness * moisture, data = candy)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5340 -1.0283  0.0897  1.3006  3.0182 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         2.253912   0.882917   2.553   0.0127 *  
sweetness           0.043886   0.044919   0.977   0.3318    
moisture           -0.009216   0.064548  -0.143   0.8869    
sweetness:moisture  0.159277   0.003605  44.178   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.737 on 74 degrees of freedom
Multiple R-squared:  0.993, Adjusted R-squared:  0.9927 
F-statistic:  3505 on 3 and 74 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="eine-nominale-variable-mit-vier-stufen" class="level2" data-number="18.20">
<h2 data-number="18.20" class="anchored" data-anchor-id="eine-nominale-variable-mit-vier-stufen"><span class="header-section-number">18.20</span> Eine nominale Variable mit vier Stufen</h2>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mlm_hierarchies_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Ein Reaktionszeitexperiment mit vier Stufen A, B, C und D</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="früher---analysis-of-variance-anova-bzw.-aov" class="level2" data-number="18.21">
<h2 data-number="18.21" class="anchored" data-anchor-id="früher---analysis-of-variance-anova-bzw.-aov"><span class="header-section-number">18.21</span> Früher - Analysis of Variance (ANOVA bzw. AOV)</h2>
<p><span class="math display">\[\begin{align*}
s_{zwischen}^2 &amp;= \frac{1}{K-1}\sum_{j=1}^K N_j (\bar{x}_{j.}-\bar{x})^2 \\
s_{innerhalb}^2 &amp;= \frac{1}{N-K}\sum_{j=1}^K\sum_{i=1}^{N_j}(x_{ji}-\bar{x}_{j.})^2 = \frac{1}{N-K}\sum_{j=1}^K(N_j-1)s_j^2 \\
F &amp;= \frac{\hat{\sigma}_{zwischen}^2} {\hat{\sigma}_{innerhalb}^2} \sim F(K-1,N-K)
\end{align*}\]</span></p>
</section>
<section id="anova-in-r" class="level2" data-number="18.22">
<h2 data-number="18.22" class="anchored" data-anchor-id="anova-in-r"><span class="header-section-number">18.22</span> ANOVA in R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>mod_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(rt <span class="sc">~</span> group, rt_tbl)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_aov)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Ausgabe mit aov()</caption>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">sumsq</th>
<th style="text-align: right;">meansq</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">group</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">988935.1</td>
<td style="text-align: right;">329645</td>
<td style="text-align: right;">157.3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Residuals</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">159221.0</td>
<td style="text-align: right;">2095</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="ansatz-mittels-modellhierarchien" class="level2" data-number="18.23">
<h2 data-number="18.23" class="anchored" data-anchor-id="ansatz-mittels-modellhierarchien"><span class="header-section-number">18.23</span> Ansatz mittels Modellhierarchien</h2>
<section id="full-model-1" class="level3" data-number="18.23.1">
<h3 data-number="18.23.1" class="anchored" data-anchor-id="full-model-1"><span class="header-section-number">18.23.1</span> Full model</h3>
<p><span class="math display">\[
y_i = \beta_0 + \beta_{\Delta_{B-A}} x_1 + \beta_{\Delta_{C-A}} x_2 + \beta_{\Delta_{D-A}} x_3 + \epsilon_i
\]</span></p>
</section>
<section id="reduced-model" class="level3" data-number="18.23.2">
<h3 data-number="18.23.2" class="anchored" data-anchor-id="reduced-model"><span class="header-section-number">18.23.2</span> Reduced model</h3>
<p><span class="math display">\[
y_i = \beta_0 + \epsilon_i
\]</span></p>
<p>Wenn das reduced model die Daten gleich gut fittet wie das full model <span class="math inline">\(\Rightarrow\)</span> Information über das Treatment verbessert meine Vorhersage von <span class="math inline">\(y_i\)</span> nicht.</p>
</section>
</section>
<section id="model-fit---full-model" class="level2" data-number="18.24">
<h2 data-number="18.24" class="anchored" data-anchor-id="model-fit---full-model"><span class="header-section-number">18.24</span> Model fit - Full model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(rt <span class="sc">~</span> group, rt_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Modellfit</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;"><span class="math inline">\(\hat{\beta}\)</span></th>
<th style="text-align: right;"><span class="math inline">\(s_e\)</span></th>
<th style="text-align: right;">t</th>
<th style="text-align: left;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">509.526</td>
<td style="text-align: right;">10.235</td>
<td style="text-align: right;">49.784</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">groupB</td>
<td style="text-align: right;">90.150</td>
<td style="text-align: right;">14.474</td>
<td style="text-align: right;">6.228</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">groupC</td>
<td style="text-align: right;">197.414</td>
<td style="text-align: right;">14.474</td>
<td style="text-align: right;">13.639</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">groupD</td>
<td style="text-align: right;">295.561</td>
<td style="text-align: right;">14.474</td>
<td style="text-align: right;">20.420</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="anova-mit-nur-einem-modell" class="level2" data-number="18.25">
<h2 data-number="18.25" class="anchored" data-anchor-id="anova-mit-nur-einem-modell"><span class="header-section-number">18.25</span> <code>anova()</code> mit nur einem Modell</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Äquivalent zum Vergleich full gegen reduced model</caption>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">sumsq</th>
<th style="text-align: right;">meansq</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">group</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">988935.1</td>
<td style="text-align: right;">329645</td>
<td style="text-align: right;">157.3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Residuals</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">159221.0</td>
<td style="text-align: right;">2095</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="zum-nacharbeiten" class="level2" data-number="18.26">
<h2 data-number="18.26" class="anchored" data-anchor-id="zum-nacharbeiten"><span class="header-section-number">18.26</span> Zum Nacharbeiten</h2>
<p><span class="citation" data-cites="christensen2018">Christensen (<a href="references.html#ref-christensen2018" role="doc-biblioref">2018, p.57–64</a>)</span> </p>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-christensen2018" class="csl-entry" role="listitem">
Christensen, Ronald. 2018. <em>Analysis of variance, design, and regression: Linear modeling for unbalanced data</em>. CRC Press.
</div>
<div id="ref-kutner2005" class="csl-entry" role="listitem">
Kutner, Michael H, Christopher J Nachtsheim, John Neter, und William Li. 2005. <em>Applied Linear Statistical Models</em>. 5. Aufl. McGraw-Hill Irwin New York.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p><span class="citation" data-cites="kutner2005">Kutner u.&nbsp;a. (<a href="references.html#ref-kutner2005" role="doc-biblioref">2005</a>)</span>, p.72<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>In <code>R</code>: <code>df(), pf(), qf(), rf()</code><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./mlm_dummy_coding.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Integration von nominale Variablen</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./lm_title.html" class="pagination-link">
        <span class="nav-page-text">Das allgemeine lineare Modell</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>