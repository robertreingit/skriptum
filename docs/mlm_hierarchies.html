<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Skriptum - Fortgeschrittene Statistik - 18&nbsp; Modellhierarchien</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./lm_title.html" rel="next">
<link href="./mlm_dummy_coding.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>
<script>
  MathJax = {
    tex: {
      tags: 'ams'  // should be 'ams', 'none', or 'all'
    }
  };
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./mlm_title.html">Multiple Regression</a></li><li class="breadcrumb-item"><a href="./mlm_hierarchies.html"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Modellhierarchien</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Skriptum - Fortgeschrittene Statistik</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vorwort</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./r_startup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Eine Schnelleinführung in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Eine Übersicht über <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_kickoff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title"><code>R</code> Kickoff</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_flowcontrol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Ablaufkontrolle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Einfache Datenbearbeitung und Visualisierung in <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_literate_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Literate programming in <code>R</code></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stats_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistik</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Eine kleine Welt der Unsicherheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_significance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Statistische Signifikanz, p-Wert und Power</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Parameterschätzung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Theoretische Verteilungen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_hypotheses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Hypothesen testen</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./slm_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Das einfache Regressionmodell</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Einführung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Inferenz</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_model_fit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Modellfit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Vorhersage</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./mlm_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Einführung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_interactions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Interaktionseffekte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_dummy_coding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Integration von nominalen Variablen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_hierarchies.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Modellhierarchien</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./lm_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Das allgemeine lineare Modell</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lm_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Synthese</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ed_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelles Design</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Einführung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_crd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Completely Randomized Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_linear_contrasts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Lineare Kontraste</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_crfd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Completely Randomized Factorial Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_ancova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_crbd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Completely Randomized Block Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_irbd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Incomplete Randomized Block Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_split_plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Split-plot Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_cross_over.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Cross-over Design</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literatur</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#genereller-linearer-modell-testansatz" id="toc-genereller-linearer-modell-testansatz" class="nav-link active" data-scroll-target="#genereller-linearer-modell-testansatz"><span class="header-section-number">18.1</span> Genereller Linearer Modell Testansatz</a>
  <ul class="collapse">
  <li><a href="#reduziertes-modell-und-stichprobenvarianz" id="toc-reduziertes-modell-und-stichprobenvarianz" class="nav-link" data-scroll-target="#reduziertes-modell-und-stichprobenvarianz"><span class="header-section-number">18.1.1</span> Reduziertes Modell und Stichprobenvarianz(*)</a></li>
  <li><a href="#zusammenfassung" id="toc-zusammenfassung" class="nav-link" data-scroll-target="#zusammenfassung"><span class="header-section-number">18.1.2</span> Zusammenfassung</a></li>
  </ul></li>
  <li><a href="#beispiel-candy-problem" id="toc-beispiel-candy-problem" class="nav-link" data-scroll-target="#beispiel-candy-problem"><span class="header-section-number">18.2</span> Beispiel: Candy-Problem</a></li>
  <li><a href="#beispiel-nominale-variable" id="toc-beispiel-nominale-variable" class="nav-link" data-scroll-target="#beispiel-nominale-variable"><span class="header-section-number">18.3</span> Beispiel: Nominale Variable</a></li>
  <li><a href="#zum-nacharbeiten" id="toc-zum-nacharbeiten" class="nav-link" data-scroll-target="#zum-nacharbeiten"><span class="header-section-number">18.4</span> Zum Nacharbeiten</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Modellhierarchien</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Bisher waren wir damit beschäftigt unsere Modelle Stück für Stücke immer komplizierter zu machen. Angefangen haben wir mit dem einfachen linearen Modell, das dann zum multiplen linearen Modell mit mehreren <span class="math inline">\(x\)</span>-Variablen wurden. Die <span class="math inline">\(x\)</span>-Variablen konnten im nächsten Schritt miteinander interagieren, während dann im letzten Schritt die Anforderung aufgehoben wurde, dass die <span class="math inline">\(x\)</span>-Variablen kontinuierlich sein mussten, sondern auch nominal sein konnten. Durch die Kombination von verschiedenen Variablen sind wir nun in der Lage auch komplexe DGP abzubilden. Im Kern wurde aber letztendlich immer das einfache Modell, die Punkt-Steigungsform, aus der Schule, beibehalten. Im folgenden Abschnitt werden wir nun eine direkte Verbindung zwischen dem Regressionsmodell und der Varianzanalyse erarbeiten.</p>
<section id="genereller-linearer-modell-testansatz" class="level2" data-number="18.1">
<h2 data-number="18.1" class="anchored" data-anchor-id="genereller-linearer-modell-testansatz"><span class="header-section-number">18.1</span> Genereller Linearer Modell Testansatz</h2>
<p>Wir beginnen mit einem einfachen Modell, das wiederum nur eine <span class="math inline">\(x\)</span> und eine <span class="math inline">\(y\)</span>-Variable hat.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>mod0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, simple)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod0)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x, data = simple)

Residuals:
      1       2       3       4 
-0.5817  0.9898 -0.2345 -0.1736 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   1.8414     0.7008   2.628    0.119
x             0.4574     0.3746   1.221    0.346

Residual standard error: 0.8376 on 2 degrees of freedom
Multiple R-squared:  0.4271,    Adjusted R-squared:  0.1406 
F-statistic: 1.491 on 1 and 2 DF,  p-value: 0.3465</code></pre>
</div>
</div>
<p>D.h. hier ist jetzt zunächst einmal nichts Neues dazukommen. Schauen wir uns aber noch einmal genauer die Residuen, d.h. die Abweichungen von der Regressionsgeraden, an. In der Besprechung des Determinationskoeffizienten <span class="math inline">\(R^2\)</span> haben wir schon Quadratsummen und deren Unterteilung kennengelernt. Dort hatten wird die Aufteilung der Varianz von <span class="math inline">\(Y\)</span>, bezeichnet als <span class="math inline">\(SSTO\)</span>, in die beiden Komponenten Regressionsvarianz <span class="math inline">\(SSR\)</span> und Fehlervarianz <span class="math inline">\(SSE\)</span> besprochen. Es gilt.</p>
<p><span class="math display">\[\begin{equation}
SSTO = SSR + SSE
\end{equation}\]</span></p>
<p>Die Fehlerquadratsumme SSE, die Summe der quadrierten Abweichungen zwischen dem beobachteten Wert <span class="math inline">\(y_i\)</span> und dem vorhergesagten Wert <span class="math inline">\(\hat{y}_i\)</span> ist definiert mittels:</p>
<p><span class="math display">\[\begin{equation}
SSE = \sum_{i=1}^n (y_i - \hat{y}_i)^2
\end{equation}\]</span></p>
<p>Um die Werte <span class="math inline">\(\hat{y}_i\)</span> berechnen zu können, benötigen wir unser Modell bzw. die Modellkoeffizienten. Das einfache Regressionsmodell hat zwei Parameter, die beiden Koeffizienten <span class="math inline">\(\beta_0\)</span> und <span class="math inline">\(\beta_1\)</span>. Formalisierung wir die Parameteranzahl indem ihr ein Symbol spendieren, per Konvention meistens das Symbol <span class="math inline">\(p\)</span>. In unserem Fall ist gilt daher <span class="math inline">\(p = 2\)</span>. Die Anzahl der Parameter <span class="math inline">\(p\)</span> ist verknüpft mit den sogenannten Freiheitsgraden <span class="math inline">\(df\)</span> (degrees of freedom). Die Freiheitsgrade von <span class="math inline">\(SSE\)</span> berechnen sich mittels der Formel <span class="math inline">\(N-p\)</span>, wobei <span class="math inline">\(N\)</span> die Anzahl der Beobachtungen, der Datenpunkte ist.</p>
<p><span class="math display">\[\begin{equation}
df_E := n - p
\end{equation}\]</span></p>
<p>Die Freiheitsgerade bestimmen die <em>effektive</em> Anzahl der Beobachtungen die zur Verfügung stehen um die Varianz <span class="math inline">\(\sigma^2\)</span> des Modells abzuschätzen. Dadurch, dass zwei Parameter anhand der Daten für das Modell bestimt werden, fallen zwei Datenpunkt als unabhängige Informationsquellen weg. Anders ausgedrückt, wenn ich die beiden Modellparameter, in unseren Fall <span class="math inline">\(\beta_0\)</span> und <span class="math inline">\(\beta_1\)</span> kenne, dann sind nur noch <span class="math inline">\(N-2\)</span> Datenpunkt frei variierbar. Sobald ich die Werte von <span class="math inline">\(N-2\)</span> Datenpunkten und die beiden Parameter kenne, kann ich die verbleibenden beiden Werte berechnen. Daher die Begriff der Freiheitsgrade.</p>
<p>Wir nun <span class="math inline">\(SSE\)</span> durch die Anzahl der Freiheitsgerade teilen, dann lässt sich zeigen, das dieser Wert ein erwartungstreuer Schätzer für die Residualvarianz <span class="math inline">\(\sigma^2\)</span> unter der Verteilungsannahme <span class="math inline">\(\epsilon_i \sim \mathcal{N}(0,\sigma^2)\)</span> der Daten ist. Das Verhältnis von <span class="math inline">\(SSE\)</span> zu <span class="math inline">\(df\)</span> wird als Mean squared error (<span class="math inline">\(MSE\)</span>) bezeichnet.</p>
<p><span class="math display">\[\begin{equation}
MSE = \frac{SSE}{df_{E}} = \frac{\sum_{i=1}^n (y_i - \hat{y}_i)^2}{n-p} = \hat{\sigma}^2
\end{equation}\]</span></p>
<p>Im ersten Moment erscheint diese Begründung etwas undurchsichtig, aber tatsächlich ist diese Formel schon eine alte Bekannte die uns in Form der Stichprobenvarianz <span class="math inline">\(s^2\)</span> begegnet ist.</p>
<p>Wenn wir eine Stichprobe der Größe <span class="math inline">\(N\)</span> mit Werten <span class="math inline">\(y_i\)</span> haben, dann haben wir die Stichprobenvarianz mittels der Formel:</p>
<p><span class="math display">\[\begin{equation}
\hat{\sigma}^2 = s^2 = \frac{1}{n-1}\sum_{i=1}^2(y_i - \bar{y})^2
\end{equation}\]</span></p>
<p>berechnet. Was bei dieser Formel schon immer etwas quer gesessen hat, ist der Nenner mit <span class="math inline">\(N-1\)</span> anstatt einfach <span class="math inline">\(N\)</span> wie wir es vom Mittelwert kennen. Aber, um die Varianz zu berechnen benötigen wir einen Parameter, den Mittelwert <span class="math inline">\(\hat{y}\)</span> den wir anhand der Daten berechnen. Dies führt dazu, dass nur <span class="math inline">\(N-1\)</span> Werte frei variiert werden können. Sobald wir, neben dem Mittelwert <span class="math inline">\(\bar{y}\)</span>, <span class="math inline">\(N-1\)</span> Werte kennen, können den verbleibenden Wert <span class="math inline">\(N\)</span>-ten Wert berechnen.</p>
<p>Nach dieser Wiederholung sind wir nun in der Lage eine neue Teststatistik entwickeln. Das Ziel ist dabei eine Metrik zu entwickeln mit der wir abschätzen können, ob die Hinzunahme von Modellparametern zu einer Verbesserung der Modellvorhersage führt. Die Verbesserung werden wir mittels der Reduktion der Fehlervarianz <span class="math inline">\(SSE\)</span> abschätzen. Wir werden in diesem Zusammenhang sehen, dass Modelle in eine Hierarchie zueinander in Beziehung gesetzt werden können bei einfachere Modellen als Teilmodelle von komplexeren Modellen interpretiert werden können.</p>
<p>Wir müssen dazu zunächst die Unterscheidung in ein volles Modell (<span class="math inline">\(F\)</span>ull model) und ein reduziertes Modell (<span class="math inline">\(R\)</span>educed model) verstehen. Beim Beispiel der einfachen lineare Regression ist das full model das uns schon bekannte:</p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1 X_i + \epsilon_i, \quad \epsilon_i \sim \mathcal{N}(0,\sigma^2)
\]</span></p>
<p>Die Residualvarianz <span class="math inline">\(SSE(F)\)</span> berechnet sich wie oben wiederholt mittels:</p>
<p><span class="math display">\[\begin{equation}
\textrm{SSE(F)}  = \sum_{i=1}^n(y_i - \hat{y}_i)^2 = \sum_{i=1}^n [y_i - (\beta_0 + \beta_1 x_i)]^2
\label{eq-mlm-hier-ssef}
\end{equation}\]</span></p>
<p>Da wir <span class="math inline">\(p = 2\)</span> Modellparameter haben, hat das Modell <span class="math inline">\(dfE(F) = n - 2\)</span> Freiheitsgerade. So weit ist bisher noch nichts Neues dazugekommen. Wir könnten uns jetzt die Frage stellen, ob wir tatsächlich den Modellparameter <span class="math inline">\(\beta_1\)</span> benötigen. Vielleicht zeigt die <span class="math inline">\(x\)</span>-Variable gar keinen Zusammenhang mit der <span class="math inline">\(y\)</span>-Variable und wir fitten nur Rauschen im Modell. Aus dieser Überlegung heraus, können wir jetzt ein reduziertes Modell formulieren bei dem der Parameter <span class="math inline">\(\beta_1\)</span> fehlt.</p>
<p><span class="math display">\[
Y_i = \beta_0 + \epsilon_i, \quad \epsilon_i \sim \mathcal{N}(0,\sigma^2)
\]</span></p>
<p>Die Residualvarianz SSE(R) berechnet sich jetzt mittels.</p>
<p><span class="math display">\[
\textrm{SSE(R)} = \sum_{i=1}^n (y_i - \beta_0)^2 = \sum_{i=1}^n(y_i - \bar{y})^2 = \textrm{SSTO}
\]</span></p>
<p>Uns Modell hat jetzt nur noch einen Paramter <span class="math inline">\(\beta_0\)</span> gilt nun <span class="math inline">\(p = 1\)</span> und entsprechend <span class="math inline">\(dfE(R) = n - 1\)</span>. Der Modellparameter <span class="math inline">\(\beta_0\)</span> ist jetzt also nichts anderes als der Mittelwert <span class="math inline">\(\bar{y}\)</span> der beobachteten <span class="math inline">\(y\)</span>-Werte.</p>
<p>Mit etwas Algebra lässt sich zeigen, dass im Allgemeinen <span class="math inline">\(SSE(F) \leq SSE(R)\)</span> gilt. Dieser Zusammenhang lässt sich auch heuristisch herleiten. Wenn es keinen Zusammenhang zwischen <span class="math inline">\(x\)</span> und <span class="math inline">\(y\)</span> gibt, dann wird der <span class="math inline">\(\beta_1\)</span> im full model nahezu <span class="math inline">\(0\)</span> sein und Formel <span class="math inline">\(\eqref{eq-mlm-hier-ssef}\)</span> wird zu SSE(R). Im realistischen Fall wird aber, selbst wenn kein Zusammenhang besteht, ein Teil des Rauschens mittels <span class="math inline">\(\beta_1\)</span> gefittet, so dass der beschriebene Zusammenhang zwischen SSE(F) und SSE(R) entsteht.</p>
<section id="reduziertes-modell-und-stichprobenvarianz" class="level3" data-number="18.1.1">
<h3 data-number="18.1.1" class="anchored" data-anchor-id="reduziertes-modell-und-stichprobenvarianz"><span class="header-section-number">18.1.1</span> Reduziertes Modell und Stichprobenvarianz(*)</h3>
<p>Zwischen der Residualvarianz im reduzierten Modell SSE(R), dem <em>optimalen</em> Modellparameter <span class="math inline">\(\beta_0\)</span> und der Stichprobenvarianz besteht ein enger Zusammenhang bzw. Identität wie sich anhand der folgenden Herleitung sehen lässt. Wir wollen den Modellparameter unter der Minimierung der Summer der Quadrate der Abweichung, sprich SSE, ermitteln.</p>
<p><span class="math display">\[\begin{align*}
SSE &amp;= \sum_{i=1}^n(y_i - \beta_0)^2 \\
&amp;= \sum_{i=1}^n (y_i^2 - 2y_i\beta_0 + \beta_0^2)
\end{align*}\]</span></p>
<p>Wir wollen entsprechend <span class="math inline">\(min[SSE]\)</span> bestimmen, wie wir das schon vorher immer beim Regressionmodell gemacht haben. Daher setzen wir den Term <span class="math inline">\(=0\)</span> und leiten nach dem Modellparameter <span class="math inline">\(\beta_0\)</span> ab. Ein bisschen Algebra führt zu:</p>
<p><span class="math display">\[\begin{align*}
0 &amp;= \frac{\mathrm{d}}{\mathrm{d} \beta_0}\sum_{i=1}^n (y_i^2 - 2y_i\beta_0 + \beta_0^2) \\
0 &amp;= \sum_{i=1}^n (-2y_i + 2 \beta_0) = -2\sum_{i=1}^n y_i + 2\sum_{i=1}^n \beta_0\\
n\beta_0 &amp;= \sum_{i=1}^n y_i \\
\beta_0 &amp;= \frac{\sum_{i=1}^n y_i}{n}
\end{align*}\]</span></p>
<p>Somit ist Wert von <span class="math inline">\(\beta_0\)</span> der Abweichungen minimiert, der Mittelwert <span class="math inline">\(\bar{y}\)</span>. Daraus folgt allerdings, das unsere Schätzer für die <span class="math inline">\(\sigma^2\)</span>,</p>
<p><span class="math display">\[\begin{equation*}
\hat{\sigma}^2 = \frac{SSE}{n-p} = \frac{SSE(R)}{n-1} = \sum_{i=1}^n (y_i - \bar{y})^2 =  s^2
\end{equation*}\]</span></p>
<p>einfach nur unser bekannter Schätzer der Stichprobenvarianz <span class="math inline">\(s^2\)</span> ist.</p>
<p>Kommen wir zurück zur Entwicklung unsere Metrik um das volle und das reduzierte Modell miteinander zu vergleichen. Gehen wir davon aus, das das reduzierte Modell ist korrekt. D.h. die Hinzunahme von <span class="math inline">\(X\)</span> sollte keine Verbesserung des Modells nach sich ziehen. Konkret bedeutet dies, dass <span class="math inline">\(SSE(R)\)</span> und <span class="math inline">\(SSE(F)\)</span> in etwas gleich sind bzw. <span class="math inline">\(SSE(F)\)</span> nur wenig besser ist als <span class="math inline">\(SSE(R)\)</span>. Wenn ich jetzt die Differenz zwischen diesen beiden Werte nehme, dann sollte der Wert eher klein sein.</p>
<p><span class="math display">\[\begin{equation}
\textrm{SSE(R)} - \textrm{SSE(F)}
\label{eq-mlm-hier-div}
\end{equation}\]</span></p>
<p>Beide Modelle haben einen gleich guten fitten die Daten in etwas gleich gut. Das volle Modell etwas besser, das es durch den zusätzlichen Parameter etwas flexibler als das reduzierte Modell ist.</p>
<p>Gehen wir von nun von der entgegengesetzen Annahme aus. Das reduzierte Modell ist falsch und wir benötigen die Variable <span class="math inline">\(X\)</span> um die Varianz in <span class="math inline">\(Y\)</span> aufzuklären. In diesem Fall sollte die Differenz <span class="math inline">\(\eqref{eq-mlm-hier-div}\)</span> einen deutlich größeren Wert annehmen, da das reduzierte Modell denjenigen Teil der Varianz von <span class="math inline">\(Y\)</span> nicht aufklären kann, der durch <span class="math inline">\(X\)</span> entsteht. Im vollem Modell kann diese Varianz durch den zusätzlichen Modellparameter <span class="math inline">\(\beta_1\)</span> dagegen erklärt werden.</p>
<p>Zusammengefasst haben wir heuristisch eine Metrik hergeleitet, die uns erlaubt verschiedene Modell miteinander zu vergleichen. Wenn das reduzierte, einfachere Modell ausreicht um die Daten zu fitten, dann wird die Differenz <span class="math inline">\(\eqref{eq-mlm-hier-div}\)</span> eher klein ausfallen. Wenn die zusätzlichen Parameter im vollem Modell benötigt werden, dann wird der Unterschied <span class="math inline">\(\eqref{eq-mlm-hier-div}\)</span> eher groß.</p>
<p>Wir bringen jetzt noch einen zusätzlichen Parameter in unseren Modellvergleich ein. Die Bedeutsamkeit des Unterschieds zwischen den beiden Modellen ist auch noch abhängig davon in wie vielen Parameter sich die beiden Modelle voneinander unterscheiden. Wenn im vollen Modell <span class="math inline">\(p = 10\)</span> Parameter sind und im reduzierten Modell eben nur <span class="math inline">\(p = 1\)</span> Parameter ist, dann ist ein gegebener Unterschied in den <span class="math inline">\(SSE\)</span>s zwischen den Modell anders zu bewerten, als wenn im vollem Modell <span class="math inline">\(p = 2\)</span> Parameter geschätzt werden. Bei gleichem Unterschied zwischen den Modell ist der Unterschied im ersteren Fall weniger Bedeutsam im Vergleich zum letzteren Fall. Daher wird der Unterschied noch anhand des Unterschieds in der Anzahl der Parameter kalibriert. Anders formuliert, schauen wir uns die Veränderung in der Varianzverkleinerung pro Freiheitsgrad an. In unserem einfachen Fall passiert da nichts, da der Unterschied in der Parameteranzahl <span class="math inline">\(= 1\)</span> ist. Wir werden aber später sehen, dass auch Modelle mit größeren Unterschieden in der Parameteranzahl <span class="math inline">\(p\)</span> miteinander verglichen werden können.</p>
<p>Mit <span class="math inline">\(p_F\)</span> = Anzahl der Parameter im vollen Modell, <span class="math inline">\(p_R\)</span> = Anzahl der Parameter im reduzierten Modell, $df_{E(F)} = gilt:</p>
<p><span class="math display">\[
p_{F} - p_{R} = p_{F} - p_{R} + N - N = N - p_{R} - (N - p_{F}) = df_{E(R)} - df_{E(F)}
\]</span></p>
<p>Somit schreiben wir den Unterschied zwischen den beiden Modellen folgendermaßen auf und gegen dem Term auch noch einen Namen <span class="math inline">\(MS_{\textrm{test}}\)</span> für mean squared test.</p>
<p><span class="math display">\[\begin{equation}
MS_{\textrm{test}} = \frac{\textrm{SSE(R)} - \textrm{SSE(F)}}{df_{E(R)} - df_{E(F)}}
\label{eq-mlm-hier-mstest}
\end{equation}\]</span></p>
<p>Unter der Annahme, das das reduzierte Modell korrekt ist, lässt sich zeigen, dass <span class="math inline">\(MS_{\textrm{test}}\)</span> ein Schätzer für die Varianz <span class="math inline">\(\sigma^2\)</span> im Rahmen der üblichen Modellannahmen <span class="math inline">\(\epsilon_i \sim \mathcal{N}(0,\sigma^2)\)</span> ist. D.h.</p>
<p><span class="math display">\[\begin{equation*}
MS_{\textrm{test}} = \hat{\sigma}^2
\end{equation*}\]</span></p>
<p>Zusätzlich, wenn das reduzierte Modell korrekt ist, dann ist auch das volle Modell korrekt. Das volle Modell hat einen Parameter zu viel aber der sollte wie oben ausgeführt in der Nähe von <span class="math inline">\(0\)</span> sein. Daher ist auch wie schon vorher gezeigt <span class="math inline">\(MSE(F)\)</span> ein Schätzer für die Varianz <span class="math inline">\(\sigma^2\)</span> im Rahmen der üblichen Modellannahmen <span class="math inline">\(\epsilon_i \sim \mathcal{N}(0,\sigma^2)\)</span> .</p>
<p><span class="math display">\[\begin{equation}
MS_{E(F)} = \frac{\textrm{SSE(F)}}{df_{E(F)}} = \hat{\sigma}^2
\end{equation}\]</span></p>
<p>Das Verhältnis des vollen zum reduzierten Modell kann auch dahingehend interpretiert werden, das das reduzierte Modell das volle Modell mit einer zusätzlichen Randbedigung ist. Wenn das volle Modell die folgende Form hat:</p>
<p><span class="math display">\[\begin{equation*}
Y = \beta_0 + \beta_1 \cdot X_1 + \epsilon
\end{equation*}\]</span></p>
<p>Und das reduzierte Modell die Form:</p>
<p><span class="math display">\[\begin{equation*}
Y = \beta_0 + \epsilon
\end{equation*}\]</span></p>
<p>Dann kann das reduzierte Modell als das volle Modell mit der Randbedingung das <span class="math inline">\(\beta_1 = 0\)</span> formuliert werden.</p>
<p><span class="math display">\[\begin{equation*}
Y = \beta_0 + \beta_1 \cdot X_1 + \epsilon, \quad \beta_1 = 0
\end{equation*}\]</span></p>
<p>Daher läuft ein Vergleich der beiden Modell darauf hinaus zu testen ob der Parameter <span class="math inline">\(\beta_1 = 0\)</span> ist. Dies erklärt auch noch mal den Satz, das das volle Modell korrekt ist, wenn das reduzierte Modell korrekt ist, da das reduzierte Modell nur ein Spezialfall des vollen Modells ist.</p>
<p>Eine Sache fehlt uns noch um die Größe von <span class="math inline">\(MS_{\textrm{test}}\)</span> einordnen zu können. Da wir es mit Varianzen zu tun haben, können wir die Größe der Quadratsummen verändern indem wir die Einheiten der abhängigen Variablen <span class="math inline">\(Y\)</span> verändern. Würden wir z.B. von <span class="math inline">\([m]\)</span> auf <span class="math inline">\([cm]\)</span> gehen, da würde sich der Unterschied in Formel <span class="math inline">\(\eqref{eq-mlm-hier-mstest}\)</span> um den Faktor <span class="math inline">\(10\times 10=100\)</span> vergrößern ohne das wirklich eine Veränderung in den Modellen stattgefunden hat. Daher kalibrieren wir <span class="math inline">\(MS_{\textrm{test}}\)</span> indem wir den Term durch <span class="math inline">\(MS_{E(F)}\)</span> teilen. Damit fallen alle Problem mit Veränderungen durch Änderungen in den Einheiten weg <span class="citation" data-cites="maxwell2004">(siehe auch <a href="references.html#ref-maxwell2004" role="doc-biblioref">Maxwell, Delaney, und Kelley 2004, p.75</a>)</span>.</p>
<p><span class="math display">\[\begin{equation}
\frac{MS_{\textrm{test}}}{MS_{E(F)}} = \frac{\frac{\textrm{SSE(R)} - \textrm{SSE(F)}}{df_{E(R)} - df_{E(F)}}}{ \frac{\textrm{SSE(F)}}{df_{E(F)}}}
\label{eq-mlm-hier-Ftest}
\end{equation}\]</span></p>
<p>Zusätzlich hat dies auch noch den Vorteil, dass die entstehende Metrik unter der <span class="math inline">\(H_0\)</span>, das das reduzierte Modell korrekt ist, einer uns bekannten theoretische Verteilung, nämlich der <span class="math inline">\(F\)</span>-Verteilung mit <span class="math inline">\(df_{E(R)} - df_{E(F)}\)</span> und <span class="math inline">\(df_{E(F)}\)</span> Freiheitsgeraden, folgt.</p>
<p><span class="math display">\[\begin{equation*}
F = \frac{MS_{\textrm{test}}}{MS_{E(F)}}  \sim F(df_{E(R)}-df_{E(F)},df_{E(F)})
\end{equation*}\]</span></p>
<p>Zur Erinnerung sind in <a href="#fig-mlm-hier-fdist">Abbildung&nbsp;<span>18.1</span></a> nochmal ein paar Beispiele für <span class="math inline">\(F\)</span>-Verteilung mit verschiedenen Freiheitsgeraden abgebildet.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-mlm-hier-fdist" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="mlm_hierarchies_files/figure-html/fig-mlm-hier-fdist-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Abbildung&nbsp;18.1: Beispiele für die F-Verteilung mit verschiedenen Freiheitsgraden <span class="math inline">\(df_1, df_2\)</span></figcaption>
</figure>
</div>
</div>
</div>
<p>Da beide Terme in Formel <span class="math inline">\(\eqref{eq-mlm-hier-Ftest}\)</span> die Varianz abschätzen deutet ein Wert in der Nähe von <span class="math inline">\(1\)</span> daraufhin, das das reduzierte Modell adäquat ist um die Daten zu beschreiben und die Hinzunahme des Parameters im vollen Modell keine Verbesserung liefert.</p>
<p>Sobald wir eine bekannte theoretische Verteilung unter einer <span class="math inline">\(H_0\)</span> haben, können wir unser Hypothestinstrumentarium auf die Verteilung los lassen und entsprechend einen kritische Bereich mit <span class="math inline">\(\alpha\)</span> bestimmen. In <a href="#fig-mlm-hier-fcrit">Abbildung&nbsp;<span>18.2</span></a> haben wir dies entsprechend getan. Somit wenn wenn der beobachtete <span class="math inline">\(F\)</span>-Wert in den kritischen Bereich fällt, interpretieren wird das als Evidenz gegen die <span class="math inline">\(H_0\)</span>. Wir sind überrascht diesen Wert unter der <span class="math inline">\(H_0\)</span> zu sehen und lehen die <span class="math inline">\(H_0\)</span> das das einfachere Modell korrekt ist ab und werten dies als Evidenz dafür, das das komplexere, volle Modell die Daten besser abbildet und <em>statistisch signifikant</em> mehr Varianz der abhängigen Variable modellieren kann.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-mlm-hier-fcrit" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="mlm_hierarchies_files/figure-html/fig-mlm-hier-fcrit-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Abbildung&nbsp;18.2: F-Verteilung mit <span class="math inline">\(df_1 = 5, df_2 = 10\)</span> und kritischem Wert bei <span class="math inline">\(\alpha=0.05\)</span></figcaption>
</figure>
</div>
</div>
</div>
<p>Schauen wir uns diesen letzten Schritt noch einmal mit einer Simulation genauer an. Gegeben sein ein DGP der folgenden Form:</p>
<p><span class="math display">\[\begin{equation}
y = 3 + 2 \cdot x + \epsilon_i \quad \epsilon_i \sim \mathcal{N}(0,1)
\label{eq-mlm-hier-mstest-sim}
\end{equation}\]</span></p>
<p>D.h. wir haben ein einfache lineares Regressionsmodell mit <span class="math inline">\(\beta_0 = 3\)</span>, <span class="math inline">\(\beta_1 = 2\)</span> und normalverteilten Residuen mit <span class="math inline">\(\sigma = 1\)</span>. Wir simulieren jetzt DGP <span class="math inline">\(1000\)</span>mal mit <span class="math inline">\(n = 30\)</span> zum Beispiel und fitten drei verschiedene Modelle an diese Daten. Einmal ein reduziertes Modell ohne <span class="math inline">\(\beta_1\)</span>, ein korrektes Modell mit <span class="math inline">\(\beta_0\)</span> und <span class="math inline">\(\beta_1\)</span> und ein überparameterisiertes Modell mit <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span> und <span class="math inline">\(\beta_2\)</span> wobei wir eine Zufallsvariable als <span class="math inline">\(X_2\)</span> nehmen die der Standardnormalverteilung folgt (D.h. <span class="math inline">\(X_2 \sim \mathcal{N}(0,1)\)</span>. Zwischen <span class="math inline">\(X_2\)</span> und <span class="math inline">\(Y\)</span> besteht also kein Zusammenhang. Daher sollte die Hinzunahme von <span class="math inline">\(X_2\)</span> auch zu keiner Verbesserung des Modell führen und somit nur als Rauschen interpretiert werden kann.</p>
<p>In <a href="#fig-mlm-hier-msetest-sim-01">Abbildung&nbsp;<span>18.3</span></a> ist das Ergebnis der Simulation zu sehen. Für jede der <span class="math inline">\(1000\)</span> Simulation generieren wir <span class="math inline">\(n = 30\)</span> Datenpaare <span class="math inline">\((y_i,x_i)\)</span> nach der Formel <span class="math inline">\(\eqref{eq-mlm-hier-mstest-sim}\)</span>. Wir fitten dann an jeden dieser <span class="math inline">\(1000\)</span> Datensätze die drei verschiedenen Modelle.</p>
<p><span class="math display">\[\begin{align*}
\text{under} &amp;: y_i = \beta_0 + \epsilon_i \\
\text{correct} &amp;: y_i = \beta_0 + \beta_1 \cdot x_i + \epsilon_i \\
\text{over} &amp;: y_i = \beta_0 + \beta_1 \cdot x_{1i} + \beta_2 \cdot x_{2i} + \epsilon_i
\end{align*}\]</span></p>
<p>Für jeden Modellfit wird dann <span class="math inline">\(MSE = \hat{\sigma}^2\)</span> berechnet von dem wir wissen das der <em>wahre</em> Wert <span class="math inline">\(\sigma^2 = 1\)</span> ist.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-mlm-hier-msetest-sim-01" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="mlm_hierarchies_files/figure-html/fig-mlm-hier-msetest-sim-01-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Abbildung&nbsp;18.3: Verteilung von <span class="math inline">\(\hat{\sigma}^2 = MSE\)</span> für die drei verschiedenen Modelle.</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-mlm-hier-msetest-sim-01">Abbildung&nbsp;<span>18.3</span></a> ist rot die tatsächliche Varianz bzw. Standardabweichung des DGP mit <span class="math inline">\(\sigma = 1\)</span> eingezeichnet. Im reduzierten Modell (under) wird die Residualvarianz klar in allen Durchgängen überschätzt. Da der Modellparameter für <span class="math inline">\(X\)</span> fehlt, wir diejenige Varianz von <span class="math inline">\(Y\)</span> die auf <span class="math inline">\(X\)</span> zurückgeht in die Residualvarianz mit aufgenommen. Im mittleren Graphen beim korrekten Modell sind die abgeschätzten Residualvarianz schön um den tatsächlichn Wert herum verteilt. Im einzelnen Fall kommt es natürlich auf Grund der Stichprobenvariabilität zur Überschätzung bzw. Unterschätzung von <span class="math inline">\(\sigma^2\)</span> aber im Mittel sind die Werte korrekt. D.h. der Schätzer ist Erwarungstreu. Im letzten Fall für das überparameterisierte Modell (over) wird die Residualvarianz ebenfalls korrekt abgeschätzt. Die Hinzunahme der zufälligen Variable <span class="math inline">\(X_2\)</span> führt wie erwartet zu keiner Verschlechterung von <span class="math inline">\(\hat{\sigma}^2\)</span> aber eben auch zu keiner relevanten Verbesserung.</p>
<p>Schauen wir uns als Nächstes an, wie sich der <span class="math inline">\(F\)</span>-Wert aus Formel<span class="math inline">\(\eqref{eq-mlm-hier-Ftest}\)</span> verhält.</p>
<div id="fig-mlm-hier-f-comparisons" class="cell quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-mlm-hier-f-comparisons-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="mlm_hierarchies_files/figure-html/fig-mlm-hier-f-comparisons-1.png" class="img-fluid figure-img" data-ref-parent="fig-mlm-hier-f-comparisons" width="672"></p>
<figcaption class="figure-caption">(a) Vergleich von correct vs under</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-mlm-hier-f-comparisons-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="mlm_hierarchies_files/figure-html/fig-mlm-hier-f-comparisons-2.png" class="img-fluid figure-img" data-ref-parent="fig-mlm-hier-f-comparisons" width="672"></p>
<figcaption class="figure-caption">(b) Vergleich von over vs correct</figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;18.4: F-Werte der Modellvergleiche. Die theoretische Verteilung unter der <span class="math inline">\(H_0\)</span> ist in rot abgetragen.</figcaption><p></p>
</figure>
</div>
<p>In <a href="#fig-mlm-hier-f-comparisons">Abbildung&nbsp;<span>18.4</span></a> sind die Verteilungen der <span class="math inline">\(F\)</span>-Werte für die <span class="math inline">\(1000\)</span> Simulationen einmal für den Vergleich correct vs.&nbsp;under (a) und over vs.&nbsp;correct (b) abgetragen. Schauen wir uns zunächst <a href="#fig-mlm-hier-f-comparisons-2">Abbildung&nbsp;<span>18.4 (b)</span></a> an. Die Verteilung der <span class="math inline">\(F\)</span>-Wert. Wenn wir die beobachtete Verteilung (Balken) mit theoretischen Verteilung unter der <span class="math inline">\(H_0\)</span> (rot) vergleichen, ist zu erkennen wie die beobachteten Werte sehr gut der unter der <span class="math inline">\(H_0\)</span> erwarteten Verteilung folgen. Der Großteil der Wert liegt in der Umgebung von <span class="math inline">\(1\)</span>. Dies entspricht auch unserer Erwartung, die Hinzunahme der Variable <span class="math inline">\(X_2\)</span>, die keinen Zusammenhang mit <span class="math inline">\(Y\)</span> hat, führt zu keiner Verbesserung des Modells. Das heißt, dass wir in <span class="math inline">\(\alpha\)</span>-Prozent der die <span class="math inline">\(H_0\)</span> ablehnen würden und uns dementsprechend irren würden. Im Gegensatz dazu folgt die Verteilung der beobachteten <span class="math inline">\(F\)</span>-Wert in <a href="#fig-mlm-hier-f-comparisons-1">Abbildung&nbsp;<span>18.4 (a)</span></a> nicht einmal annährend der erwarteten unter der <span class="math inline">\(H_0\)</span>. Wir haben in der Umgebung von <span class="math inline">\(1\)</span> überhaupt keine Werte beobachtete. Die <span class="math inline">\(H_0\)</span> in diesem Fall, das die Hinzunahme von <span class="math inline">\(X_1\)</span> zu keiner Verbesserung führt. Dementsprechend würde in praktisch allen Fällen die <span class="math inline">\(H_0\)</span> abgelehnt werden, da der beobachtete <span class="math inline">\(F\)</span>-Wert deutlich größer als der kritische Wert der <span class="math inline">\(F\)</span>-Verteilung ist. Dementsprechend würden wir bei der Modellauswahl das korrekte Modell identizieren.</p>
</section>
<section id="zusammenfassung" class="level3" data-number="18.1.2">
<h3 data-number="18.1.2" class="anchored" data-anchor-id="zusammenfassung"><span class="header-section-number">18.1.2</span> Zusammenfassung</h3>
<p>Durch den Vergleich von Modellen miteinander, sind wir in der Lage, die Verbesserung/Verschlechterung der Modellvorhersage bei Hinzunahme von Modellvariablen statistisch zu überprüfen. Wenn der <span class="math inline">\(F\)</span>-Test statistisch signifikant ist, dann werten wir dies als Evidenz dafür, das das volle Modell die Daten so viel besser modelliert, das wir dieses Modell dem reduzierten Modell vorziehen sollten.</p>
</section>
</section>
<section id="beispiel-candy-problem" class="level2" data-number="18.2">
<h2 data-number="18.2" class="anchored" data-anchor-id="beispiel-candy-problem"><span class="header-section-number">18.2</span> Beispiel: Candy-Problem</h2>
<p>Schauen wir uns hergeleitete Metrik in Aktion an einem konkreten Beispiel an. Dabei führen wir auch noch den Begriff der Modellhierarchien ein. In <a href="#fig-mlm-hier-candy-example">Abbildung&nbsp;<span>18.5</span></a> ist eine exemplarischer Datensatz abgebildet.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-mlm-hier-candy-example" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="mlm_hierarchies_files/figure-html/fig-mlm-hier-candy-example-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Abbildung&nbsp;18.5: Zusammenhang zwischen der Präferenz für ein Bonbon und dem Süßgrad (g pro Bonbon/100) für verschiedene Saftanteile 0% - 20%</figcaption>
</figure>
</div>
</div>
</div>
<p>In einer Studie wurde der Zusammenhang zwischen wie gut ein Bonbon bewertet wurde (like, Skala 0-100) und dem Süßegrad und dem Saftanteil untersucht. Wir sehen, dass Bonbons umso besser bewertet werden umso höher der Süßegrad war, aber das dieser Effekt durch den Saftanteil beeinflusst wird und umso stärker ist, umso höher der Saftanteil ist. Daher spricht dies für ein Interaktionsmodell.</p>
<p>Das volle Modell kann dementsprechend mit <span class="math inline">\(x_1\)</span> = Süßegrad und <span class="math inline">\(x_2\)</span> = Saftanteil folgendermaßen modelliert werden.</p>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \beta_3 x_{1i}x_{2i} + \epsilon_i
\]</span></p>
<p>Im vollen Modell ist daher <span class="math inline">\(p = 4\)</span> und wir können drei verschiedenen reduzierte Modelle definieren. Das einfachste Modell bezeichnen wir der Einfachheit halber als <span class="math inline">\(m_0\)</span> und dementsprechend ansteigend bis zum vollen Modell <span class="math inline">\(m_3\)</span>.</p>
<p><span class="math display">\[\begin{align*}
m_0&amp;: y_i = \beta_0 + \epsilon_i \\
m_1&amp;: y_i = \beta_0 + \beta_1 x_{1i} + \epsilon_i \\
m_2&amp;: y_i = \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \epsilon_i \\
m_3&amp;: y_i = \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \beta_3 x_{1i}x_{2i} + \epsilon_i
\end{align*}\]</span></p>
<p>Das Modell <span class="math inline">\(m_0\)</span> besitzt nur einen <span class="math inline">\(y\)</span>-Achsenabschnitt <span class="math inline">\(\beta_0\)</span>, der wie wir oben gesehen haben zu <span class="math inline">\(\bar{y}\)</span> wird. Modell <span class="math inline">\(m_1\)</span> hat einen zusätzlichen Parameter mit einem Steigungskoeffizienten <span class="math inline">\(\beta_1\)</span> für den Süßegrad, <span class="math inline">\(m_1\)</span> hat zusätzlich noch einen Parameter <span class="math inline">\(\beta_2\)</span> für den Saftanteil. Wir können nun diese Modelle in folgender Hierarchie anordnen.</p>
<p><span class="math display">\[\begin{equation*}
m_0 \subseteq m_1 \subseteq m_2 \subseteq m_3
\end{equation*}\]</span></p>
<p>Es gilt ebenfalls</p>
<p><span class="math display">\[\begin{equation*}
p_{m_0} &lt; p_{m_1} &lt; p_{m_2} &lt; p_{m_3}
\end{equation*}\]</span></p>
<p>In <code>R</code> können wir die entsprechenden Modelle fitten.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mod_0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(like <span class="sc">~</span> <span class="dv">1</span>, candy)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>mod_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(like <span class="sc">~</span> sweetness, candy)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>mod_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(like <span class="sc">~</span> sweetness <span class="sc">+</span> moisture, candy)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>mod_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(like <span class="sc">~</span> sweetness <span class="sc">*</span> moisture, candy)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Den Vergleich <span class="math inline">\(m_0\)</span> gegen <span class="math inline">\(m_1\)</span></p>
<p><span class="math display">\[\begin{align*}
m_0: y_i &amp;= \beta_0 + \epsilon_i \\
m_1: y_i &amp;= \beta_0 + \beta_1 x_{1i} + \epsilon_i
\end{align*}\]</span></p>
<p>können wir mit der <code>anova()</code> Funktion machen, indem wir die beiden gefitteten Modelle übergeben (tatsächlich können auch mehr Modelle übergeben werden).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_0, mod_1)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: like ~ 1
Model 2: like ~ sweetness
  Res.Df   RSS Df Sum of Sq     F    Pr(&gt;F)    
1     77 50305                                 
2     76 37267  1     13039 26.59 1.938e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Die Einträge unter <code>ResDf</code> sind die jeweiligen <span class="math inline">\(df_{E}\)</span>, <code>RSS</code> die jeweiligen Quadratsummen, unter <code>Df</code> ist der Unterschied in der Anzahl der Modellparameter angeben, gefolgt von <span class="math inline">\(MS_{\text{test}}\)</span> und dem resultierenden <span class="math inline">\(F\)</span>-Wert und des p-Werts unter der <span class="math inline">\(H_0\)</span>. Im Beispiel sehen wir wenig überraschend einen statistische signifikanten p-Wert.</p>
<p>Parallel dazu können wir <span class="math inline">\(m_1\)</span> gegen <span class="math inline">\(m_2\)</span> testen.</p>
<p><span class="math display">\[\begin{align*}
m_1: y_i &amp;= \beta_0 + \beta_1 x_{1i} + \epsilon_i \\
m_2: y_i &amp;= \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \epsilon_i
\end{align*}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_1, mod_2)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: like ~ sweetness
Model 2: like ~ sweetness + moisture
  Res.Df   RSS Df Sum of Sq      F    Pr(&gt;F)    
1     76 37267                                  
2     75  6328  1     30939 366.69 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Wiederum deutet der Test einen darauf, das das komplexere Modell das beide Variablen enthält des statisch besseren fit ermöglicht.</p>
<p>Letztendlich erfolgt der Test von <span class="math inline">\(m_3\)</span> gegen <span class="math inline">\(m_2\)</span>.</p>
<p><span class="math display">\[\begin{align*}
m_2: y_i &amp;= \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \epsilon_i  \\
m_3: y_i &amp;= \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \beta_3 x_{1i} x_{2i} + \epsilon_i
\end{align*}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_2, mod_3)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: like ~ sweetness + moisture
Model 2: like ~ sweetness * moisture
  Res.Df  RSS Df Sum of Sq      F    Pr(&gt;F)    
1     75 6328                                  
2     74  320  1      6008 1389.5 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Dieser Test zeigt ebenfalls ein statistisch signifikantes Ergebnis.</p>
<p>Wir sind aber nicht darauf beschränkt immer nur einen zusätzlichen Parameter zu testen. In diesem Fall ist der <span class="math inline">\(F\)</span>-Test äquivalent zum <span class="math inline">\(t\)</span>-Wert den wir unter <code>summary()</code> angezeigt bekommen. Der <span class="math inline">\(F\)</span> ist gleich dem quadrierten <span class="math inline">\(t\)</span>-Wert.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_3)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = like ~ sweetness * moisture, data = candy)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.7122 -1.1552  0.0753  1.2602  4.6153 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        2.067831   1.078884   1.917   0.0591 .  
sweetness          0.062364   0.053834   1.158   0.2504    
moisture           0.058400   0.083390   0.700   0.4859    
sweetness:moisture 0.158649   0.004256  37.275   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.079 on 74 degrees of freedom
Multiple R-squared:  0.9936,    Adjusted R-squared:  0.9934 
F-statistic:  3853 on 3 and 74 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Wir können nun aber ebenso das Modell <span class="math inline">\(m_3\)</span> mit <span class="math inline">\(p = 4\)</span> Parametern gegen das <span class="math inline">\(m_0\)</span> Modell mit <span class="math inline">\(p = 1\)</span> Parameter vergleichen.</p>
<p><span class="math display">\[\begin{align*}
m_0: y_i &amp;= \beta_0 + \epsilon_i  \\
m_3: y_i &amp;= \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \beta_3 x_{1i} x_{2i} + \epsilon_i
\end{align*}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_0, mod_3)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: like ~ 1
Model 2: like ~ sweetness * moisture
  Res.Df   RSS Df Sum of Sq      F    Pr(&gt;F)    
1     77 50305                                  
2     74   320  3     49985 3853.3 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>In diesem Fall wird getestet ob die Hinzunahme der Parameter <span class="math inline">\(\beta_1, \beta_2\)</span> und <span class="math inline">\(\beta_3\)</span> eine statistisch signifikante Verbesserung im Modellfit bedeutet. Tatsächlich wird dieser Test in der Ausgabe von <code>summary()</code> angegeben.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_3)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = like ~ sweetness * moisture, data = candy)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.7122 -1.1552  0.0753  1.2602  4.6153 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        2.067831   1.078884   1.917   0.0591 .  
sweetness          0.062364   0.053834   1.158   0.2504    
moisture           0.058400   0.083390   0.700   0.4859    
sweetness:moisture 0.158649   0.004256  37.275   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.079 on 74 degrees of freedom
Multiple R-squared:  0.9936,    Adjusted R-squared:  0.9934 
F-statistic:  3853 on 3 and 74 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Um noch einmal die Idee aufzugreifen das reduzierte Modell als das volle Modell mit zusätzlichen Randbedinungen zu betrachten, im vorliegenden Fall:</p>
<p><span class="math display">\[\begin{equation*}
m_0: y_i = \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \beta_3 x_{1i} x_{2i} + \epsilon_i, \quad \beta_1 = 0, \beta_2 = 0, \beta_3 = 0
\end{equation*}\]</span></p>
<p>Der Modellvergleich erlaubt uns nun mehrere Parameter auf einmal zu testen. Bisher haben wir immer nur einen einzelnen Parameter getestet. Zusätzlich, erlaubt der Modellvergleich dasjenige Modell zu bestimmen, welches die Daten am <em>Besten</em> bzw. am einfachsten (mit den wenigstens Parametern) modelliert.</p>
</section>
<section id="beispiel-nominale-variable" class="level2" data-number="18.3">
<h2 data-number="18.3" class="anchored" data-anchor-id="beispiel-nominale-variable"><span class="header-section-number">18.3</span> Beispiel: Nominale Variable</h2>
<p>Schauen wir uns als Nächstes an, was passiert wenn wir eine nominale Variable in unser Modell aufnehmen. In <a href="#fig-mlm-hier-rtex">Abbildung&nbsp;<span>18.6</span></a> haben wir ein hypothetisches Beispiel. Es wurde ein Reaktionszeitexperiment mit vier verschiedenen Konditionen A, B, C und D gemacht.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-mlm-hier-rtex" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="mlm_hierarchies_files/figure-html/fig-mlm-hier-rtex-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Abbildung&nbsp;18.6: Ein Reaktionszeitexperiment mit vier Stufen A, B, C und D</figcaption>
</figure>
</div>
</div>
</div>
<p>Im Bachelor haben wir dazu gelernt eine Analysis of Variance (ANOVA) anzuwenden um diese Art von Daten zu analysieren. Ausgangspunkt war die Zerlegung der Varianz in:</p>
<p><span class="math display">\[\begin{equation*}
SS_{total} = SS_{between} + SS_{error}
\end{equation*}\]</span></p>
<p>Mit etwas motiviertem Starren fällt uns natürlich auf, das das ziemlich ähnlich unserer Regressionszerlegung in <span class="math inline">\(SSR\)</span> und <span class="math inline">\(SSE\)</span> aussieht. Damals sind die folgenden Formeln zur Berechnung verwendet worden.</p>
<p><span class="math display">\[\begin{align*}
s_{between}^2 &amp;= \frac{1}{K-1}\sum_{j=1}^K N_j (\bar{y}_{j.}-\bar{y})^2 \\
s_{within}^2 &amp;= \frac{1}{N-K}\sum_{j=1}^K\sum_{i=1}^{N_j}(y_{ji}-\bar{y}_{j.})^2 = \frac{1}{N-K}\sum_{j=1}^K(N_j-1)s_j^2 \\
F &amp;= \frac{\hat{\sigma}_{between}^2} {\hat{\sigma}_{within}^2} \sim F(K-1,N-K)
\end{align*}\]</span></p>
<p>Diese lassen wir zunächst einmal links liegen und greifen sie erst wieder später im Rahmen von CR-Designs wieder auf.</p>
<p>In <code>R</code> berechnen wir eine ANOVA mit der <code>aov()</code> Funktion. Die Modellformulierung ist gleich derjenigen wie mit <code>lm()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>mod_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(rt <span class="sc">~</span> group, rt_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Anwendung von <code>summary()</code> auf das gefittete <code>aov</code>-Modell liefert die übliche ANOVA-Tabelle.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)    
group        3 988935  329645   157.3 &lt;2e-16 ***
Residuals   76 159221    2095                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Wie sieht das Ganz aus, wenn wir den Ansatz mit Modellhierarchien anwenden? Nun, wir kennen das Beispiel schon und wissen das wir eine nominale Variable mittels Dummy-Variablen abbilden können. Daher formulieren das vollständige Modell als dasjenige, bei dem wir für beispielsweise Stufe A als Referenz nehmen und mittels dreier Dummy-Variablen (<span class="math inline">\(K-1\)</span>) die Abweichungen der Stufen B-D von A modellieren.</p>
<p><span class="math display">\[\begin{equation*}
y_i = \beta_0 + \beta_{\Delta_{B-A}} x_1 + \beta_{\Delta_{C-A}} x_2 + \beta_{\Delta_{D-A}} x_3 + \epsilon_i
\end{equation*}\]</span></p>
<p>D.h. <span class="math inline">\(p = 4\)</span>. Als reduziertes Modell wählen wir das Modell mit nur einem Parameter mit <span class="math inline">\(p = 1\)</span>.</p>
<p><span class="math display">\[\begin{equation*}
y_i = \beta_0 + \epsilon_i
\end{equation*}\]</span></p>
<p>Wenn das reduzierte Modell die Daten gleich gut fittet wie das vollständige Modell dann bedeutet dass, das die zusätzliche Information über die verschiedenen Konditionstufen meine Vorhersage von <span class="math inline">\(y_i\)</span> nicht verbessert.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(rt <span class="sc">~</span> group, rt_tbl)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = rt ~ group, data = rt_tbl)

Residuals:
     Min       1Q   Median       3Q      Max 
-120.261  -25.789   -0.857   27.520  114.994 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   509.53      10.23  49.784  &lt; 2e-16 ***
groupB         90.15      14.47   6.228  2.4e-08 ***
groupC        197.41      14.47  13.639  &lt; 2e-16 ***
groupD        295.56      14.47  20.420  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 45.77 on 76 degrees of freedom
Multiple R-squared:  0.8613,    Adjusted R-squared:  0.8559 
F-statistic: 157.3 on 3 and 76 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Wenn wir uns die letzte Zeile im <code>summary()</code> Ausdruck anschauen, dann sehen wir dort die gleichen Werte wie wir mit <code>aov()</code> erhalten haben. Wenn wir <code>anova()</code> das gefittete <code>lm</code> Modell übergeben erhalten wir sogar genau die gleiche ANOVA Tabelle.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: rt
          Df Sum Sq Mean Sq F value    Pr(&gt;F)    
group      3 988935  329645  157.35 &lt; 2.2e-16 ***
Residuals 76 159221    2095                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Tatsächlich verwendet <code>aov()</code> im Hintergrund auch nichts anderes als die <code>lm()</code> Funktion. Insgesamt bedeutet das für uns, das die ANOVA und Regression letztendlich auf das gleiche Modell zurück gehen, nämlich auf das Allgemeine Lineare Modell.</p>
</section>
<section id="zum-nacharbeiten" class="level2" data-number="18.4">
<h2 data-number="18.4" class="anchored" data-anchor-id="zum-nacharbeiten"><span class="header-section-number">18.4</span> Zum Nacharbeiten</h2>
<p>Viele der Ideen die hier diskutiert werden sind aus <span class="citation" data-cites="christensen2018">Christensen (<a href="references.html#ref-christensen2018" role="doc-biblioref">2018, p.57–64</a>)</span>. Daher wer noch mal etwas mehr Hintergrund dazu haben möchte, sei diese Quelle wärmstens empfohlen.</p>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-christensen2018" class="csl-entry" role="listitem">
Christensen, Ronald. 2018. <em>Analysis of variance, design, and regression: Linear modeling for unbalanced data</em>. CRC Press.
</div>
<div id="ref-maxwell2004" class="csl-entry" role="listitem">
Maxwell, Scott E, Harold D Delaney, und Ken Kelley. 2004. <em>Designing experiments and analyzing data: A model comparison perspective</em>. 2. Aufl. Routledge.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./mlm_dummy_coding.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Integration von nominalen Variablen</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./lm_title.html" class="pagination-link">
        <span class="nav-page-text">Das allgemeine lineare Modell</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>