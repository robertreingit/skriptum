<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Skriptum - Fortgeschrittene Statistik - 25&nbsp; ANCOVA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ed_crbd.html" rel="next">
<link href="./ed_crfd.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>
<script>
  MathJax = {
    tex: {
      tags: 'ams'  // should be 'ams', 'none', or 'all'
    }
  };
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ed_title.html">Experimentelles Design</a></li><li class="breadcrumb-item"><a href="./ed_ancova.html"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">ANCOVA</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Skriptum - Fortgeschrittene Statistik</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vorwort</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./r_startup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Eine Einführung in die Programmiersprache R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Eine Übersicht über <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_vars_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Variablen und Datentypen in <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_flowcontrol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Ablaufkontrolle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Eigene Funktionen in <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Datenverarbeitung mit <code>tidyverse</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Datenvisualisierung mit <code>ggplot2</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_literate_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Literate programming in <code>R</code></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stats_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistik - Die Grundlagen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Eine kleine Welt der Unsicherheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_significance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Statistische Signifikanz, p-Wert und Power</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Parameterschätzung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Theoretische Verteilungen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_hypotheses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Hypothesen testen</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./slm_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Das einfache Regressionmodell</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Einführung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Inferenz</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_model_fit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Modellfit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Vorhersage</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./mlm_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Einführung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_interactions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Interaktionseffekte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_dummy_coding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Integration von nominalen Variablen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_hierarchies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Modellhierarchien</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ed_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelles Design</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Einführung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_crd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Completely Randomized Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_linear_contrasts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Lineare Kontraste</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_crfd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Completely Randomized Factorial Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_ancova.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_crbd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Completely Randomized Block Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_split_plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Split-plot Design</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literatur</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#modell-der-ancova" id="toc-modell-der-ancova" class="nav-link active" data-scroll-target="#modell-der-ancova"><span class="header-section-number">25.1</span> Modell der ANCOVA</a></li>
  <li><a href="#beispiele-für-effektrelationen" id="toc-beispiele-für-effektrelationen" class="nav-link" data-scroll-target="#beispiele-für-effektrelationen"><span class="header-section-number">25.2</span> Beispiele für Effektrelationen</a></li>
  <li><a href="#ancova-in-r" id="toc-ancova-in-r" class="nav-link" data-scroll-target="#ancova-in-r"><span class="header-section-number">25.3</span> ANCOVA in <code>R</code></a></li>
  <li><a href="#ancova-effect-size-omega2" id="toc-ancova-effect-size-omega2" class="nav-link" data-scroll-target="#ancova-effect-size-omega2"><span class="header-section-number">25.4</span> ANCOVA Effect size <span class="math inline">\(\omega^2\)</span></a>
  <ul class="collapse">
  <li><a href="#overall" id="toc-overall" class="nav-link" data-scroll-target="#overall"><span class="header-section-number">25.4.1</span> overall</a></li>
  <li><a href="#im-beispiel" id="toc-im-beispiel" class="nav-link" data-scroll-target="#im-beispiel"><span class="header-section-number">25.4.2</span> Im Beispiel</a></li>
  </ul></li>
  <li><a href="#effect-size-omega2" id="toc-effect-size-omega2" class="nav-link" data-scroll-target="#effect-size-omega2"><span class="header-section-number">25.5</span> Effect size <span class="math inline">\(\omega^2\)</span></a></li>
  <li><a href="#standardized-differences-between-means" id="toc-standardized-differences-between-means" class="nav-link" data-scroll-target="#standardized-differences-between-means"><span class="header-section-number">25.6</span> standardized differences between means</a></li>
  <li><a href="#sample-size-estimate" id="toc-sample-size-estimate" class="nav-link" data-scroll-target="#sample-size-estimate"><span class="header-section-number">25.7</span> sample size estimate</a></li>
  <li><a href="#sample-size-beispiel" id="toc-sample-size-beispiel" class="nav-link" data-scroll-target="#sample-size-beispiel"><span class="header-section-number">25.8</span> sample size Beispiel</a></li>
  <li><a href="#sample-size-example" id="toc-sample-size-example" class="nav-link" data-scroll-target="#sample-size-example"><span class="header-section-number">25.9</span> sample size example</a></li>
  <li><a href="#was-passiert-wenn-die-kovariate-interagiert" id="toc-was-passiert-wenn-die-kovariate-interagiert" class="nav-link" data-scroll-target="#was-passiert-wenn-die-kovariate-interagiert"><span class="header-section-number">25.10</span> Was passiert wenn die Kovariate interagiert</a></li>
  <li><a href="#modell" id="toc-modell" class="nav-link" data-scroll-target="#modell"><span class="header-section-number">25.11</span> Modell</a></li>
  <li><a href="#welcher-unterschied-zwischen-den-gruppen" id="toc-welcher-unterschied-zwischen-den-gruppen" class="nav-link" data-scroll-target="#welcher-unterschied-zwischen-den-gruppen"><span class="header-section-number">25.12</span> Welcher Unterschied zwischen den Gruppen?</a></li>
  <li><a href="#modellfit---interaktionsmodell" id="toc-modellfit---interaktionsmodell" class="nav-link" data-scroll-target="#modellfit---interaktionsmodell"><span class="header-section-number">25.13</span> Modellfit - Interaktionsmodell</a></li>
  <li><a href="#mehrfachvergleiche---ems-mittelwerte" id="toc-mehrfachvergleiche---ems-mittelwerte" class="nav-link" data-scroll-target="#mehrfachvergleiche---ems-mittelwerte"><span class="header-section-number">25.14</span> Mehrfachvergleiche - EMS Mittelwerte</a></li>
  <li><a href="#mehrfachvergleiche---paarweise-vergleiche" id="toc-mehrfachvergleiche---paarweise-vergleiche" class="nav-link" data-scroll-target="#mehrfachvergleiche---paarweise-vergleiche"><span class="header-section-number">25.15</span> Mehrfachvergleiche - Paarweise Vergleiche</a></li>
  <li><a href="#beispiel-aus-maxwell2004-p.429" id="toc-beispiel-aus-maxwell2004-p.429" class="nav-link" data-scroll-target="#beispiel-aus-maxwell2004-p.429"><span class="header-section-number">25.16</span> Beispiel aus <span class="citation" data-cites="maxwell2004">(Maxwell, Delaney, und Kelley 2004, p.429)</span></a></li>
  <li><a href="#analyse" id="toc-analyse" class="nav-link" data-scroll-target="#analyse"><span class="header-section-number">25.17</span> Analyse</a></li>
  <li><a href="#gruppenvergleiche" id="toc-gruppenvergleiche" class="nav-link" data-scroll-target="#gruppenvergleiche"><span class="header-section-number">25.18</span> Gruppenvergleiche</a></li>
  <li><a href="#zum-nachlesen" id="toc-zum-nachlesen" class="nav-link" data-scroll-target="#zum-nachlesen"><span class="header-section-number">25.19</span> Zum Nachlesen</a>
  <ul class="collapse">
  <li><a href="#allgemein" id="toc-allgemein" class="nav-link" data-scroll-target="#allgemein"><span class="header-section-number">25.19.1</span> Allgemein</a></li>
  <li><a href="#pre-post-ancova" id="toc-pre-post-ancova" class="nav-link" data-scroll-target="#pre-post-ancova"><span class="header-section-number">25.19.2</span> Pre-post ANCOVA</a></li>
  <li><a href="#regression-to-the-mean" id="toc-regression-to-the-mean" class="nav-link" data-scroll-target="#regression-to-the-mean"><span class="header-section-number">25.19.3</span> Regression to the mean</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ed_title.html">Experimentelles Design</a></li><li class="breadcrumb-item"><a href="./ed_ancova.html"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">ANCOVA</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">ANCOVA</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In den vorhergehenden Kapiteln zu CRD bzw. CRFD haben wir uns angeschaut, wie wir den Einfluss einer oder mehrerer nominaler, unabhängiger Variablen auf eine abhängige Variable modellieren können. In diesem Zusammenhang haben wir uns auch mit der Varianzzerlegung auseinandergesetzt und immer wieder gesehen, dass diese Zerlegung auch als der Vergleich von verschiedenen Modellen miteinander betrachtet werden kann. Im Rahmen der ANCOVA führen wir jetzt wieder eine kontinuierliche Variable in unser Modell ein, wie wir das schon im Rahmen der multiplen linearen Regression getan haben. Diese zusätzliche, kontinuierliche Variable spielt dabei die Rolle einer Kontrollvariablen. Mit Hilfe dieser Kontrollvariable soll ebenfalls Varianz von <span class="math inline">\(Y\)</span> erklärt werden. Der Effekt der Kontrollvariablen auf <span class="math inline">\(Y\)</span> ist allerdings nicht das Primärinteresse der Untersuchung sondern dient nur die Präzision des Modells zu erhöhen. Letztendlich führt dies dazu, dass auch die Power der Untersuchung erhöht wird.</p>
<p>Ein Beispiel könnte eine Untersuchung zu Trainingseffekten sein. Aus der Literatur wissen wir bereits, das das Alter der Teilnehmerinnen und Teilnehmer eine Rolle auf den Trainingseffekt hat. Daher macht es Sinn für den Effekt des Alters im Rahmen der Modells zu kontrollieren. Das primäre Interessiere der Untersuchung liegt auf dem Effekt des Trainings. Die Variable Alter wird in diesem Fall als Kovariate bezeichnet, wodurch sich auch die Namensgebung ANCOVA als Abkürzung für Analysis of Covariance herleitet. Welche Variablen die Rolle der primären Variablen und der Kovariaten spielen ist dabei von der konkreten Untersuchung abhängig. Es kann genauso vorkommen, dass eine nominale Variable die Rolle der Kovariaten spielt und eine kontinuierliche Variable die Primärvariable der Untersuchung ist.</p>
<p>Konzeptionell wird durch die Integration einer Kovariaten Information über Unterschiede zwischen den beiden Gruppen die vor der Beobachtungsphase bestehen in das Modell mit einbezogen. D.h. trotzdem wir die Beobachtungseinheiten randomisiert in beispielsweise zwei Gruppen unterteilt haben, wissen wir, das das Alter einen Effekt auf die abhängige Variable hat. Bei einer perfekten, randomisierten Zuweisung sollte das Alter eigentlich keinen mehr Einfluss haben, da beide Gruppen die gleiche Altersstruktur haben sollten. Trotzdem sind wir in der Lage die Einbeziehung zusätzliche Varianz aufzuklären und können so den Effekt der Primärvariablen hoffentlich besser isolieren. Oft kann zum Beispiel der Startwert der abhängigen Variable als Kovariate verwendet werden. Die Kovariate ist dann auf der gleichen Skala wie die Zielvariable.</p>
<div id="exm-ancova-01" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 25.1</strong></span> In <span class="citation" data-cites="fien2019">Fien u.&nbsp;a. (<a href="references.html#ref-fien2019" role="doc-biblioref">2019</a>)</span> wurde unter anderem der Einfluss einer Trainingsintervention auf die Gehgeschwindigkeit in einem zweiarmigen Untersuchungsdesign untersucht. Als Zielvariable wurde die Gehgeschwindigkeit nach der Interventionsphase verwendet. Um die bestehenden Unterschiede zwischen den Teilnehmerinnen und Teilnehmer vor der Untersuchung mit einzubeziehen, wurde die Gehgeschwindigkeit vor der Intervention als Kovariate verwendet.</p>
</div>
<div id="def-covariate" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 25.1 (Kovariate)</strong></span> Eine Kovariate ist eine Variable, die verwendet wird, um den Einfluss auf die abhängige Variable zu kontrollieren um genauere Schätzungen der Beziehungen zwischen den primären unabhängigen Variablen und der abhängigen Variable zu erhalten.</p>
<p>Alternativ werden in der Literatur auch die Begriffe Störvariable (engl. nuisance factor) oder concomitant variable (engl.) verwendet. Wenn die Kovariate auf der gleichen Skala wie die Primärvariable ist, wird sie auch als commensurate (engl.) bezeichnet.</p>
</div>
<p>Beginnen wir mit einem einfachen konzeptionellen Modell (siehe <a href="#fig-ed-ancova-01" class="quarto-xref">Abbildung&nbsp;<span>25.1</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ed-ancova-01" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ed-ancova-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_ancova_files/figure-html/fig-ed-ancova-01-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ed-ancova-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;25.1: Zusammenhang einer abhängigen Variable mit einer Kovariate und einer nominalen Variable (treatment)
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-ed-ancova-01" class="quarto-xref">Abbildung&nbsp;<span>25.1</span></a> zeigt den Zusammenhang zwischen zwei Gruppen <span class="math inline">\(A\)</span> und <span class="math inline">\(B\)</span> und einer abhängigen Variablen DV sowie den Zusammenhang einer Kovariate (<span class="math inline">\(x\)</span>-Achse) mit DV. Zwischen der Kovariaten und der DV besteht ein positiver Zusammenhang und der Effekt von Treatment <span class="math inline">\(A\)</span> ist kleiner als derjenige von Treatment <span class="math inline">\(B\)</span>. Der Effekt der Kovariaten ist dabei in beiden Gruppen gleich und es besteht keine Interaktion zwischen der Kovariaten und den Gruppen. Dies führt dazu, dass die beiden Geraden parallel zueinander sind. Letztendlich haben wir dieses Modell schon bei der Besprechung der Intergration von nominalen Variablen in das multiple Regressionsmodell behandelt.</p>
<p>Wenn wir die beiden Gruppen miteinander vergleich sind mehrer unterschiedliche Vergleiche möglich. Nehmen wir zum Beispiel einen Datenpunkt <span class="math inline">\(P1\)</span> aus Gruppe <span class="math inline">\(A\)</span>. Dann können wir den <span class="math inline">\(P1\)</span> mit mehreren verschiedenen Datenpunkten aus Gruppe <span class="math inline">\(B\)</span> vergleichen. In <a href="#fig-ed-ancova-02" class="quarto-xref">Abbildung&nbsp;<span>25.2</span></a> sind drei mögliche Vergleiche eingezeichnet.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ed-ancova-02" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ed-ancova-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_ancova_files/figure-html/fig-ed-ancova-02-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ed-ancova-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;25.2: Verschiedene Vergleiche der beiden Gruppen miteinander
</figcaption>
</figure>
</div>
</div>
</div>
<p>Letztendlich erscheint aber nur einer der Vergleiche sinnvoll, nämlich der Vergleich wenn die beiden Gruppenwerte den gleichen Wert in der Kovariate haben. Wäre zum Beispiel die Kovariate das Alter, dann würde ein Vergleich von zwei Personen die sich im Alter unterscheiden wenig sinnvoll da nicht klar ist ob der Unterschied in der abhängigen Variable auf den Unterschied im Alter oder auf den Unterschied im Treatment zurück zu führen ist. Genau dieses Problem wird mit Hilfe der ANCOVA gelöst und die ANCOVA liefert eine Antwort auf die Frage:</p>
<p><em>Wie unterschieden sich die Gruppen voneinander, wenn sie die gleichen Werte in der Kovariate hätten?</em></p>
<p>Schauen wir uns ein weiteres Beispiel an. In <a href="#fig-ed-ancova-03" class="quarto-xref">Abbildung&nbsp;<span>25.3</span></a> sind diesmal Datenpunkte eingezeichnet und scheinbar ist bei der Zuweisung der Teilnehmerinnen und Teilnehmer etwas grundsätzlich schief gelaufen.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ed-ancova-03" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ed-ancova-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_ancova_files/figure-html/fig-ed-ancova-03-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ed-ancova-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;25.3: Probleme durch die Kovariate
</figcaption>
</figure>
</div>
</div>
</div>
<p>Die Personen in Gruppe <span class="math inline">\(B\)</span> haben alle einen kleineren Wert in der Kovariate als die Personen in Gruppe <span class="math inline">\(A\)</span>. Gleichzeitig hat die Kovariate aber einen positiven Einfluss auf die DV. Hätte wir keine Information über die Kovariate und würden die beiden Gruppenmittelwerte miteinander vergleichen, dann würden wir wahrscheinlich keinen Unterschied zwischen den beiden Gruppen finden (siehe <a href="#fig-ed-ancova-04" class="quarto-xref">Abbildung&nbsp;<span>25.4</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ed-ancova-04" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ed-ancova-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_ancova_files/figure-html/fig-ed-ancova-04-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ed-ancova-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;25.4: Mittelwerte der Gruppen (schwarze Punkte) mit unterschiedlichen Kovariaten
</figcaption>
</figure>
</div>
</div>
</div>
<p>Um die beiden Gruppen miteinander vergleichen zu können müssten wir die Unterschiede in den Mittelwerten der Kovariaten korrigieren um die Gruppen zu vergleichen wenn sie die gleiche Verteilung in der Kovariaten hätten.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ed-ancova-05" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ed-ancova-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_ancova_files/figure-html/fig-ed-ancova-05-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ed-ancova-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;25.5: Vergleich der Gruppen bei koorigierten Kovariaten
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-ed-ancova-05" class="quarto-xref">Abbildung&nbsp;<span>25.5</span></a> sind die eigentlich sinnvollen Vergleiche angezeigt. Dabei wird auch noch einmal klar, dass in diesem Modell sobald wir für die Werte der Kovariaten kontrolliert haben, die Position des Vergleichs unerheblich ist, da wir von einem Modell ausgehen, bei dem der Effekt der Kovariaten in beiden Gruppen gleich ist. Dies führt zu den parallelen Linien.</p>
<section id="modell-der-ancova" class="level2" data-number="25.1">
<h2 data-number="25.1" class="anchored" data-anchor-id="modell-der-ancova"><span class="header-section-number">25.1</span> Modell der ANCOVA</h2>
<p>Übertragen wir die Beispiele in eine Modellformulierung. Letztendlich können wir, wie schon angemerkt, das uns schon bekannte Modell aus der multiple linearen Regression anwenden.</p>
<p><span class="math display">\[\begin{equation}
Y_{it} = \mu + \tau_i + \beta x_{it} + \epsilon_{it} \quad \epsilon_{it} \sim \mathcal{N}(0,\sigma^2), i = 1,\ldots,K
\label{eq-ed-ancova-model}
\end{equation}\]</span></p>
<p>In Model <span class="math inline">\(\eqref{eq-ed-ancova-model}\)</span> kommt dementsprechend nichts Neues dazu, sondern unser standard lineares Modell. Der einzige Unterschied besteht in der Terminologie, während wir vorher <span class="math inline">\(\alpha_i\)</span> für die nominale Variable verwendet haben, wird der nominale Faktor im ANCOVA-Modell <span class="math inline">\(\tau_i\)</span> bezeichnet. Das sind aber nur Unterschied in den Buchstaben die leider auch nicht konsequent in der Literatur verwendet werden.</p>
<p>Um die spätere Interpretation der Koeffizienten zu vereinfachen, wird auch oft ein in der Kovariaten zentriertes Modell verwendet. Dies hat jedoch keine Auswirkung auf das Ergebnis.</p>
<p><span class="math display">\[\begin{equation}
Y_{it} = \mu^* + \tau_i + \beta (x_{it} - \bar{x}_{..}) + \epsilon_{it}
\label{eq-ed-ancova-model-c}
\end{equation}\]</span></p>
<p>Entsprechend ergeben sich auch keine unbekannten Voraussetzungen:</p>
<ul>
<li>Experimental units sind randomisiert den <span class="math inline">\(K\)</span> Gruppen zugewiesen worden</li>
<li>Varianz <span class="math inline">\(\sigma^2\)</span> ist konstant über Gruppen und Werte der Kovariate</li>
<li>Die Kovariate und das Treatment sind statistisch unabhängig voneinander</li>
</ul>
<p>Der der ANCOVA zugrundeliegende Test beruht dann wie immer auf einen Modellvergleich eines vollen Modell (Model <span class="math inline">\(\eqref{eq-ed-ancova-model}\)</span>) mit einem reduzierten Modell. Das reduzierte Modell beinhaltet dann nur die Kovariate, da wir den Unterschied in Bezug auf den Effekt der Primärvariable überprüfen wollen.</p>
<p><span class="math display">\[\begin{align*}
y_{ij} &amp;= \mu + \tau_{j} + \beta X_{ij} + \epsilon_{ij} \quad \text{full} \\
y_{ij} &amp;= \mu + \beta X_{ij} + \epsilon_{ij} \quad \text{reduced}
\end{align*}\]</span></p>
<p>Die <span class="math inline">\(H_0\)</span> für den Treatmenteffekt ist:</p>
<p><span class="math display">\[\begin{equation*}
H_0: \tau_1 = \tau_2 = \cdots = tau_K = 0
\end{equation*}\]</span></p>
<p>Der Unterschied zwischen den Treatmentstufen wird dabei für den Wert <span class="math inline">\(\bar{x}_{..}\)</span>, als den Mittelwert der Kovariate über alle Gruppenhinweg bestimmt.</p>
<p>Die <span class="math inline">\(H_0\)</span> für die Kovariate ist:</p>
<p><span class="math display">\[\begin{equation*}
H_0: \beta = 0
\end{equation*}\]</span></p>
<p>Das Ergebnis der Analyse wird oft auch in Form einer Varianz-Tabelle dargestellt (siehe <a href="#tbl-ed-ancova-ssq" class="quarto-xref">Tabelle&nbsp;<span>25.1</span></a>).</p>
<div id="tbl-ed-ancova-ssq" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ed-ancova-ssq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;25.1: Varianztabelle der ANCOVA
</figcaption>
<div aria-describedby="tbl-ed-ancova-ssq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Term</th>
<th><span class="math inline">\(df\)</span></th>
<th><span class="math inline">\(SSQ\)</span></th>
<th><span class="math inline">\(MSQ\)</span></th>
<th>F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(T|\beta\)</span></td>
<td><span class="math inline">\(K-1\)</span></td>
<td><span class="math inline">\(ss(T|\beta)\)</span></td>
<td><span class="math inline">\(\frac{ss(T|\beta)}{K-1}\)</span></td>
<td><span class="math inline">\(\frac{ms(T|\beta)}{msE}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\beta|T\)</span></td>
<td><span class="math inline">\(1\)</span></td>
<td><span class="math inline">\(ss(\beta|T)\)</span></td>
<td><span class="math inline">\(\frac{ss(\beta|T)}{1}\)</span></td>
<td><span class="math inline">\(\frac{ms(\beta|T)}{msE}\)</span></td>
</tr>
<tr class="odd">
<td>Error</td>
<td><span class="math inline">\(N-K-1\)</span></td>
<td><span class="math inline">\(ssE\)</span></td>
<td><span class="math inline">\(msE\)</span></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Die Schreibweise <span class="math inline">\(T|\beta\)</span> bezeichnet den Effekt des Treatments nachdem für die Kovariate kontrolliert wurde während <span class="math inline">\(\beta|T\)</span> den Effekt der Kovariate nachdem für das Treatment kontrolliert wurde beschreibt.</p>
<p>Schauen wir uns dies in einem Spielzeugbeispiel an. In <a href="#tbl-ed-ancova-max-01" class="quarto-xref">Tabelle&nbsp;<span>25.2</span></a> ist ein Beispieldatensatz aus <span class="citation" data-cites="maxwell2004">Maxwell, Delaney, und Kelley (<a href="references.html#ref-maxwell2004" role="doc-biblioref">2004</a>)</span> tabellelarisch abgebildet.</p>
<div class="cell">
<div id="tbl-ed-ancova-max-01" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ed-ancova-max-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;25.2: Ein einfacher ANCOVA-Datensatz
</figcaption>
<div aria-describedby="tbl-ed-ancova-max-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<caption>Beispieldaten</caption>
<thead>
<tr class="header">
<th style="text-align: left;">ID</th>
<th style="text-align: left;">Gruppe</th>
<th style="text-align: right;">x</th>
<th style="text-align: right;">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">S1</td>
<td style="text-align: left;">TRT</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">S2</td>
<td style="text-align: left;">TRT</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">S3</td>
<td style="text-align: left;">TRT</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">S4</td>
<td style="text-align: left;">CON</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">S5</td>
<td style="text-align: left;">CON</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">S6</td>
<td style="text-align: left;">CON</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">16</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Wir haben zwei Gruppen (TRT und CON) mit jeweils <span class="math inline">\(N = 3\)</span> mit einer Kovariate <span class="math inline">\(x\)</span>.</p>
<p>Ein Vergleich des vollen und des reduzierten Modells führt zu folgendem Ergebnis:</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Vergleich full vs.&nbsp;reduced model.</caption>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">rss</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">sumsq</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">y ~ x</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">14.4</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">y ~ x + group</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">12.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">0.6</td>
<td style="text-align: right;">0.495</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Oder die Varianztabelle (siehe <a href="#tbl-ed-ancova-ex-01" class="quarto-xref">Tabelle&nbsp;<span>25.3</span></a>):</p>
<div class="cell">
<div id="tbl-ed-ancova-ex-01" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ed-ancova-ex-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;25.3: Varianztabelle
</figcaption>
<div aria-describedby="tbl-ed-ancova-ex-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: right;">SSQ</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">MSQ</th>
<th style="text-align: right;">F</th>
<th style="text-align: right;">p-Wert</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">x</td>
<td style="text-align: right;">16.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16.0</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">0.139</td>
</tr>
<tr class="even">
<td style="text-align: left;">group</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">0.6</td>
<td style="text-align: right;">0.495</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residuals</td>
<td style="text-align: right;">12.0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>D.h. im Beispiel ist kein statistisch signifikanter Effekt des Treatment zu finden. Aber was passiert wenn wir den Treatmenteffekt gegen ein auf den <span class="math inline">\(y\)</span>-Achsenabschnitt reduziertes Modell testen?</p>
<div class="cell">
<div id="tbl-ed-ancova-mod00" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ed-ancova-mod00-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;25.4: Modellvergleich von <span class="math inline">\(y_i = \beta_0 + \epsilon_i\)</span> gegen <span class="math inline">\(y_i = \beta_0 + \tau_i + \epsilon_i\)</span>
</figcaption>
<div aria-describedby="tbl-ed-ancova-mod00-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">rss</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">sumsq</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">y ~ 1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">82</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">y ~ group</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">7.7143</td>
<td style="text-align: right;">0.0499</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Wie kann das denn sein? Schauen wir uns dazu eine graphische Darstellung der Daten an (siehe <a href="#fig-ed-ancova-mod01" class="quarto-xref">Abbildung&nbsp;<span>25.6</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ed-ancova-mod01" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ed-ancova-mod01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_ancova_files/figure-html/fig-ed-ancova-mod01-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ed-ancova-mod01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;25.6: Streudiagramm der Rohdaten
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-ed-ancova-mod01" class="quarto-xref">Abbildung&nbsp;<span>25.6</span></a> können wir sehen, dass die beiden Gruppen sich deutlich in der Kovariate <span class="math inline">\(x\)</span> unterscheiden. Was dazu führt, dass die Mittelwerte der beiden Gruppen auch entsprechend unterschiedlich ist. Dadurch führt ein Test für den Unterschied zwischen den beiden Gruppen dazu, dass es zu einem statistisch signifikanten Ergebnis für das Treatment führt. Wird allerdings zunächst für die Kovariate kontrolliert (siehe <a href="#fig-ed-ancova-mod02" class="quarto-xref">Abbildung&nbsp;<span>25.7</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ed-ancova-mod02" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ed-ancova-mod02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_ancova_files/figure-html/fig-ed-ancova-mod02-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ed-ancova-mod02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;25.7: Streudiagramm der Rohdaten mit den Geraden aus dem ANCOVA-Modell
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-ed-ancova-mod02" class="quarto-xref">Abbildung&nbsp;<span>25.7</span></a> sehen wir, dass wenn die beiden parallen Geraden für die Kovariate auf Basis des ANCOVA-Modells eingefügt werden, dann ist der Unterschied zwischen den beiden Gruppen deutlich geringer.</p>
<p>Adjusted means <span class="math inline">\(\bar{Y}_l'\)</span></p>
<p><span class="math display">\[
E[\bar{Y}_{i.}] = \mu + \tau_i + \beta\bar{x}_{..})
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>x_new <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">mean</span>(bw<span class="sc">$</span>x), <span class="at">group=</span><span class="fu">c</span>(<span class="st">'TRT'</span>,<span class="st">'CON'</span>))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>y_bar_j <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod_1, <span class="at">newdata =</span> x_new)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>y_bar_j</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 1  2 
 9 11 </code></pre>
</div>
</div>
<p>Adjusted means im Beispiel</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ed_ancova_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Korrigierte Mittelwerte der Gruppen bei <span class="math inline">\(\bar{x}\)</span>.</figcaption>
</figure>
</div>
</div>
</div>
<p>… oder Adjusted means mit <code>emmeans()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>y_bar_j2 <span class="ot">&lt;-</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(mod_1, <span class="sc">~</span>group)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>y_bar_j2</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> group emmean   SE df lower.CL upper.CL
 CON       11 1.53  3     6.14     15.9
 TRT        9 1.53  3     4.14     13.9

Confidence level used: 0.95 </code></pre>
</div>
</div>
</section>
<section id="beispiele-für-effektrelationen" class="level2" data-number="25.2">
<h2 data-number="25.2" class="anchored" data-anchor-id="beispiele-für-effektrelationen"><span class="header-section-number">25.2</span> Beispiele für Effektrelationen</h2>
<div class="columns">
<div class="column">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ed_ancova_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Effekt verkleinert sich</figcaption>
</figure>
</div>
</div>
</div>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ed_ancova_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Effekt vergrößert sich</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="ancova-in-r" class="level2" data-number="25.3">
<h2 data-number="25.3" class="anchored" data-anchor-id="ancova-in-r"><span class="header-section-number">25.3</span> ANCOVA in <code>R</code></h2>
</section>
<section id="ancova-effect-size-omega2" class="level2" data-number="25.4">
<h2 data-number="25.4" class="anchored" data-anchor-id="ancova-effect-size-omega2"><span class="header-section-number">25.4</span> ANCOVA Effect size <span class="math inline">\(\omega^2\)</span></h2>
<section id="overall" class="level3" data-number="25.4.1">
<h3 data-number="25.4.1" class="anchored" data-anchor-id="overall"><span class="header-section-number">25.4.1</span> overall</h3>
<p><span class="math display">\[
\hat{\omega}^2=\frac{df_{\text{effect}}(MS_{\text{effect}}-MS_{\text{error}})}{SS_{\text{total}}+MS_{\text{error}}}
\]</span></p>
</section>
<section id="im-beispiel" class="level3" data-number="25.4.2">
<h3 data-number="25.4.2" class="anchored" data-anchor-id="im-beispiel"><span class="header-section-number">25.4.2</span> Im Beispiel</h3>
<p><span class="math display">\[
\hat{\omega}^2 = \frac{1(2.4 - 4)}{82 + 4} = -0.02
\]</span></p>
<p><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
</section>
</section>
<section id="effect-size-omega2" class="level2" data-number="25.5">
<h2 data-number="25.5" class="anchored" data-anchor-id="effect-size-omega2"><span class="header-section-number">25.5</span> Effect size <span class="math inline">\(\omega^2\)</span></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">omega_squared</span>(mod_1, <span class="at">partial=</span>F)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA (Type I)

Parameter | Omega2 |       95% CI
---------------------------------
x         |   0.74 | [0.00, 1.00]
group     |   0.00 | [0.00, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
</div>
</section>
<section id="standardized-differences-between-means" class="level2" data-number="25.6">
<h2 data-number="25.6" class="anchored" data-anchor-id="standardized-differences-between-means"><span class="header-section-number">25.6</span> standardized differences between means</h2>
<p><span class="math display">\[
\hat{d} = \frac{\bar{Y}_l' - \bar{Y}_m'}{\sqrt{MS_W}}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>mod_r <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> group, bw)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">::</span><span class="fu">eff_size</span>(y_bar_j2, <span class="at">sigma =</span> <span class="fu">sigma</span>(mod_r), <span class="at">edf =</span> <span class="fu">df.residual</span>(mod_r))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast  effect.size   SE df lower.CL upper.CL
 CON - TRT       0.756 1.01  3    -2.46     3.98

sigma used for effect sizes: 2.646 
Confidence level used: 0.95 </code></pre>
</div>
</div>
<p><span class="math inline">\(MS_W\)</span> = Error in ANOVA-Model: <code>y ~ g</code> w/o covariate or <span class="math inline">\((SS_g + SS_{\text{error}})/(df_g + df_{\text{error}})\)</span> from ANCOVA-Model.</p>
</section>
<section id="sample-size-estimate" class="level2" data-number="25.7">
<h2 data-number="25.7" class="anchored" data-anchor-id="sample-size-estimate"><span class="header-section-number">25.7</span> sample size estimate</h2>
<p><span class="math display">\[\begin{align*}
\sigma_{\epsilon(\text{ANCOVA})}^2 &amp;= \sigma_{\epsilon(\text{CRD})}^2(1-\rho_{xy}^2) \\
f_{\text{ANCOVA}} &amp;= \frac{\sigma_{\text{btw}}}{\sigma_{\epsilon(\text{CRD})}}\frac{1}{\sqrt{1-\rho_{xy}^2}} = \frac{f_{\text{CRD}}}{\sqrt{1-\rho_{xy}^2}}
\end{align*}\]</span></p>
<p><span class="math inline">\(df_{\text{Residual}} = N - k - 1\)</span> under the ANCOVA model</p>
</section>
<section id="sample-size-beispiel" class="level2" data-number="25.8">
<h2 data-number="25.8" class="anchored" data-anchor-id="sample-size-beispiel"><span class="header-section-number">25.8</span> sample size Beispiel<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></h2>
<p>In einer CRD-Studie wurde eine Effektstärke für den Unterschied zwischen drei Gruppen (<span class="math inline">\(k = 3\)</span>) von <span class="math inline">\(f = 0.41\)</span> gefunden. Wie verändert sich die notwendige Stichprobengröße wenn eine Kovariate mit <span class="math inline">\(\rho = 0.5\)</span> mit der abhängigen Variable hinzugenommen wird?</p>
</section>
<section id="sample-size-example" class="level2" data-number="25.9">
<h2 data-number="25.9" class="anchored" data-anchor-id="sample-size-example"><span class="header-section-number">25.9</span> sample size example</h2>
<p>Bei einer power von <span class="math inline">\(0.8\)</span> wird eine Stichprobengröße von:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>pwr<span class="sc">::</span><span class="fu">pwr.anova.test</span>(<span class="at">k=</span><span class="dv">3</span>, <span class="at">f=</span><span class="fl">0.41</span>, <span class="at">sig.level=</span><span class="fl">0.05</span>, <span class="at">power=</span><span class="fl">0.8</span>)<span class="sc">$</span>n</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20.13803</code></pre>
</div>
</div>
<p>Wenn die Kovariate modelliert wird, erhöht sich die Effektstärke auf <span class="math inline">\(f = 0.41/\sqrt{1-0.5^2} = 0.47\)</span>. Daraus resultiert eine reduzierte Stichprobengröße von:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>pwr<span class="sc">::</span><span class="fu">pwr.anova.test</span>(<span class="at">k=</span><span class="dv">2</span>, <span class="at">f=</span><span class="fl">0.47</span>, <span class="at">sig.level=</span><span class="fl">0.05</span>, <span class="at">power=</span><span class="fl">0.8</span>)<span class="sc">$</span>n</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 18.77618</code></pre>
</div>
</div>
</section>
<section id="was-passiert-wenn-die-kovariate-interagiert" class="level2" data-number="25.10">
<h2 data-number="25.10" class="anchored" data-anchor-id="was-passiert-wenn-die-kovariate-interagiert"><span class="header-section-number">25.10</span> Was passiert wenn die Kovariate interagiert</h2>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ed_ancova_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Beispiel für einen Interaktionseffekt zwischen der Treatmentvariablen und der Kovariate</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="modell" class="level2" data-number="25.11">
<h2 data-number="25.11" class="anchored" data-anchor-id="modell"><span class="header-section-number">25.11</span> Modell</h2>
<p><span class="math display">\[
y_{it} = \beta_0 + \tau_i + \beta \cdot x_{it} + (\tau\beta)_{it}x_{it} + \epsilon_{it}
\]</span></p>
</section>
<section id="welcher-unterschied-zwischen-den-gruppen" class="level2" data-number="25.12">
<h2 data-number="25.12" class="anchored" data-anchor-id="welcher-unterschied-zwischen-den-gruppen"><span class="header-section-number">25.12</span> Welcher Unterschied zwischen den Gruppen?</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ed_ancova_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="modellfit---interaktionsmodell" class="level2" data-number="25.13">
<h2 data-number="25.13" class="anchored" data-anchor-id="modellfit---interaktionsmodell"><span class="header-section-number">25.13</span> Modellfit - Interaktionsmodell</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">aov</span>(y <span class="sc">~</span> x<span class="sc">*</span>gruppe, df_i)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Anova-Tabelle für Interaktionsmodell</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">SSQ</th>
<th style="text-align: right;">MSQ</th>
<th style="text-align: right;">F</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">x</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1321.60</td>
<td style="text-align: right;">1321.60</td>
<td style="text-align: right;">1847.21</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">gruppe</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">151.11</td>
<td style="text-align: right;">75.56</td>
<td style="text-align: right;">105.61</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">x:gruppe</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">78.76</td>
<td style="text-align: right;">39.38</td>
<td style="text-align: right;">55.04</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Residuals</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">38.63</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="mehrfachvergleiche---ems-mittelwerte" class="level2" data-number="25.14">
<h2 data-number="25.14" class="anchored" data-anchor-id="mehrfachvergleiche---ems-mittelwerte"><span class="header-section-number">25.14</span> Mehrfachvergleiche - EMS Mittelwerte</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>mod_ems <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(mod, <span class="sc">~</span>gruppe<span class="sc">|</span>x, <span class="at">at=</span><span class="fu">list</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">2</span>)))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>mod_ems</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x = -2:
 gruppe emmean    SE df lower.CL upper.CL
 A      -3.286 0.373 54   -4.033    -2.54
 B      -3.101 0.335 54   -3.773    -2.43
 C      -2.725 0.256 54   -3.238    -2.21

x =  0:
 gruppe emmean    SE df lower.CL upper.CL
 A       0.934 0.208 54    0.517     1.35
 B       2.958 0.185 54    2.587     3.33
 C       5.303 0.201 54    4.900     5.71

x =  2:
 gruppe emmean    SE df lower.CL upper.CL
 A       5.155 0.315 54    4.524     5.79
 B       9.016 0.248 54    8.519     9.51
 C      13.331 0.361 54   12.607    14.05

Confidence level used: 0.95 </code></pre>
</div>
</div>
</section>
<section id="mehrfachvergleiche---paarweise-vergleiche" class="level2" data-number="25.15">
<h2 data-number="25.15" class="anchored" data-anchor-id="mehrfachvergleiche---paarweise-vergleiche"><span class="header-section-number">25.15</span> Mehrfachvergleiche - Paarweise Vergleiche</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(mod_ems)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Paarvergleiche</caption>
<thead>
<tr class="header">
<th style="text-align: right;">x</th>
<th style="text-align: left;">contrast</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;"><span class="math inline">\(s_e\)</span></th>
<th style="text-align: right;"><span class="math inline">\(df\)</span></th>
<th style="text-align: right;">t</th>
<th style="text-align: right;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">-2</td>
<td style="text-align: left;">A - B</td>
<td style="text-align: right;">-0.18</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">-0.37</td>
<td style="text-align: right;">0.93</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2</td>
<td style="text-align: left;">A - C</td>
<td style="text-align: right;">-0.56</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">-1.24</td>
<td style="text-align: right;">0.43</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-2</td>
<td style="text-align: left;">B - C</td>
<td style="text-align: right;">-0.38</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">-0.89</td>
<td style="text-align: right;">0.65</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: left;">A - B</td>
<td style="text-align: right;">-2.02</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">-7.26</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: left;">A - C</td>
<td style="text-align: right;">-4.37</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">-15.10</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: left;">B - C</td>
<td style="text-align: right;">-2.35</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">-8.59</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: left;">A - B</td>
<td style="text-align: right;">-3.86</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">-9.64</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">A - C</td>
<td style="text-align: right;">-8.18</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">-17.07</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: left;">B - C</td>
<td style="text-align: right;">-4.31</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">-9.85</td>
<td style="text-align: right;">0.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="beispiel-aus-maxwell2004-p.429" class="level2" data-number="25.16">
<h2 data-number="25.16" class="anchored" data-anchor-id="beispiel-aus-maxwell2004-p.429"><span class="header-section-number">25.16</span> Beispiel aus <span class="citation" data-cites="maxwell2004">(<a href="references.html#ref-maxwell2004" role="doc-biblioref">Maxwell, Delaney, und Kelley 2004, p.429</a>)</span></h2>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ed_ancova_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Depression Beispiel aus Maxwell et al.&nbsp;(2004, p.429)</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="analyse" class="level2" data-number="25.17">
<h2 data-number="25.17" class="anchored" data-anchor-id="analyse"><span class="header-section-number">25.17</span> Analyse</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>mod_bdi <span class="ot">&lt;-</span> <span class="fu">lm</span>(Post <span class="sc">~</span> Pre <span class="sc">+</span> Condition, bdi_w)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_bdi) <span class="sc">|&gt;</span> broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">booktabs =</span> T, <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">sumsq</th>
<th style="text-align: right;">meansq</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Pre</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">336.682</td>
<td style="text-align: right;">336.682</td>
<td style="text-align: right;">11.574</td>
<td style="text-align: right;">0.002</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">217.149</td>
<td style="text-align: right;">108.575</td>
<td style="text-align: right;">3.732</td>
<td style="text-align: right;">0.038</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residuals</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">756.335</td>
<td style="text-align: right;">29.090</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="gruppenvergleiche" class="level2" data-number="25.18">
<h2 data-number="25.18" class="anchored" data-anchor-id="gruppenvergleiche"><span class="header-section-number">25.18</span> Gruppenvergleiche</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>bdi_em <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(mod_bdi, <span class="sc">~</span>Condition)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(bdi_em, <span class="at">infer=</span>T)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast            estimate   SE df lower.CL upper.CL t.ratio p.value
 SSRI - Placebo         -4.45 2.42 26   -10.45    1.555  -1.841  0.1763
 SSRI - Wait list       -6.44 2.41 26   -12.44   -0.445  -2.669  0.0334
 Placebo - Wait list    -1.99 2.41 26    -7.99    4.002  -0.826  0.6904

Confidence level used: 0.95 
Conf-level adjustment: tukey method for comparing a family of 3 estimates 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
</div>
<ul>
<li>Unterscheidung zwischen
<ul>
<li>Kovariate für das Untersuchungsdesign</li>
<li>Kovariate für die Analyse der Daten</li>
</ul></li>
</ul>
</section>
<section id="zum-nachlesen" class="level2" data-number="25.19">
<h2 data-number="25.19" class="anchored" data-anchor-id="zum-nachlesen"><span class="header-section-number">25.19</span> Zum Nachlesen</h2>
<section id="allgemein" class="level3" data-number="25.19.1">
<h3 data-number="25.19.1" class="anchored" data-anchor-id="allgemein"><span class="header-section-number">25.19.1</span> Allgemein</h3>
<p><span class="citation" data-cites="maxwell2004">(<a href="references.html#ref-maxwell2004" role="doc-biblioref">Maxwell, Delaney, und Kelley 2004, p.451–467</a>)</span></p>
</section>
<section id="pre-post-ancova" class="level3" data-number="25.19.2">
<h3 data-number="25.19.2" class="anchored" data-anchor-id="pre-post-ancova"><span class="header-section-number">25.19.2</span> Pre-post ANCOVA</h3>
<p><span class="citation" data-cites="wan2021">Wan (<a href="references.html#ref-wan2021" role="doc-biblioref">2021</a>)</span></p>
</section>
<section id="regression-to-the-mean" class="level3" data-number="25.19.3">
<h3 data-number="25.19.3" class="anchored" data-anchor-id="regression-to-the-mean"><span class="header-section-number">25.19.3</span> Regression to the mean</h3>
<p><span class="citation" data-cites="shephard2003">Shephard (<a href="references.html#ref-shephard2003" role="doc-biblioref">2003</a>)</span>, <span class="citation" data-cites="barnett2005">Barnett, Pols, und Dobson (<a href="references.html#ref-barnett2005" role="doc-biblioref">2005</a>)</span>, <span class="citation" data-cites="nevill2004">Nevill u.&nbsp;a. (<a href="references.html#ref-nevill2004" role="doc-biblioref">2004</a>)</span></p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-barnett2005" class="csl-entry" role="listitem">
Barnett, A. G., J. C. van der Pols, und A. J. Dobson. 2005. <span>„Regression to the mean: what it is and how to deal with it“</span>. <em>Int J Epidemiol</em> 34 (1): 215–20. <a href="https://doi.org/10.1093/ije/dyh299">https://doi.org/10.1093/ije/dyh299</a>.
</div>
<div id="ref-fien2019" class="csl-entry" role="listitem">
Fien, Samantha, Tim Henwood, Mike Climstein, Evelyne Rathbone, und Justin WL Keogh. 2019. <span>„Exploring the feasibility, sustainability and the benefits of the GrACE+ GAIT exercise programme in the residential aged care setting“</span>. <em>PeerJ</em> 7: e6973.
</div>
<div id="ref-maxwell2004" class="csl-entry" role="listitem">
Maxwell, Scott E, Harold D Delaney, und Ken Kelley. 2004. <em>Designing experiments and analyzing data: A model comparison perspective</em>. 2. Aufl. Routledge.
</div>
<div id="ref-nevill2004" class="csl-entry" role="listitem">
Nevill, Alan, Roger Holder, Greg Atkinson, und John Copas. 2004. <span>„The danger of reporting spurious regression to the mean“</span>. Journal Article. <em>Journal of Sport Sciences</em> 22: 800–802. <a href="https://D:\sciebo\database\463.pdf">D:\sciebo\database\463.pdf</a>.
</div>
<div id="ref-shephard2003" class="csl-entry" role="listitem">
Shephard, Roy J. 2003. <span>„Regression to the mean“</span>. <em>Sports medicine</em> 33 (8): 575–84.
</div>
<div id="ref-wan2021" class="csl-entry" role="listitem">
Wan, Fei. 2021. <span>„Statistical analysis of two arm randomized pre-post designs with one post-treatment measurement“</span>. <em>BMC medical research methodology</em> 21 (1): 1–16.
</div>
</div>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Bei <span class="math inline">\(\hat{\omega}^2 &lt; 0\)</span> wird auf <span class="math inline">\(0\)</span> gekappt.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>nach <span class="citation" data-cites="maxwell2004">Maxwell, Delaney, und Kelley (<a href="references.html#ref-maxwell2004" role="doc-biblioref">2004</a>)</span><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ed_crfd.html" class="pagination-link" aria-label="Completely Randomized Factorial Design">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Completely Randomized Factorial Design</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ed_crbd.html" class="pagination-link" aria-label="Completely Randomized Block Design">
        <span class="nav-page-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Completely Randomized Block Design</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>