<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Skriptum - Fortgeschrittene Statistik - 25&nbsp; ANCOVA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ed_crbd.html" rel="next">
<link href="./ed_crfd.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>
<script>
  MathJax = {
    tex: {
      tags: 'ams'  // should be 'ams', 'none', or 'all'
    }
  };
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ed_title.html">Experimentelles Design</a></li><li class="breadcrumb-item"><a href="./ed_ancova.html"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">ANCOVA</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Skriptum - Fortgeschrittene Statistik</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vorwort</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./r_startup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Eine Einführung in die Programmiersprache R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Eine Übersicht über <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_vars_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Variablen und Datentypen in <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_flowcontrol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Ablaufkontrolle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Eigene Funktionen in <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Datenverarbeitung mit <code>tidyverse</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Datenvisualisierung mit <code>ggplot2</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_literate_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Literate programming in <code>R</code></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stats_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistik - Die Grundlagen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Eine kleine Welt der Unsicherheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_significance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Statistische Signifikanz, p-Wert und Power</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Parameterschätzung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Theoretische Verteilungen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_hypotheses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Hypothesen testen</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./slm_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Das einfache Regressionmodell</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Einführung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Inferenz</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_model_fit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Modellfit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Vorhersage</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./mlm_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Einführung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_interactions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Interaktionseffekte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_dummy_coding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Integration von nominalen Variablen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_hierarchies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Modellhierarchien</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ed_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelles Design</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Einführung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_crd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Completely Randomized Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_linear_contrasts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Lineare Kontraste</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_crfd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Completely Randomized Factorial Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_ancova.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_crbd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Completely Randomized Block Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_split_plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Split-plot Design</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literatur</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#das-modell" id="toc-das-modell" class="nav-link active" data-scroll-target="#das-modell"><span class="header-section-number">25.1</span> Das Modell</a></li>
  <li><a href="#analyse-einer-ancova-in-r" id="toc-analyse-einer-ancova-in-r" class="nav-link" data-scroll-target="#analyse-einer-ancova-in-r"><span class="header-section-number">25.2</span> Analyse einer ANCOVA in <code>R</code></a></li>
  <li><a href="#effektstärke-bei-der-ancova" id="toc-effektstärke-bei-der-ancova" class="nav-link" data-scroll-target="#effektstärke-bei-der-ancova"><span class="header-section-number">25.3</span> Effektstärke bei der ANCOVA</a></li>
  <li><a href="#mehrfachvergleiche-bei-der-ancova" id="toc-mehrfachvergleiche-bei-der-ancova" class="nav-link" data-scroll-target="#mehrfachvergleiche-bei-der-ancova"><span class="header-section-number">25.4</span> Mehrfachvergleiche bei der ANCOVA</a></li>
  <li><a href="#mehrfachvergleiche-in-r" id="toc-mehrfachvergleiche-in-r" class="nav-link" data-scroll-target="#mehrfachvergleiche-in-r"><span class="header-section-number">25.5</span> Mehrfachvergleiche in <code>R</code></a>
  <ul class="collapse">
  <li><a href="#effektstärken-für-paarweise-vergleiche" id="toc-effektstärken-für-paarweise-vergleiche" class="nav-link" data-scroll-target="#effektstärken-für-paarweise-vergleiche"><span class="header-section-number">25.5.1</span> Effektstärken für paarweise Vergleiche</a></li>
  </ul></li>
  <li><a href="#bestimmung-der-anzahl-der-replikationen" id="toc-bestimmung-der-anzahl-der-replikationen" class="nav-link" data-scroll-target="#bestimmung-der-anzahl-der-replikationen"><span class="header-section-number">25.6</span> Bestimmung der Anzahl der Replikationen</a></li>
  <li><a href="#ancova-mit-interaktionseffekt" id="toc-ancova-mit-interaktionseffekt" class="nav-link" data-scroll-target="#ancova-mit-interaktionseffekt"><span class="header-section-number">25.7</span> ANCOVA mit Interaktionseffekt</a></li>
  <li><a href="#zusammenfassung" id="toc-zusammenfassung" class="nav-link" data-scroll-target="#zusammenfassung"><span class="header-section-number">25.8</span> Zusammenfassung</a></li>
  <li><a href="#zum-nach--und-weiterlesen" id="toc-zum-nach--und-weiterlesen" class="nav-link" data-scroll-target="#zum-nach--und-weiterlesen"><span class="header-section-number">25.9</span> Zum Nach- und Weiterlesen</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ed_title.html">Experimentelles Design</a></li><li class="breadcrumb-item"><a href="./ed_ancova.html"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">ANCOVA</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">ANCOVA</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In den vorhergehenden Kapiteln zu CRD bzw. CRFD haben wir uns angeschaut, wie wir den Einfluss einer oder mehrerer nominaler, unabhängiger Variablen auf eine abhängige Variable modellieren können. In diesem Zusammenhang haben wir uns auch mit der Varianzzerlegung auseinandergesetzt und immer wieder gesehen, dass diese Zerlegung auch als der Vergleich von verschiedenen Modellen miteinander betrachtet werden kann. Im Rahmen der ANCOVA führen wir jetzt wieder eine kontinuierliche Variable in unser Modell ein, wie wir das schon im Rahmen der multiplen linearen Regression getan haben. Diese zusätzliche, kontinuierliche Variable spielt dabei die Rolle einer Kontrollvariablen. Mit Hilfe dieser Kontrollvariable soll ebenfalls Varianz von <span class="math inline">\(Y\)</span> erklärt werden. Der Effekt der Kontrollvariablen auf <span class="math inline">\(Y\)</span> ist allerdings nicht das Primärinteresse der Untersuchung sondern dient nur die Präzision des Modells zu erhöhen. Letztendlich führt dies dazu, dass auch die Power der Untersuchung erhöht wird.</p>
<p>Ein Beispiel könnte eine Untersuchung zu Trainingseffekten sein. Aus der Literatur wissen wir bereits, das das Alter der Teilnehmerinnen und Teilnehmer eine Rolle auf den Trainingseffekt hat. Daher macht es Sinn für den Effekt des Alters im Rahmen der Modells zu kontrollieren. Das primäre Interessiere der Untersuchung liegt auf dem Effekt des Trainings. Die Variable Alter wird in diesem Fall als Kovariate bezeichnet, wodurch sich auch die Namensgebung ANCOVA als Abkürzung für Analysis of Covariance herleitet. Welche Variablen die Rolle der primären Variablen und der Kovariaten spielen ist dabei von der konkreten Untersuchung abhängig. Es kann genauso vorkommen, dass eine nominale Variable die Rolle der Kovariaten spielt und eine kontinuierliche Variable die Primärvariable der Untersuchung ist.</p>
<p>Konzeptionell wird durch die Integration einer Kovariaten Information über Unterschiede zwischen den beiden Gruppen die vor der Beobachtungsphase bestehen in das Modell mit einbezogen. D.h. trotzdem wir die Beobachtungseinheiten randomisiert in beispielsweise zwei Gruppen unterteilt haben, wissen wir, das das Alter einen Effekt auf die abhängige Variable hat. Bei einer perfekten, randomisierten Zuweisung sollte das Alter eigentlich keinen mehr Einfluss haben, da beide Gruppen die gleiche Altersstruktur haben sollten. Trotzdem sind wir in der Lage die Einbeziehung zusätzliche Varianz aufzuklären und können so den Effekt der Primärvariablen hoffentlich besser isolieren. Oft kann zum Beispiel der Startwert der abhängigen Variable als Kovariate verwendet werden. Die Kovariate ist dann auf der gleichen Skala wie die Zielvariable.</p>
<div id="exm-ancova-01" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 25.1</strong></span> In <span class="citation" data-cites="fien2019">Fien u.&nbsp;a. (<a href="references.html#ref-fien2019" role="doc-biblioref">2019</a>)</span> wurde unter anderem der Einfluss einer Trainingsintervention auf die Gehgeschwindigkeit in einem zweiarmigen Untersuchungsdesign untersucht. Als Zielvariable wurde die Gehgeschwindigkeit nach der Interventionsphase verwendet. Um die bestehenden Unterschiede zwischen den Teilnehmerinnen und Teilnehmer vor der Untersuchung mit einzubeziehen, wurde die Gehgeschwindigkeit vor der Intervention als Kovariate verwendet.</p>
</div>
<div id="def-covariate" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 25.1 (Kovariate)</strong></span> Eine Kovariate ist eine Variable, die verwendet wird, um den Einfluss auf die abhängige Variable zu kontrollieren um genauere Schätzungen der Beziehungen zwischen den primären unabhängigen Variablen und der abhängigen Variable zu erhalten.</p>
<p>Alternativ werden in der Literatur auch die Begriffe Störvariable (engl. nuisance factor) oder concomitant variable (engl.) verwendet. Wenn die Kovariate auf der gleichen Skala wie die Primärvariable ist, wird sie auch als commensurate (engl.) bezeichnet.</p>
</div>
<p>Beginnen wir mit einem einfachen konzeptionellen Modell (siehe <a href="#fig-ed-ancova-01" class="quarto-xref">Abbildung&nbsp;<span>25.1</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ed-ancova-01" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ed-ancova-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_ancova_files/figure-html/fig-ed-ancova-01-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ed-ancova-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;25.1: Zusammenhang einer abhängigen Variable mit einer Kovariate und einer nominalen Variable (treatment)
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-ed-ancova-01" class="quarto-xref">Abbildung&nbsp;<span>25.1</span></a> zeigt den Zusammenhang zwischen zwei Gruppen <span class="math inline">\(A\)</span> und <span class="math inline">\(B\)</span> und einer abhängigen Variablen DV sowie den Zusammenhang einer Kovariate (<span class="math inline">\(x\)</span>-Achse) mit DV. Zwischen der Kovariaten und der DV besteht ein positiver Zusammenhang und der Effekt von Treatment <span class="math inline">\(A\)</span> ist kleiner als derjenige von Treatment <span class="math inline">\(B\)</span>. Der Effekt der Kovariaten ist dabei in beiden Gruppen gleich und es besteht keine Interaktion zwischen der Kovariaten und den Gruppen. Dies führt dazu, dass die beiden Geraden parallel zueinander sind. Letztendlich haben wir dieses Modell schon bei der Besprechung der Intergration von nominalen Variablen in das multiple Regressionsmodell behandelt.</p>
<p>Wenn wir die beiden Gruppen miteinander vergleichen sind mehrere unterschiedliche Vergleiche möglich. Nehmen wir zum Beispiel einen Datenpunkt <span class="math inline">\(P1\)</span> aus Gruppe <span class="math inline">\(A\)</span>. Dann können wir den <span class="math inline">\(P1\)</span> mit mehreren verschiedenen Datenpunkten aus Gruppe <span class="math inline">\(B\)</span> vergleichen. In <a href="#fig-ed-ancova-02" class="quarto-xref">Abbildung&nbsp;<span>25.2</span></a> sind drei mögliche Vergleiche eingezeichnet.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ed-ancova-02" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ed-ancova-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_ancova_files/figure-html/fig-ed-ancova-02-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ed-ancova-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;25.2: Verschiedene Vergleiche der beiden Gruppen miteinander
</figcaption>
</figure>
</div>
</div>
</div>
<p>Letztendlich erscheint aber nur einer der Vergleiche sinnvoll, nämlich der Vergleich wenn die beiden Gruppenwerte den gleichen Wert in der Kovariate haben. Wäre zum Beispiel die Kovariate das Alter, dann würde ein Vergleich von zwei Personen die sich im Alter unterscheiden wenig sinnvoll da nicht klar ist ob ein beobachteter Unterschied zwischen den beiden Personen in der abhängigen Variable auf den Unterschied im Alter oder auf den Unterschied im Treatment zurück zu führen ist. Genau dieses Problem wird mit Hilfe der ANCOVA gelöst. Die ANCOVA liefert daher eine Antwort auf die Frage:</p>
<p><em>Wie unterschieden sich die Gruppen voneinander, wenn sie die gleichen Werte in der Kovariate hätten?</em></p>
<p>Schauen wir uns ein weiteres Beispiel an. In <a href="#fig-ed-ancova-03" class="quarto-xref">Abbildung&nbsp;<span>25.3</span></a> sind diesmal Datenpunkte eingezeichnet und scheinbar ist bei der Zuweisung der Teilnehmerinnen und Teilnehmer etwas grundsätzlich schief gelaufen.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ed-ancova-03" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ed-ancova-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_ancova_files/figure-html/fig-ed-ancova-03-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ed-ancova-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;25.3: Probleme durch die Kovariate
</figcaption>
</figure>
</div>
</div>
</div>
<p>Die Personen in Gruppe <span class="math inline">\(B\)</span> haben alle einen kleineren Wert in der Kovariate als die Personen in Gruppe <span class="math inline">\(A\)</span>. Gleichzeitig hat die Kovariate aber einen positiven Einfluss auf die DV. Hätte wir keine Information über die Kovariate und würden die beiden Gruppenmittelwerte miteinander vergleichen, dann würden wir wahrscheinlich keinen Unterschied zwischen den beiden Gruppen finden (siehe <a href="#fig-ed-ancova-04" class="quarto-xref">Abbildung&nbsp;<span>25.4</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ed-ancova-04" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ed-ancova-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_ancova_files/figure-html/fig-ed-ancova-04-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ed-ancova-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;25.4: Mittelwerte der Gruppen (schwarze Punkte) mit unterschiedlichen Kovariaten
</figcaption>
</figure>
</div>
</div>
</div>
<p>Um die beiden Gruppen miteinander vergleichen zu können, müssen wir die Unterschiede in den Mittelwerten der Kovariaten korrigieren um die Gruppen miteinander vergleichbar zu machen. D.h. wie würden die Unterschied aussehen, wenn beide Gruppen die gleiche Verteilung in der Kovariaten hätten.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ed-ancova-05" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ed-ancova-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_ancova_files/figure-html/fig-ed-ancova-05-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ed-ancova-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;25.5: Vergleich der Gruppen bei koorigierten Kovariaten
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-ed-ancova-05" class="quarto-xref">Abbildung&nbsp;<span>25.5</span></a> sind die eigentlich sinnvollen Vergleiche angezeigt. Dabei wird auch noch einmal klar, dass in diesem Modell sobald wir für die Werte der Kovariaten kontrolliert haben, die Position des Vergleichs unerheblich ist, da wir von einem Modell ausgehen, bei dem der Effekt der Kovariaten in beiden Gruppen gleich ist. Dies führt zu den parallelen Linien.</p>
<section id="das-modell" class="level2" data-number="25.1">
<h2 data-number="25.1" class="anchored" data-anchor-id="das-modell"><span class="header-section-number">25.1</span> Das Modell</h2>
<p>Übertragen wir die Beispiele nun wieder in eine Modellformulierung. Letztendlich können wir, wie bereits angemerkt, das uns schon bekannte Modell aus der multiple linearen Regression anwenden.</p>
<p><span class="math display">\[\begin{equation}
Y_{it} = \mu + \tau_i + \beta x_{it} + \epsilon_{it} \quad \epsilon_{it} \sim \mathcal{N}(0,\sigma^2), i = 1,\ldots,K
\label{eq-ed-ancova-model}
\end{equation}\]</span></p>
<p>In Model <span class="math inline">\(\eqref{eq-ed-ancova-model}\)</span> kommt dementsprechend nichts Neues dazu, sondern unser bekanntes lineares Modell. Der einzige Unterschied besteht in der Terminologie, während wir vorher <span class="math inline">\(\alpha_i\)</span> für die nominale Variable verwendet haben, wird der nominale Faktor im ANCOVA-Modell <span class="math inline">\(\tau_i\)</span> bezeichnet. Das sind aber nur Unterschiede in den Buchstaben die leider auch in der Literatur unterschiedlich verwendet werden.</p>
<p>Um die spätere Interpretation der Koeffizienten zu vereinfachen, wird auch oft ein in der Kovariaten zentriertes Modell verwendet. Dies hat jedoch keine Auswirkung auf das Ergebnis. Von den Werten der Kovariate wird dazu der Gesamtmittelwert <span class="math inline">\(\bar{x}_{..}\)</span> der Kovariatenwerten abgezogen.</p>
<p><span class="math display">\[\begin{equation}
Y_{it} = \mu + \tau_i + \beta (x_{it} - \bar{x}_{..}) + \epsilon_{it}
\label{eq-ed-ancova-model-c}
\end{equation}\]</span></p>
<p>Ein interessante Interpretation der ANCOVA erhalten wir, wenn wir in Formel <span class="math inline">\(\eqref{eq-ed-ancova-model-c}\)</span> auf beiden Seiten <span class="math inline">\(\mu + \tau_i\)</span> abziehen (siehe <span class="citation" data-cites="casella2008">(<a href="references.html#ref-casella2008" role="doc-biblioref">Casella 2009, p.65</a>)</span>).</p>
<p><span class="math display">\[\begin{equation*}
Y_{it} - \beta (x_{it} - \bar{x}_{..}) = \mu + \tau_i + \epsilon_{it}
\end{equation*}\]</span></p>
<p>Auf der linken Seite stehen die Residuen einer einfachen Regression, die Differenz der beobachteten Werte <span class="math inline">\(Y_{it}\)</span> von denen mittels der Regression auf die Kovariate vorhergesagten Werten <span class="math inline">\(\beta (x_{it} - \bar{x}_{..}\)</span>. Auf der rechten Seite haben wir das Modell der CRD. D.h. durch die ANCOVA werden die beobachteten Werte <span class="math inline">\(Y_{it}\)</span> korrigiert und dadurch deren Varianz reduziert.</p>
<p>Da es sich bei der ANCOVA aber insgesamt wieder nur um eine Variante des linearen Modell handelt, ergeben sich entsprechend auch keine unbekannten Voraussetzungen:</p>
<ul>
<li>Experimental units sind randomisiert den <span class="math inline">\(K\)</span> Gruppen zugewiesen worden</li>
<li>Varianz <span class="math inline">\(\sigma^2\)</span> ist konstant über Gruppen und Werte der Kovariate</li>
<li>Die Kovariate und das Treatment sind statistisch unabhängig voneinander</li>
</ul>
<p>Der letzte Punkte, die Unabhängigkeit zwischen dem Treatment und der Kovariate ist wichtig. Dies bedeutet, dass der Einfluss der Kovariaten sind nicht im Zusammenhang mit dem Treatment verändert. Der der ANCOVA zugrundeliegende Test beruht dann wie immer auf einen Modellvergleich eines vollen Modell (Model <span class="math inline">\(\eqref{eq-ed-ancova-model}\)</span>) mit einem reduzierten Modell. Das reduzierte Modell beinhaltet dann nur die Kovariate, da wir den Unterschied in Bezug auf den Effekt der Primärvariable überprüfen wollen.</p>
<p><span class="math display">\[\begin{align*}
y_{ij} &amp;= \mu + \tau_{j} + \beta X_{ij} + \epsilon_{ij} \quad \text{full} \\
y_{ij} &amp;= \mu + \beta X_{ij} + \epsilon_{ij} \quad \text{reduced}
\end{align*}\]</span></p>
<p>Die <span class="math inline">\(H_0\)</span> für den Treatmenteffekt ist:</p>
<p><span class="math display">\[\begin{equation*}
H_0: \tau_1 = \tau_2 = \cdots = tau_K = 0
\end{equation*}\]</span></p>
<p>Der Unterschied zwischen den Treatmentstufen wird dabei für den Wert <span class="math inline">\(\bar{x}_{..}\)</span>, als den Mittelwert der Kovariate über alle Gruppenhinweg bestimmt.</p>
<p>Die <span class="math inline">\(H_0\)</span> für die Kovariate ist:</p>
<p><span class="math display">\[\begin{equation*}
H_0: \beta = 0
\end{equation*}\]</span></p>
<p>Das Ergebnis der Analyse wird oft auch in Form einer Varianz-Tabelle dargestellt (siehe <a href="#tbl-ed-ancova-ssq" class="quarto-xref">Tabelle&nbsp;<span>25.1</span></a>).</p>
<div id="tbl-ed-ancova-ssq" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ed-ancova-ssq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;25.1: Varianztabelle der ANCOVA
</figcaption>
<div aria-describedby="tbl-ed-ancova-ssq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Term</th>
<th><span class="math inline">\(df\)</span></th>
<th><span class="math inline">\(SSQ\)</span></th>
<th><span class="math inline">\(MSQ\)</span></th>
<th>F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(T|\beta\)</span></td>
<td><span class="math inline">\(K-1\)</span></td>
<td><span class="math inline">\(ss(T|\beta)\)</span></td>
<td><span class="math inline">\(\frac{ss(T|\beta)}{K-1}\)</span></td>
<td><span class="math inline">\(\frac{ms(T|\beta)}{msE}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\beta|T\)</span></td>
<td><span class="math inline">\(1\)</span></td>
<td><span class="math inline">\(ss(\beta|T)\)</span></td>
<td><span class="math inline">\(\frac{ss(\beta|T)}{1}\)</span></td>
<td><span class="math inline">\(\frac{ms(\beta|T)}{msE}\)</span></td>
</tr>
<tr class="odd">
<td>Error</td>
<td><span class="math inline">\(N-K-1\)</span></td>
<td><span class="math inline">\(ssE\)</span></td>
<td><span class="math inline">\(msE\)</span></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Die Schreibweise <span class="math inline">\(T|\beta\)</span> bezeichnet den Effekt des Treatments nachdem für die Kovariate kontrolliert wurde während <span class="math inline">\(\beta|T\)</span> den Effekt der Kovariate nachdem für das Treatment kontrolliert wurde beschreibt. Hier tritt eine Besonderheit auf, die Summe der Quadratsummen addiert sich nicht zur totalen Varianz von <span class="math inline">\(Y\)</span>. Dies kommt dadurch zustande das die Quadratsummen nicht der Hierarchie folgend vom einfachsten zum vollen Modell gebildet werden, sondern Vergleiche zwischen dem vollen Modell und jeweils einem Modell bei dem die andere Variable bereits vorhanden ist durchgeführt werden. Diese Quadratsummen werden als korrigierte Quadratsummen (adjusted sums of squares) <span class="citation" data-cites="christensen2018">(<a href="references.html#ref-christensen2018" role="doc-biblioref">Christensen 2018, p.362</a>)</span> oder auch Type-II Quadratsummen bezeichnet. Dadurch verlieren die Quadratsummen ihre additive Eigenschaft. Im Spezialfall wenn beide Gruppen den gleichen Mittelwert in der Kovariaten <span class="math inline">\(X\)</span> haben, sind die Quadratsummen dann doch wieder additive. Die beiden Effekt Treatment und Kovariate sind dann orthogonal zueinander.</p>
<p>Schauen wir uns die Analyse in einem Spielzeugbeispiel an. In <a href="#tbl-ed-ancova-max-01" class="quarto-xref">Tabelle&nbsp;<span>25.2</span></a> ist ein Beispieldatensatz aus <span class="citation" data-cites="maxwell2004">Maxwell, Delaney, und Kelley (<a href="references.html#ref-maxwell2004" role="doc-biblioref">2004</a>)</span> abgebildet.</p>
<div class="cell">
<div id="tbl-ed-ancova-max-01" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ed-ancova-max-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;25.2: Ein einfacher ANCOVA-Datensatz
</figcaption>
<div aria-describedby="tbl-ed-ancova-max-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<caption>Beispieldaten</caption>
<thead>
<tr class="header">
<th style="text-align: left;">ID</th>
<th style="text-align: left;">Gruppe</th>
<th style="text-align: right;">x</th>
<th style="text-align: right;">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">S1</td>
<td style="text-align: left;">TRT</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">S2</td>
<td style="text-align: left;">TRT</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">S3</td>
<td style="text-align: left;">TRT</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">S4</td>
<td style="text-align: left;">CON</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">S5</td>
<td style="text-align: left;">CON</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">S6</td>
<td style="text-align: left;">CON</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">16</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Wir haben zwei Gruppen (TRT und CON) mit jeweils <span class="math inline">\(N = 3\)</span> mit einer Kovariate <span class="math inline">\(x\)</span>.</p>
<p>Ein Vergleich des vollen und des reduzierten Modells führt zu folgendem Ergebnis:</p>
<div class="cell">
<div id="tbl-ed-ancova-toy-1" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ed-ancova-toy-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;25.3: Vergleich full vs.&nbsp;reduced model.
</figcaption>
<div aria-describedby="tbl-ed-ancova-toy-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">rss</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">sumsq</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">y ~ x</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">14.4</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">y ~ x + group</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">12.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">0.6</td>
<td style="text-align: right;">0.495</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Wie wir <a href="#tbl-ed-ancova-toy-1" class="quarto-xref">Tabelle&nbsp;<span>25.3</span></a> sehen können finden wir keinen statistisch signifikanten Effekt für das Treatment nachdem wir für die Kovariate <span class="math inline">\(X\)</span> kontrolliert haben. Dargestellt als Varianztabelle erhalten wir die folgende Dokumentation (siehe <a href="#tbl-ed-ancova-ex-01" class="quarto-xref">Tabelle&nbsp;<span>25.4</span></a>):</p>
<div class="cell">
<div id="tbl-ed-ancova-ex-01" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ed-ancova-ex-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;25.4: Varianztabelle
</figcaption>
<div aria-describedby="tbl-ed-ancova-ex-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: right;">SSQ</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">MSQ</th>
<th style="text-align: right;">F</th>
<th style="text-align: right;">p-Wert</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">x</td>
<td style="text-align: right;">16.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16.0</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">0.139</td>
</tr>
<tr class="even">
<td style="text-align: left;">group</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">0.6</td>
<td style="text-align: right;">0.495</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residuals</td>
<td style="text-align: right;">12.0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Hier finden wir ebenfalls keinen statisch signifikaten Effekt für beide Variablen, die Wert für die Treatmentvariable sind in beiden Tabellen gleich. Schauen wir uns die Summe der Quadratsummen an.</p>
<p><span class="math display">\[
SSQ_x + SSQ_{\text{group}} + SSE = 16+2.4+12 = 30.4
\]</span></p>
<p>Aber die totale Quadratsumme von <span class="math inline">\(y\)</span> ist <span class="math inline">\(SST = 82\)</span>. D.h. die Summer der Quadratsummen addiert sich nicht zu <span class="math inline">\(SST\)</span>.</p>
<p>Schauen wir aber rein interessehalber an, was passiert wenn wir den Treatmenteffekt gegen ein auf den <span class="math inline">\(y\)</span>-Achsenabschnitt reduziertes Modell testen. Wir ignorieren die Information aus der Kovariate.</p>
<div class="cell">
<div id="tbl-ed-ancova-mod00" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ed-ancova-mod00-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;25.5: Modellvergleich von <span class="math inline">\(y_i = \beta_0 + \epsilon_i\)</span> gegen <span class="math inline">\(y_i = \beta_0 + \tau_i + \epsilon_i\)</span>
</figcaption>
<div aria-describedby="tbl-ed-ancova-mod00-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">rss</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">sumsq</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">y ~ 1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">82</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">y ~ group</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">7.7143</td>
<td style="text-align: right;">0.0499</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>In <a href="#tbl-ed-ancova-mod00" class="quarto-xref">Tabelle&nbsp;<span>25.5</span></a> haben wir nun einen statistisch signifikanten Effekt gefunden. Wie kann das denn sein? Schauen wir uns dazu eine graphische Darstellung der Daten an (siehe <a href="#fig-ed-ancova-mod01" class="quarto-xref">Abbildung&nbsp;<span>25.6</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ed-ancova-mod01" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ed-ancova-mod01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_ancova_files/figure-html/fig-ed-ancova-mod01-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ed-ancova-mod01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;25.6: Streudiagramm der Rohdaten
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-ed-ancova-mod01" class="quarto-xref">Abbildung&nbsp;<span>25.6</span></a> können wir sehen, dass die beiden Gruppen sich deutlich in der Kovariate <span class="math inline">\(x\)</span> voneinander unterscheiden. Dies führt dazu, dass die Mittelwerte der beiden Gruppen auch entsprechend unterschiedlich voneinander sind. Dadurch führt ein Test für den Unterschied zwischen den beiden Gruppen dazu, dass es zu einem statistisch signifikanten Ergebnis für das Treatment kommt. Letztendlich wird dieser Unterschied nur durch die Kovariate verursacht. Wird für die Kovariate kontrolliert, dann verschwindet der Effekt (siehe <a href="#fig-ed-ancova-mod02" class="quarto-xref">Abbildung&nbsp;<span>25.7</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ed-ancova-mod02" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ed-ancova-mod02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_ancova_files/figure-html/fig-ed-ancova-mod02-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ed-ancova-mod02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;25.7: Streudiagramm der Rohdaten mit den Geraden aus dem ANCOVA-Modell
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-ed-ancova-mod02" class="quarto-xref">Abbildung&nbsp;<span>25.7</span></a> sehen wir, dass wenn die beiden parallen Geraden für die Kovariate auf Basis des ANCOVA-Modells eingefügt werden, dann ist der Unterschied zwischen den beiden Gruppen deutlich geringer. Dies betont noch einmal, dass ein Vergleich nur sinnvoll ist, wenn das level der Kovariaten zwischen den beiden Gruppen gleich ist. Es wird in diesem Fall dann von adjusted means <span class="math inline">\(\bar{Y}_l'\)</span> gesprochen. Dazu wird der Mittelwert <span class="math inline">\(\bar{X}_{..}\)</span> der Kovariaten <span class="math inline">\(X\)</span> über alle Gruppen gebildet und dann der Effekt der Gruppe berechnet.</p>
<p><span class="math display">\[\begin{equation*}
E[\bar{Y}_{i.}] = \mu + \tau_i + \beta\bar{x}_{..}
\label{eq-ed-ancova-adjusted-mean}
\end{equation*}\]</span></p>
<p>Im Beispiel werden die Gruppen daher wie folgt miteinander verglichen (siehe <a href="#fig-ed-ancova-adjusted-means" class="quarto-xref">Abbildung&nbsp;<span>25.8</span></a>)</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ed-ancova-adjusted-means" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ed-ancova-adjusted-means-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_ancova_files/figure-html/fig-ed-ancova-adjusted-means-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ed-ancova-adjusted-means-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;25.8: Korrigierte Mittelwerte der Gruppen bei <span class="math inline">\(\bar{x}\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wie wir an dem Beispiel sehen konnten, führt die Kombination von Mittelwerten in der Kovariaten <span class="math inline">\(X\)</span> dazu, dass der Effekt kleiner wird nachdem für die Kovariate kontrolliert wurde. Dies ist nicht immer der Fall sondern hängt davon ab, wie groß der Effekt ist und wie die Anordnung der Mittelwerte <span class="math inline">\(\bar{X}_j\)</span> in den Gruppen ist.</p>
<p>In <a href="#fig-ed-ancova-adjusted-means-2" class="quarto-xref">Abbildung&nbsp;<span>25.9</span></a> ist der Fall noch mal etwas klarer dargestellt.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ed-ancova-adjusted-means-2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ed-ancova-adjusted-means-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_ancova_files/figure-html/fig-ed-ancova-adjusted-means-2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ed-ancova-adjusted-means-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;25.9: Zusammenhang zwischen der Kovariate und dem Gruppen Effekt, der sich verkleinert.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wir haben einerseits die einfachen, rohen Gruppenmittelwerte und die korrigierten Mittelwerte. In <a href="#fig-ed-ancova-adjusted-means-2" class="quarto-xref">Abbildung&nbsp;<span>25.9</span></a> sind die einfachen Mittelwerte weiter auseinander entfernt als die korrigierten Mittelwerte. Daher wird der Effekt nach der Korrektur kleiner. Es kann aber auch der gegensätzliche Effekt eintreten. In <a href="#fig-ed-ancova-adjusted-means-3" class="quarto-xref">Abbildung&nbsp;<span>25.10</span></a> ist dafür ein vereinfachtes Beispiel dargestellt.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ed-ancova-adjusted-means-3" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ed-ancova-adjusted-means-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_ancova_files/figure-html/fig-ed-ancova-adjusted-means-3-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ed-ancova-adjusted-means-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;25.10: Zusammenhang zwischen der Kovariate und dem Gruppen Effekt, der sich vergrößert.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-ed-ancova-adjusted-means-3" class="quarto-xref">Abbildung&nbsp;<span>25.10</span></a> sind die einfachen Gruppenmittelwerte näher zusammen als dies der Fall bei den korrigierten Mittelwerten der Fall. Darin können wir sehen, dass nicht immer direkt klar ist in welche Richtung sich die Effekte verändern, wenn für eine Kovariate kontrolliert wird. Die Veränderung des Effekts hängt mit dem Zusammenhang zwischen der Kovariate und der abhängigen Variable <span class="math inline">\(\beta\)</span>, dem Abstand der Mittelwerte der Kovariate <span class="math inline">\(\bar{X}_i\)</span> in den Gruppen und natürlich dem tatsächlichen Effekt <span class="math inline">\(\tau_i\)</span> zusammen.</p>
</section>
<section id="analyse-einer-ancova-in-r" class="level2" data-number="25.2">
<h2 data-number="25.2" class="anchored" data-anchor-id="analyse-einer-ancova-in-r"><span class="header-section-number">25.2</span> Analyse einer ANCOVA in <code>R</code></h2>
<p>Für die Analyse in <code>R</code> können wir die üblichen Herangehensweise mittels <code>lm()</code> verwenden. Einzig, wenn wir die Varianztabelle nach dem Muster in <a href="#tbl-ed-ancova-ssq" class="quarto-xref">Tabelle&nbsp;<span>25.1</span></a> erzeugen wollen und nicht von Hand die Modellvergleiche durchführen wollen, müssen wir auf die Funktion <code>ANOVA()</code> aus dem package <code>car</code> zurückgreifen. Beispielweise für das Spielzeugbeispiel (Daten sind im <code>tibble</code> <code>bw</code>) ergibt sich der folgende Code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> group <span class="sc">+</span> x, bw)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(mod)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type II tests)

Response: y
          Sum Sq Df F value Pr(&gt;F)
group        2.4  1     0.6 0.4950
x           16.0  1     4.0 0.1393
Residuals   12.0  3               </code></pre>
</div>
</div>
<p>Über die Modellvergleiche:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mod_full <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> group <span class="sc">+</span> x, bw)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>mod_r1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> group, bw)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>mod_r2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, bw)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_r1, mod_full)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: y ~ group
Model 2: y ~ group + x
  Res.Df RSS Df Sum of Sq  F Pr(&gt;F)
1      4  28                       
2      3  12  1        16  4 0.1393</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_r2, mod_full)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: y ~ x
Model 2: y ~ group + x
  Res.Df  RSS Df Sum of Sq   F Pr(&gt;F)
1      4 14.4                        
2      3 12.0  1       2.4 0.6  0.495</code></pre>
</div>
</div>
<p>Wenn wir die Standard-<code>anova()</code>-Funktion auf das <code>lm</code>-Modell anwenden erhalten wir einen sequentiellen Modellvergleich bei dem es darauf ankommt in welcher Reihenfolge wir die unabhängigen Variablen in das Modell eingefügt haben.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>mod_g_x <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> group <span class="sc">+</span> x , bw)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>mod_x_g <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> group , bw)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_g_x)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: y
          Df Sum Sq Mean Sq F value Pr(&gt;F)  
group      1     54      54    13.5 0.0349 *
x          1     16      16     4.0 0.1393  
Residuals  3     12       4                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_x_g)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: y
          Df Sum Sq Mean Sq F value  Pr(&gt;F)  
x          1   67.6    67.6    16.9 0.02607 *
group      1    2.4     2.4     0.6 0.49503  
Residuals  3   12.0     4.0                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="effektstärke-bei-der-ancova" class="level2" data-number="25.3">
<h2 data-number="25.3" class="anchored" data-anchor-id="effektstärke-bei-der-ancova"><span class="header-section-number">25.3</span> Effektstärke bei der ANCOVA</h2>
<p>Für die ANCOVA können wir natürlich auch wieder eine Effektstärke berechnen. Wir verwenden wieder eine <span class="math inline">\(\Omega^2\)</span>-Typ Effektstärke für den Gesamteffekt des Modells (siehe Formel <span class="math inline">\(\eqref{ed-ancova-omega_sqr}\)</span>.</p>
<p><span class="math display">\[\begin{equation}
\hat{\omega}^2=\frac{df_{\text{effect}}(MS_{\text{effect}}-MS_{\text{error}})}{SS_{\text{total}}+MS_{\text{error}}}
\label{ed-ancova-omega_sqr}
\end{equation}\]</span></p>
<p>Für das Spielzeugbeispiel erhalten wir den folgenden Wert:</p>
<p><span class="math display">\[
\hat{\omega}^2 = \frac{1(2.4 - 4)}{82 + 4} = -0.02
\]</span></p>
<p>Per Konvention wird bei <span class="math inline">\(\hat{\omega}^2 &lt; 0\)</span> der Wert auf <span class="math inline">\(0\)</span> gekappt. D.h. in diesem Fall ist die Effektstärke gleich <span class="math inline">\(0\)</span>. Die Effektstärke wird dabei bei Vernachlässigung der Kovariaten bestimmt. Die Kovariate wird als intrinsische Variable betrachtet und daher gehört die durch die Kovariate verursachte Varianz zur Varianz der abhängigen Variablen. Daher wird bei der ANCOVA der Gesamteffekt unter Einbeziehung der Kovariatenvarianz berechnet. D.h. es wird nicht der partielle Effekt bestimmt.</p>
<p>Wenn wir die Effektstärke in <code>R</code> berechnen wollen, können wir wieder auf das package <code>effectsize</code> zurückgreifen und die <code>omega_squared()</code> Funktion anwenden. Hierbei sollte der Parameter <code>partial</code> wieder auf <code>FALSE</code> gesetzt werden um den globalen Effekt zu berechnen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">omega_squared</span>(mod_1, <span class="at">partial=</span>F)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA (Type I)

Parameter | Omega2 |       95% CI
---------------------------------
x         |   0.74 | [0.00, 1.00]
group     |   0.00 | [0.00, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
</div>
</section>
<section id="mehrfachvergleiche-bei-der-ancova" class="level2" data-number="25.4">
<h2 data-number="25.4" class="anchored" data-anchor-id="mehrfachvergleiche-bei-der-ancova"><span class="header-section-number">25.4</span> Mehrfachvergleiche bei der ANCOVA</h2>
<p>Sollten wir einen statistisch signifikanten Effekt für die Treatmentvariable gefunden haben, dann können wir, wie üblich, auch Mehrfachvergleiche über Kontraste <span class="math inline">\(\Psi_i\)</span> berechnen. Dies macht nur Sinn wenn <span class="math inline">\(K&gt;2\)</span> gilt, da ansonsten der einzelne <span class="math inline">\(\tau_i\)</span>-Koeffizient im Modell direkt den Vergleich der beiden Gruppen gibt. Auf die Herleitung der Varianz der Kontraste verzichten wir hier, da sich außer umfangreicher Algebra nichts grundlegendes Neues ergibt. Die Varianz für einen Kontrast <span class="math inline">\(\Psi_i\)</span> besitzt einen zusätzlichen Term für den Einfluss der Kovariate <span class="math inline">\(X\)</span>.</p>
<p><span class="math display">\[
Var\left(\sum_{i}c_i \hat{\tau_i}\right) = MSE\left(\sum_i\frac{c_i^2}{r_i} + \frac{(\sum_i c_i \bar{x}_{i.})^2}{\sum_{i=1}^K \sum_{t=1}^{r_i} (x_{it}-\bar{x}_{i.})^2} \right)
\]</span> Der interessante Punkte hier, das die Varianz mit dem Abstand der Mittelwerte der Kovariate in den Gruppen <span class="math inline">\(\bar{x}_{i.}\)</span> größer wird. Deshalb ist eine möglichst ähnliche Verteilung der Kovariaten in den Gruppen zu bevorzugen. Um das nominelle Signifikanzniveau dann wieder für Mehrfachtestung zu kontrollieren können entweder eine Bonferroni- (pre-planned) oder die die Scheffé-Methode verwendet werden. Für die Tukey-Methode gibt es keinen geschlossenen Beweis, obwohl wahrscheinlich auch die Tukey-Methode möglich ist <span class="citation" data-cites="dean1999">(vgl. <a href="references.html#ref-dean1999" role="doc-biblioref">Dean u.&nbsp;a. 1999, 1:p.294</a>)</span>.</p>
</section>
<section id="mehrfachvergleiche-in-r" class="level2" data-number="25.5">
<h2 data-number="25.5" class="anchored" data-anchor-id="mehrfachvergleiche-in-r"><span class="header-section-number">25.5</span> Mehrfachvergleiche in <code>R</code></h2>
<p>Um Mehrfachvergleiche in <code>R</code> durchzuführen, verwenden wir wieder das <code>emmeans</code>-package. Schauen wir uns dazu ein Beispiel hypothetisches Beispiel aus <span class="citation" data-cites="maxwell2004">(<a href="references.html#ref-maxwell2004" role="doc-biblioref">Maxwell, Delaney, und Kelley 2004, p.429</a>)</span> mit drei Stufen für die Treatmentvariable an (siehe <a href="#fig-ed-ancova-max-01" class="quarto-xref">Abbildung&nbsp;<span>25.11</span></a>). Es wurde drei Patientengruppen mit Depression in drei Gruppen unterteilt. Eine Gruppe fungierte als Kontrollgruppe (<code>wait list</code>), eine Gruppe bekam ein Medikament (SSRI) und eine Gruppe bekam ein Placebo. Die Patienten wurde vor und nach dem Treatment auf einer Depressionskala (BDI depression score) getestet.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ed-ancova-max-01" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ed-ancova-max-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_ancova_files/figure-html/fig-ed-ancova-max-01-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ed-ancova-max-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;25.11: Depression Beispiel aus Maxwell et al.&nbsp;(2004, p.429)
</figcaption>
</figure>
</div>
</div>
</div>
<p>Da davon auszugehen ist, dass die Schwere der Depression vor Beginn der Untersuchung einen Einfluss auf das Ergebnis hat, wurde die Eingangsmessung als eine Kovariate behandelt (commensurate covariate). Die Analyse der Daten (in <code>tibble</code> <code>bdi_w</code>) führte zu folgendem Ergebnis:</p>
<div class="cell">
<div id="lst-ed-ancova-max-ex" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-ed-ancova-max-ex-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;25.1: Ergebnis der ANCOVA-Analyse
</figcaption>
<div aria-describedby="lst-ed-ancova-max-ex-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode cell-code" id="lst-ed-ancova-max-ex"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="lst-ed-ancova-max-ex-1"><a href="#lst-ed-ancova-max-ex-1" aria-hidden="true" tabindex="-1"></a>mod_bdi <span class="ot">&lt;-</span> <span class="fu">lm</span>(Post <span class="sc">~</span> Pre <span class="sc">+</span> Condition, bdi_w)</span>
<span id="lst-ed-ancova-max-ex-2"><a href="#lst-ed-ancova-max-ex-2" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(mod_bdi)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type II tests)

Response: Post
          Sum Sq Df F value   Pr(&gt;F)   
Pre       313.37  1 10.7723 0.002937 **
Condition 217.15  2  3.7324 0.037584 * 
Residuals 756.33 26                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Es wurde ein statistisch signifikanter Effekt für die Gruppenzugehörigkeit gefunden. Den nachfolgenden Mehrfachvergleich können wir für die paarweisen Vergleiche wie folgt wieder mittels <code>emmeans()</code> berechnen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>bdi_em <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(mod_bdi, <span class="sc">~</span>Condition)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(bdi_em, <span class="at">infer=</span>T, <span class="at">adjust=</span><span class="st">'scheffe'</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast            estimate   SE df lower.CL upper.CL t.ratio p.value
 SSRI - Placebo         -4.45 2.42 26   -10.72    1.823  -1.841  0.2033
 SSRI - Wait list       -6.44 2.41 26   -12.71   -0.177  -2.669  0.0429
 Placebo - Wait list    -1.99 2.41 26    -8.26    4.269  -0.826  0.7139

Confidence level used: 0.95 
Conf-level adjustment: scheffe method with rank 2 
P value adjustment: scheffe method with rank 2 </code></pre>
</div>
</div>
<p>D.h. wir finden nur für den Kontrast zwischen der medikamentös behandelten Gruppe und der Kontrollgruppe einen statistisch signifikanten Effekt. An dem Beispiel können wir auch schön sehen, wie das ANCOVA-Modell eine Alternative darstellt um Daten zu analysieren die traditionell eher unter Repeated measures Designs fallen. Tatsächlich lässt sich zeigen, dass unter relativ milden, realistischen Annahmen die ANCOVA eine hohe Power für diese Designs besitzt <span class="citation" data-cites="wan2021 wan2020">(siehe <a href="references.html#ref-wan2021" role="doc-biblioref">Wan 2021</a>, <a href="references.html#ref-wan2020" role="doc-biblioref">2020</a>)</span>.</p>
<section id="effektstärken-für-paarweise-vergleiche" class="level3" data-number="25.5.1">
<h3 data-number="25.5.1" class="anchored" data-anchor-id="effektstärken-für-paarweise-vergleiche"><span class="header-section-number">25.5.1</span> Effektstärken für paarweise Vergleiche</h3>
<p>Oft möchten wir für paarweise Vergleiche eine Cohen’s D-artige Effektstärke berechnen. Dazu werden die sogenannte standardized differences between means verwendet. Der einzige Schritt der etwas problematischer ist, ist die Berechnung der Standardabweichung. Hier wird auch wieder die Restvarianz <span class="math inline">\(MS_W\)</span> ohne die Reduktion durch die Kovariate <span class="math inline">\(X\)</span> verwendet.</p>
<p><span class="math display">\[\begin{equation}
\hat{d} = \frac{\bar{Y}_l' - \bar{Y}_m'}{\sqrt{MS_W}}
\label{eq-ed-ancova-sdbw}
\end{equation}\]</span></p>
<p>Für die Berechnung von <span class="math inline">\(MS_W\)</span> muss ein lineares Modell ohne die Kovariate <span class="math inline">\(X\)</span> gefittet werden und der Term <span class="math inline">\(MSE\)</span> aus diesem Modell wird als <span class="math inline">\(MS_W\)</span> verwendet. Alternativ kann mit Hilfe der Werte aus dem ANCOVA Modell die folgende Formel verwendet werden: <span class="math inline">\(MS_W = \sqrt{(SS_X + SS_{\text{error}})/(N-K)}\)</span>.</p>
<p>In <code>R</code> kann dies wie folgt mittels der Funktion <code>eff_size()</code> wieder aus dem package <code>emmeans</code> berechnet werden:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>y_bars <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(mod_bdi, <span class="sc">~</span>Condition)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>mod_r <span class="ot">&lt;-</span> <span class="fu">lm</span>(Post <span class="sc">~</span> Condition, bdi_w)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">eff_size</span>(y_bars, <span class="at">sigma =</span> <span class="fu">sigma</span>(mod_r), <span class="at">edf =</span> <span class="fu">df.residual</span>(mod_r))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast            effect.size    SE df lower.CL upper.CL
 SSRI - Placebo           -0.707 0.396 26    -1.52    0.107
 SSRI - Wait list         -1.023 0.408 26    -1.86   -0.185
 Placebo - Wait list      -0.317 0.386 26    -1.11    0.476

sigma used for effect sizes: 6.294 
Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Unter Verwendung der Varianztabelle (siehe <a href="#lst-ed-ancova-max-ex" class="quarto-xref">Listing&nbsp;<span>25.1</span></a>) aus der ANCOVA können die standardized differences between means äquivalent wie folgt berechnet werden.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df_W <span class="ot">&lt;-</span> <span class="dv">30</span> <span class="sc">-</span> <span class="dv">3</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>MS_W <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((<span class="fl">756.33</span> <span class="sc">+</span> <span class="fl">313.37</span>)<span class="sc">/</span>df_W)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">eff_size</span>(y_bars, <span class="at">sigma =</span> MS_W, <span class="at">edf =</span> df_W)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast            effect.size    SE df lower.CL upper.CL
 SSRI - Placebo           -0.707 0.396 26    -1.52    0.107
 SSRI - Wait list         -1.023 0.408 26    -1.86   -0.185
 Placebo - Wait list      -0.317 0.386 26    -1.11    0.476

sigma used for effect sizes: 6.294 
Confidence level used: 0.95 </code></pre>
</div>
</div>
</section>
</section>
<section id="bestimmung-der-anzahl-der-replikationen" class="level2" data-number="25.6">
<h2 data-number="25.6" class="anchored" data-anchor-id="bestimmung-der-anzahl-der-replikationen"><span class="header-section-number">25.6</span> Bestimmung der Anzahl der Replikationen</h2>
<p>Der Vorteil der ANCOVA besteht nun darin, dass durch die Korrelation der Kovariate mit der abhängigen Variable zusätzliche Varianz aufgeklärt werden kann. Daher umso stärker der Zusammenhang ist zwischen <span class="math inline">\(X\)</span> und der abhängigen Variable umso mehr Varianz in <span class="math inline">\(Y\)</span> kann aufgeklärt werden und umso höher ist die Power des Modells. Dementsprechend kann im Prinzip die gleiche Berechnung wie beim CRD angewendet werden wobei die Residualvarianz um Korrelation <span class="math inline">\(\rho_{xy}\)</span> zwischen der Kovariate <span class="math inline">\(X\)</span> und <span class="math inline">\(Y\)</span> vermindert wird. Formal folgt:</p>
<p><span class="math display">\[\begin{align*}
\sigma_{\epsilon(\text{ANCOVA})}^2 &amp;= \sigma_{\epsilon(\text{CRD})}^2(1-\rho_{xy}^2) \\
f_{\text{ANCOVA}} &amp;= \frac{\sigma_{\text{btw}}}{\sigma_{\epsilon(\text{CRD})}}\frac{1}{\sqrt{1-\rho_{xy}^2}} = \frac{f_{\text{CRD}}}{\sqrt{1-\rho_{xy}^2}}
\end{align*}\]</span></p>
<p>Um den gleichen Ansatz wie beim CRD zu verwenden müssen dann lediglich noch die Freiheitsgrade angepasst werden mittels <span class="math inline">\(df_{\text{Residual}} = N - K - 1\)</span> aus dem ANCOVA-Modell.</p>
<div id="exm-ed-ancova-sample-size" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 25.2</strong></span> Also beispielsweise in einer CRD-Studie wurde eine Effektstärke für den Unterschied zwischen drei Gruppen (<span class="math inline">\(K = 3\)</span>) von <span class="math inline">\(f = 0.41\)</span> gefunden. Wie verändert sich die notwendige Stichprobengröße wenn eine Kovariate mit einer Korrelation von <span class="math inline">\(\rho_{xy} = 0.5\)</span> mit der abhängigen Variable hinzugenommen wird? Um eine power von <span class="math inline">\(pow = 0.8\)</span> zu erreichen wird im CRD zunächst die folgende Stichprobengröße benötigt:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>pwr<span class="sc">::</span><span class="fu">pwr.anova.test</span>(<span class="at">k=</span><span class="dv">3</span>, <span class="at">f=</span><span class="fl">0.41</span>, <span class="at">sig.level=</span><span class="fl">0.05</span>, <span class="at">power=</span><span class="fl">0.8</span>)<span class="sc">$</span>n</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20.13803</code></pre>
</div>
</div>
<p>D.h. es ist eine Stichprobengröße von <span class="math inline">\(N_i = 21\)</span> pro Gruppe notwendig um im CRD eine Power von <span class="math inline">\(pow = 0.8\)</span> zu erreichen. Wenn nun die Kovariate <span class="math inline">\(X\)</span> in das Modell integriert wird, erhöht sich die Effektstärke von <span class="math inline">\(f = 0.41\)</span> auf <span class="math inline">\(f = 0.41/\sqrt{1-0.5^2} = 0.47\)</span>. Daraus resultiert dann eine reduzierte Stichprobengröße von:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>pwr<span class="sc">::</span><span class="fu">pwr.anova.test</span>(<span class="at">k=</span><span class="dv">2</span>, <span class="at">f=</span><span class="fl">0.47</span>, <span class="at">sig.level=</span><span class="fl">0.05</span>, <span class="at">power=</span><span class="fl">0.8</span>)<span class="sc">$</span>n</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 18.77618</code></pre>
</div>
</div>
<p>D.h. im ANCOVA-Modell wird nur noch eine Stichprobengröße von <span class="math inline">\(N_i = 19\)</span> pro Gruppe benötigt.</p>
</div>
<p>Das Prinzip sollte daher eigentlich einleuchtend sein, durch die Modellierung der Kovariate <span class="math inline">\(X\)</span> vermindert sich Residualvarianz was dann bei einer gegebenen Effektstärke zu einer Vergrößerung der standardisierten Effektstärke führt.</p>
<div id="exm-ed-ancova-fien-02" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 25.3</strong></span> Schließen wir die ANCOVA noch einmal mit einer Reproduktion der Ergebnisse aus <span class="citation" data-cites="fien2019">Fien u.&nbsp;a. (<a href="references.html#ref-fien2019" role="doc-biblioref">2019</a>)</span> ab und versuchen die Ergebnisse in Tabelle 4 zu replizieren. Die Daten aus der Publikation sind in der Datei <code>fien_2019_part.txt</code> gespeichert.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df_small <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_delim</span>(<span class="st">'data/fien_2019_parts.txt'</span>, <span class="at">delim =</span> <span class="st">'</span><span class="sc">\t</span><span class="st">'</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(gaitspeed24week <span class="sc">~</span> gaitspeedbaseline <span class="sc">+</span> chronicdiseases <span class="sc">+</span> exercise,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> df_small)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = gaitspeed24week ~ gaitspeedbaseline + chronicdiseases + 
    exercise, data = df_small)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.18796 -0.07297 -0.01670  0.05582  0.49789 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        0.41128    0.13586   3.027 0.004415 ** 
gaitspeedbaseline  0.65936    0.11553   5.707 1.44e-06 ***
chronicdiseases   -0.02407    0.01020  -2.359 0.023563 *  
exerciseexercise   0.14887    0.03776   3.943 0.000334 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1201 on 38 degrees of freedom
Multiple R-squared:  0.6677,    Adjusted R-squared:  0.6415 
F-statistic: 25.46 on 3 and 38 DF,  p-value: 3.357e-09</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mod) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   2.5 % 97.5 %
(Intercept)        0.136  0.686
gaitspeedbaseline  0.425  0.893
chronicdiseases   -0.045 -0.003
exerciseexercise   0.072  0.225</code></pre>
</div>
</div>
<p>Wenn wir die berechneten Werte mit denen aus Tabelle 4 aus <span class="citation" data-cites="fien2019">Fien u.&nbsp;a. (<a href="references.html#ref-fien2019" role="doc-biblioref">2019</a>)</span> vergleichen, sehen wir, dass wir zum gleichen Ergebnis kommen.</p>
</div>
</section>
<section id="ancova-mit-interaktionseffekt" class="level2" data-number="25.7">
<h2 data-number="25.7" class="anchored" data-anchor-id="ancova-mit-interaktionseffekt"><span class="header-section-number">25.7</span> ANCOVA mit Interaktionseffekt</h2>
<p>Tatsächlich kann es auch vorkommen, dass der Einfluss der Kovariaten <span class="math inline">\(X\)</span> in den Gruppen nicht gleich ist. D.h. das Treatment und die Kovariate nicht unabhänngig voneinander sind. In diesem Fall könnte z.B. der folgende Effekt eintreten (siehe <a href="#fig-ed-ancova-inter-01" class="quarto-xref">Abbildung&nbsp;<span>25.12</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ed-ancova-inter-01" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ed-ancova-inter-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_ancova_files/figure-html/fig-ed-ancova-inter-01-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ed-ancova-inter-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;25.12: Beispiel für einen Interaktionseffekt zwischen der Treatmentvariablen und der Kovariate
</figcaption>
</figure>
</div>
</div>
</div>
<p>Hier sehen wir, dass die Steigungen in den drei Gruppen unterschiedlich sind. Das Modell haben wir schon vorher bei der multiplen linearen Regression gesehen, wir haben ein Interaktionsmodell.</p>
<p><span class="math display">\[\begin{equation}
y_{it} = \beta_0 + \tau_i + \beta \cdot x_{it} + (\tau\beta)_{it}x_{it} + \epsilon_{it}
\label{eq-ed-ancova-inter}
\end{equation}\]</span></p>
<p>Im Prinzip bleibt bei der Analyse alles gleich. Es ergibt sich aber ein Problem wenn die Unterschied zwischen den drei Gruppen untersucht werden, da diese davon abhängigen für welchen Wert der Kovariate der Unterschied untersucht wird. In <a href="#fig-ed-ancova-inter-02" class="quarto-xref">Abbildung&nbsp;<span>25.13</span></a> ist dieser Fall angezeigt.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ed-ancova-inter-02" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ed-ancova-inter-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_ancova_files/figure-html/fig-ed-ancova-inter-02-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ed-ancova-inter-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;25.13: Vergleiche der Gruppe A mit Gruppe C für verschiedene Werte der Kovariaten <span class="math inline">\(X\)</span>
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-ed-ancova-inter-02" class="quarto-xref">Abbildung&nbsp;<span>25.13</span></a> ist klar zu erkennen, dass in Abhängigkeit vom Wert der Kovariaten <span class="math inline">\(X\)</span> der Unterschied zwischen den Gruppen sehr unterschiedlich ausfällt. Wollten wir zum Beispiel die Unterschiede zwischen den Gruppen für die Werte der Kovariaten <span class="math inline">\(X\)</span> für <span class="math inline">\(X = [-2,0,2]\)</span> berechnen dann könnten wir das in <code>R</code> mittels <code>emmeans()</code> wie folgt durchführen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x<span class="sc">*</span>gruppe, df_i)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>mod_ems <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(mod, <span class="sc">~</span>gruppe<span class="sc">|</span>x, <span class="at">at=</span><span class="fu">list</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">2</span>)))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(mod_ems, <span class="at">adjust=</span><span class="st">'bonferroni'</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x = -2:
 contrast estimate    SE df t.ratio p.value
 A - B      -0.185 0.501 54  -0.368  1.0000
 A - C      -0.561 0.452 54  -1.241  0.6597
 B - C      -0.377 0.422 54  -0.893  1.0000

x =  0:
 contrast estimate    SE df t.ratio p.value
 A - B      -2.023 0.279 54  -7.264  &lt;.0001
 A - C      -4.369 0.289 54 -15.099  &lt;.0001
 B - C      -2.345 0.273 54  -8.593  &lt;.0001

x =  2:
 contrast estimate    SE df t.ratio p.value
 A - B      -3.862 0.401 54  -9.642  &lt;.0001
 A - C      -8.176 0.479 54 -17.073  &lt;.0001
 B - C      -4.314 0.438 54  -9.853  &lt;.0001

P value adjustment: bonferroni method for 3 tests </code></pre>
</div>
</div>
<p>Damit solche Vergleiche sinnvoll sind, müssten die jeweiligen Werte für die Kovariaten schon im voraus möglichst bekannt sein bzw. festgelegt worden sein.</p>
</section>
<section id="zusammenfassung" class="level2" data-number="25.8">
<h2 data-number="25.8" class="anchored" data-anchor-id="zusammenfassung"><span class="header-section-number">25.8</span> Zusammenfassung</h2>
<p>In der Herleitung und den Beispielen haben wir ANCOVAs mit nur einer Kovariate <span class="math inline">\(X\)</span> und einem Treatmentfaktor <span class="math inline">\(\tau_i\)</span> uns angeschaut. Die ANCOVA ist aber nicht nur auf diesen Fall beschränkt sondern es können problemlos auch mehrere Kovariaten <span class="math inline">\(X_i, \ldots, X_p\)</span> in das Modell nach dem genau gleichen Prinzip intergriert werden. Genauso kann die ANCOVA auch mit einem CRFD kombiniert werden und es kann eine kompliziertere Treatmenstruktur mit mehreren Faktoren verwendet werden. Ein Beispiel ist in <span class="citation" data-cites="duncan2017">Duncan, Bryant, und Stodden (<a href="references.html#ref-duncan2017" role="doc-biblioref">2017</a>)</span> zu finden wo mehrere ANCOVAs gerechnet wurden um Körperkomposition in Abhängigkeit von Gender und Bewegungsfertigkeiten (high, medium, low) zu modellieren mit Alter, Alter beim maximalen Wachstumsschub und körperliche Aktivität als Kovariaten. Diese flexiblen Möglichkeiten machen die ANCOVA zu einem sehr mächtigen Verfahren. Wie schon mehrfach betont, ist die ANCOVA dabei nichts anderes als ein allgemeines lineares Modell.</p>
</section>
<section id="zum-nach--und-weiterlesen" class="level2" data-number="25.9">
<h2 data-number="25.9" class="anchored" data-anchor-id="zum-nach--und-weiterlesen"><span class="header-section-number">25.9</span> Zum Nach- und Weiterlesen</h2>
<p>Ein gute Quelle um noch einmal die Grundlagen zur ANCOVA zu verstehen ist <span class="citation" data-cites="maxwell2004">Maxwell, Delaney, und Kelley (<a href="references.html#ref-maxwell2004" role="doc-biblioref">2004</a>)</span>. Genauere Information zur ANCOVA für pre-post Untersuchungen sind in <span class="citation" data-cites="wan2021">Wan (<a href="references.html#ref-wan2021" role="doc-biblioref">2021</a>)</span> und <span class="citation" data-cites="wan2020">Wan (<a href="references.html#ref-wan2020" role="doc-biblioref">2020</a>)</span> zu finden.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-casella2008" class="csl-entry" role="listitem">
Casella, George. 2009. <em>Statistical Design</em>. 1. Aufl. Springer Texts in Statistics. Springer, New York, NY.
</div>
<div id="ref-christensen2018" class="csl-entry" role="listitem">
Christensen, Ronald. 2018. <em>Analysis of variance, design, and regression: Linear modeling for unbalanced data</em>. CRC Press.
</div>
<div id="ref-dean1999" class="csl-entry" role="listitem">
Dean, Angela, Daniel Voss, Danel Draguljić, u.&nbsp;a. 1999. <em>Design and analysis of experiments</em>. Bd. 1. Springer.
</div>
<div id="ref-duncan2017" class="csl-entry" role="listitem">
Duncan, Michael J, Elizabeth Bryant, und David Stodden. 2017. <span>„Low fundamental movement skill proficiency is associated with high BMI and body fatness in girls but not boys aged 6–11 years old“</span>. <em>Journal of sports sciences</em> 35 (21): 2135–41.
</div>
<div id="ref-fien2019" class="csl-entry" role="listitem">
Fien, Samantha, Tim Henwood, Mike Climstein, Evelyne Rathbone, und Justin WL Keogh. 2019. <span>„Exploring the feasibility, sustainability and the benefits of the GrACE+ GAIT exercise programme in the residential aged care setting“</span>. <em>PeerJ</em> 7: e6973.
</div>
<div id="ref-maxwell2004" class="csl-entry" role="listitem">
Maxwell, Scott E, Harold D Delaney, und Ken Kelley. 2004. <em>Designing experiments and analyzing data: A model comparison perspective</em>. 2. Aufl. Routledge.
</div>
<div id="ref-wan2020" class="csl-entry" role="listitem">
Wan, Fei. 2020. <span>„Analyzing pre-post designs using the analysis of covariance models with and without the interaction term in a heterogeneous study population“</span>. <em>Statistical Methods in Medical Research</em> 29 (1): 189–204. <a href="https://doi.org/10.1177/0962280219827971">https://doi.org/10.1177/0962280219827971</a>.
</div>
<div id="ref-wan2021" class="csl-entry" role="listitem">
———. 2021. <span>„Statistical analysis of two arm randomized pre-post designs with one post-treatment measurement“</span>. <em>BMC medical research methodology</em> 21 (1): 1–16.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ed_crfd.html" class="pagination-link" aria-label="Completely Randomized Factorial Design">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Completely Randomized Factorial Design</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ed_crbd.html" class="pagination-link" aria-label="Completely Randomized Block Design">
        <span class="nav-page-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Completely Randomized Block Design</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>