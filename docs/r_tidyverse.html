<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.53">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>5&nbsp; Datenverarbeitung mit tidyverse – Skriptum - Fortgeschrittene Statistik</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./r_visualization.html" rel="next">
<link href="./r_functions.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/kbd/kbd.js"></script>
<link href="site_libs/quarto-contrib/kbd/kbd.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>
<script>

  MathJax = {

    tex: {

      tags: 'ams'  // should be 'ams', 'none', or 'all'

    }

  };

</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./r_startup.html">Eine Einführung in die Programmiersprache R</a></li><li class="breadcrumb-item"><a href="./r_tidyverse.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Datenverarbeitung mit <code>tidyverse</code></span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Skriptum - Fortgeschrittene Statistik</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vorwort</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./r_startup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Eine Einführung in die Programmiersprache R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Eine Übersicht über <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_vars_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Variablen und Datentypen in <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_flowcontrol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Ablaufkontrolle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Funktionen in <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_tidyverse.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Datenverarbeitung mit <code>tidyverse</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Datenvisualisierung mit <code>ggplot2</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_literate_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Literate programming in <code>R</code></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stats_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistik - Die Grundlagen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Eine kleine Welt der Unsicherheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_significance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Statistische Signifikanz, p-Wert und Power</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Parameterschätzung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Theoretische Verteilungen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_hypotheses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Hypothesen testen</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./slm_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Das einfache Regressionmodell</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Einführung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Inferenz</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_model_fit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Modellfit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Vorhersage</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./mlm_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Einführung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_interactions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Interaktionseffekte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_dummy_coding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Integration von nominalen Variablen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_hierarchies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Modellhierarchien</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ed_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelles Design</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Einführung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_crd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Completely Randomized Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_linear_contrasts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Lineare Kontraste</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_crfd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Completely Randomized Factorial Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_ancova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_crbd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Block Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_split_plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Split-plot Design</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix_math.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Mathematische Grundlagen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literatur</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#daten-in-r-einlesen" id="toc-daten-in-r-einlesen" class="nav-link active" data-scroll-target="#daten-in-r-einlesen"><span class="header-section-number">5.1</span> Daten in <code>R</code> einlesen</a>
  <ul class="collapse">
  <li><a href="#readr" id="toc-readr" class="nav-link" data-scroll-target="#readr"><span class="header-section-number">5.1.1</span> readr</a></li>
  <li><a href="#readxl" id="toc-readxl" class="nav-link" data-scroll-target="#readxl"><span class="header-section-number">5.1.2</span> readxl</a></li>
  <li><a href="#haven" id="toc-haven" class="nav-link" data-scroll-target="#haven"><span class="header-section-number">5.1.3</span> haven</a></li>
  </ul></li>
  <li><a href="#daten-in-r-prozessieren-mit-tidyverse" id="toc-daten-in-r-prozessieren-mit-tidyverse" class="nav-link" data-scroll-target="#daten-in-r-prozessieren-mit-tidyverse"><span class="header-section-number">5.2</span> Daten in <code>R</code> prozessieren mit <code>tidyverse</code></a>
  <ul class="collapse">
  <li><a href="#der-pipe-operator" id="toc-der-pipe-operator" class="nav-link" data-scroll-target="#der-pipe-operator"><span class="header-section-number">5.2.1</span> Der Pipe-Operator <code>|&gt;</code></a></li>
  <li><a href="#tidy-data" id="toc-tidy-data" class="nav-link" data-scroll-target="#tidy-data"><span class="header-section-number">5.2.2</span> Tidy-Data</a></li>
  <li><a href="#filter" id="toc-filter" class="nav-link" data-scroll-target="#filter"><span class="header-section-number">5.2.3</span> <code>filter()</code></a></li>
  <li><a href="#select" id="toc-select" class="nav-link" data-scroll-target="#select"><span class="header-section-number">5.2.4</span> <code>select()</code></a></li>
  <li><a href="#mutate" id="toc-mutate" class="nav-link" data-scroll-target="#mutate"><span class="header-section-number">5.2.5</span> <code>mutate()</code></a></li>
  <li><a href="#summarize" id="toc-summarize" class="nav-link" data-scroll-target="#summarize"><span class="header-section-number">5.2.6</span> <code>summarize()</code></a></li>
  <li><a href="#group_by" id="toc-group_by" class="nav-link" data-scroll-target="#group_by"><span class="header-section-number">5.2.7</span> <code>group_by()</code></a></li>
  <li><a href="#separate" id="toc-separate" class="nav-link" data-scroll-target="#separate"><span class="header-section-number">5.2.8</span> <code>separate()</code></a></li>
  <li><a href="#pivot_wider" id="toc-pivot_wider" class="nav-link" data-scroll-target="#pivot_wider"><span class="header-section-number">5.2.9</span> <code>pivot_wider()</code></a></li>
  <li><a href="#pivot_longer" id="toc-pivot_longer" class="nav-link" data-scroll-target="#pivot_longer"><span class="header-section-number">5.2.10</span> <code>pivot_longer()</code></a></li>
  <li><a href="#joins" id="toc-joins" class="nav-link" data-scroll-target="#joins"><span class="header-section-number">5.2.11</span> Joins</a></li>
  <li><a href="#spezialthemen" id="toc-spezialthemen" class="nav-link" data-scroll-target="#spezialthemen"><span class="header-section-number">5.2.12</span> Spezialthemen</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./r_startup.html">Eine Einführung in die Programmiersprache R</a></li><li class="breadcrumb-item"><a href="./r_tidyverse.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Datenverarbeitung mit <code>tidyverse</code></span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Datenverarbeitung mit <code>tidyverse</code></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Im Folgenden werden wir verschiedene Funktionen zur Bearbeitung und Visualisierung von Daten kennenlernen. Die verwendeten Funktionen sind alle in einer großen Sammlung von Funktionen in der Paketsammlung <code>tidyverse</code> zusammengefasst. Pakete aus dem <code>tidyverse</code> folgen alle einer einheitlichen Syntax und Idee der Datenverarbeitung. Die Pakete verfügen über eine ausgezeichnete Dokumentation. Daher werden die jeweiligen Funktionen hier nur kurz angeschnitten. Weitergehende Informationen und vor allem jede Menge Beispielanwendungen findet ihr in der <code>tidyverse</code> <a href="https://tidyverse.org">Dokumentation</a>.</p>
<section id="daten-in-r-einlesen" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="daten-in-r-einlesen"><span class="header-section-number">5.1</span> Daten in <code>R</code> einlesen</h2>
<p>Um Daten von der Festplatte oder anderen Speichermedien in <code>R</code> einzulesen, benötigen wir spezielle Funktionen. In Abhängigkeit von der Formatierung der Daten werden unterschiedliche, spezialisierte Funktionen verwendet. Daher müssen wir uns zunächst über die Dateiformatierung im Klaren sein, um die Daten erfolgreich in <code>R</code> einzulesen. In <code>R</code> decken drei Pakete den Großteil der in Frage kommenden Dateitypen ab. Die Pakete sind <code>readr</code> für Textdateien, <code>readxl</code> für Excel-Dateien und <code>haven</code> für SPSS- und weitere Binärdatenformate aus anderen Statistikprogrammen.</p>
<section id="readr" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="readr"><span class="header-section-number">5.1.1</span> readr</h3>
<p>Im Paket <code>readr</code> sind eine Reihe von Funktionen enthalten, um rechteckige Textdateien einzulesen. Rechteckig bezieht sich in diesem Zusammenhang auf die Anordnung der Daten in der Datei, ähnlich einer Tabelle. Um die Daten korrekt einzulesen, ist es notwendig, die Trennzeichen (im Englischen als delimiter bezeichnet) zwischen Datenwerten zu kennen. Oft verwendete Trennzeichen sind Kommas <code>,</code>, Semikolons <code>;</code>, Leerzeichen oder das Einrückungszeichen <kbd aria-hidden="true">TAB</kbd><span class="visually-hidden">TAB</span>. Durch die Kombination von Daten, die jeweils durch ein Trennzeichen voneinander getrennt sind und über mehrere Zeilen verteilt sind, kommt die rechteckige Anordnung zustande.</p>
<p>Die flexibelste Funktion, um solche Textdateien einzulesen, ist <code>read_delim()</code>. <code>read_delim()</code> benötigt die Angabe des Trennzeichens zwischen den einzelnen Spalteneinträgen über den Parameter <code>delim</code>. Seien z. B. die folgenden Daten in einer Datei <code>example_01.txt</code> in dem Ordner <code>data</code> gespeichert:</p>
<div class="line-block">id grp value<br>
p1 CON 1<br>
p2 CON 2<br>
p3 TRT 3<br>
p4 TRT 4</div>
<p>Das Trennzeichen zwischen den Einträgen ist ein <kbd aria-hidden="true">TAB</kbd><span class="visually-hidden">TAB</span>. Die Datei kann dann mittels des folgenden Befehls eingelesen werden.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_delim</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"data/example_01.txt"</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">delim =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Der Parameter <code>delim="\t"</code> spezifiziert das verwendete Trennzeichen, während <code>file</code> den Pfad und den Namen zur Datei angibt.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Vorsicht
</div>
</div>
<div class="callout-body-container callout-body">
<p>Der Pfad zur Datei ist immer entweder relativ zum aktuellen Arbeitsverzeichnis (<code>getwd()</code>) oder absolut, z. B. <code>C:/X/Y/Z/example_01.txt</code>, anzugeben. Das Arbeitsverzeichnis ist das Verzeichnis, von dem <code>R</code> aus gerade arbeitet (In RStudio mit <kbd aria-hidden="true">CTRL+SHIFT+h</kbd><span class="visually-hidden">CTRL+SHIFT+h</span> wechseln).</p>
<p>Befinden wir uns beispielsweise in einem Verzeichnis <em>stats</em> und müssen eine Hierarchiestufe nach oben gehen, um dann im Verzeichnis <em>data</em> die Datei <code>example_01.txt</code> einzulesen, dann können wir entweder den vollständigen Pfad benutzen oder einen relativen Pfad mit <code>../data/example_01.txt</code>. Dabei bedeuten die <code>..</code> eine Hierarchiestufe nach oben zu springen.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="pics/relative_pfad.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p><code>read_delim()</code> verwendet eine Reihe von Heuristiken, um den jeweiligen Datentyp (numerisch, Zeichenkette, etc.) der Spalten zu bestimmen. Der Rückgabewert von <code>read_delim()</code> ist ein <code>tibble()</code> der Daten. In unserem Beispiel weisen wir dem <code>tibble()</code> den Variablennamen <code>df</code> zu und können somit in der weiteren Analyse mit dem Bezeichner <code>df</code> auf die Daten zugreifen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  id    grp   value
  &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;
1 p1    CON       1
2 p2    CON       2
3 p3    TRT       3
4 p4    TRT       4</code></pre>
</div>
</div>
<p>In den Beispieldaten sind die ersten beiden Spalten als Zeichenketten (<code>&lt;char&gt;</code>) erkannt worden, während die dritte Spalte als Zahl (<code>&lt;dbl&gt;</code>) erkannt wurde. Manchmal funktioniert die automatische Erkennung der Datentypen nicht korrekt. In dem Fall können mit dem Parameter <code>col_types</code> die Spaltentypen direkt angegeben werden. Wenn keine Kopfzeile in den Daten vorhanden ist, kann diese über den Parameter <code>col_names</code> spezifiziert werden. Mit <code>skip</code> können Zeilen zu Beginn der Datei übersprungen werden.</p>
<div id="exm-readr-01" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 5.1</strong></span> Wollen wir zum Beispiel andere Spaltennamen haben, dann können wir die erste Zeile beim Einlesen überspringen und andere Spaltennamen angeben.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">read_delim</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">'data/example_01.txt'</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">delim =</span> <span class="st">'</span><span class="sc">\t</span><span class="st">'</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">skip =</span> <span class="dv">1</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">'ID'</span>, <span class="st">'Gruppe'</span>, <span class="st">'Wert'</span>),</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_types =</span> <span class="st">'ccd'</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  ID    Gruppe  Wert
  &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt;
1 p1    CON        1
2 p2    CON        2
3 p3    TRT        3
4 p4    TRT        4</code></pre>
</div>
</div>
<p>Wenn ihr das Paket <code>readr</code> vorher mit <code>library(readr)</code> geladen habt, ist die Qualifizierung der Funktion mit <code>readr::</code> nicht notwendig, und ihr könnt direkt den Funktionsnamen verwenden. Hier überspringen wir mit <code>skip=1</code> die erste Zeile in der Datei und geben mit <code>col_names=c('ID', 'Gruppe', 'Wert')</code> eigene Spaltennamen an und spezifizieren direkt mit <code>col_types</code> die Datentypen der Spalten mit <code>c</code> = <code>character</code> und <code>d</code> = <code>double</code>.</p>
</div>
<p>Die weiteren Funktionen in <code>readr</code> wie <code>read_csv</code>, <code>read_tsv</code> usw. sind in den meisten Fällen Spezialversionen von <code>read_delim</code>, bei denen der Parameter <code>delim</code> schon voreingestellt ist. Schaut euch etwas in der <a href="https://readr.tidyverse.org/reference/index.html">Dokumentation</a> um, um einen Überblick über die verschiedenen Varianten und Funktionalitäten zu bekommen.</p>
</section>
<section id="readxl" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="readxl"><span class="header-section-number">5.1.2</span> readxl</h3>
<p>Die gleichen Daten in einer Excel-Datei können wir mit der Funktion <code>read_xlsx()</code> aus dem Paket <code>readxl</code> in <code>R</code> laden. Wenn die Daten die folgende Form haben:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-r-basics-excel" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-r-basics-excel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="pics/excel_example.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-r-basics-excel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;5.1: Beispieldatei in Excel
</figcaption>
</figure>
</div>
</div>
</div>
<p>dann können wir die Daten mit dem folgenden Befehl laden:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> <span class="st">'data/example_01.xlsx'</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sheet =</span> <span class="st">'data'</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">range =</span> <span class="st">'A1:C5'</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  id    grp   value
  &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;
1 p1    CON       1
2 p2    CON       2
3 p3    TRT       3
4 p4    TRT       4</code></pre>
</div>
</div>
<p>Ähnlich wie bei <code>read_delim()</code> geben wir mit <code>path</code> den Pfad zur Datei an. Der Parameter <code>sheet</code> spezifiziert, aus welchem Excel-Blatt die Daten eingelesen werden sollen, während der Parameter <code>range</code> den Datenbereich auf dem Blatt definiert. Je nachdem, wie kompliziert eure Excel-Datei aussieht, müssen <code>sheet</code> und <code>range</code> oft gar nicht angegeben werden, da <code>read_xlsx()</code> auch über heuristische Regeln versucht zu erraten, welche Daten ihr einlesen wollt. Allerdings ist dies eher eine fragile Annahme, und daher ist es im Sinne einer robusten Datenanalyse zu empfehlen, beide Parameter immer anzugeben und sicherzugehen, dass auch wirklich die gewollten Daten eingelesen werden.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hinweis
</div>
</div>
<div class="callout-body-container callout-body">
<p>Beim Parameter <code>range</code> darauf achten, dass dieser bei Veränderung der Excel-Datei, z. B. wenn neue Daten dazukommen, entsprechend angepasst wird.</p>
</div>
</div>
</section>
<section id="haven" class="level3" data-number="5.1.3">
<h3 data-number="5.1.3" class="anchored" data-anchor-id="haven"><span class="header-section-number">5.1.3</span> haven</h3>
<p>Im Paket <code>haven</code> haben wir Funktionen, um mit SPSS-Dateien (siehe <a href="#fig-r-basics-spss" class="quarto-xref">Abbildung&nbsp;<span>5.2</span></a>) zu arbeiten.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-r-basics-spss" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-r-basics-spss-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="pics/spss_example.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-r-basics-spss-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;5.2: Beispieldatei in SPSS
</figcaption>
</figure>
</div>
</div>
</div>
<p>Die Funktionen funktionieren zum Glück selbst, wenn SPSS auf dem Rechner nicht installiert ist. Allerdings kann hier nicht nachkontrolliert werden, ob das Einlesen korrekt stattgefunden hat, wenn keine Dokumentation zu den Daten vorhanden ist. In SPSS werden Dateien üblicherweise in einem binären <code>sav</code>-Dateicontainer gespeichert. In <code>R</code> können die Daten mittels der Funktion <code>read_sav()</code> aus dem Paket <code>haven</code> eingelesen werden.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_sav</span>(<span class="st">'data/example_01.sav'</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  value grp       id       
  &lt;dbl&gt; &lt;dbl+lbl&gt; &lt;dbl+lbl&gt;
1     1 1 [CON]   1 [p1]   
2     2 1 [CON]   2 [p2]   
3     3 2 [TRT]   3 [p3]   
4     4 2 [TRT]   4 [p4]   </code></pre>
</div>
</div>
<p>Da SPSS eigene Datentypen, insbesondere im Zusammenhang mit nominalen bzw. ordinalen Variablen, hat, sind im Paket <code>haven</code> spezielle Datentypen definiert. Im Beispiel hier ersichtlich am Datentyp für <code>grp</code> mit <code>&lt;dbl+lbl&gt;</code>. Es handelt sich hier um den Datentyp <code>labelled</code>. In der Dokumentation von <code>read_sav()</code> gibt es hierzu weitere Informationen.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tipp
</div>
</div>
<div class="callout-body-container callout-body">
<p>Mit der Funktion <code>as_factor()</code> aus dem Paket <code>haven</code> können die <code>labelled</code> Daten in den <code>R</code>-Datentyp <code>factor</code> umgewandelt werden.</p>
</div>
</div>
<p>Wenn wir die Daten in <code>R</code> eingelesen haben, können wir nun als nächstes die Daten verarbeiten und so strukturieren, wie wir sie für die weitere Analyse benötigen. Dazu stehen uns eine Reihe von weiteren Funktionen aus dem <code>tidyverse</code> zur Verfügung.</p>
</section>
</section>
<section id="daten-in-r-prozessieren-mit-tidyverse" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="daten-in-r-prozessieren-mit-tidyverse"><span class="header-section-number">5.2</span> Daten in <code>R</code> prozessieren mit <code>tidyverse</code></h2>
<p>Die Art der Programmierung im <code>tidyverse</code> verwendet oft eine eigene Herangehensweise, die sich von derjenigen, die wir bisher kennengelernt haben, etwas unterscheidet. Um den Code leserlich zu halten, werden mehrere Funktionen in sogenannten <em>pipes</em> aneinandergehängt, ohne zwischendrin temporäre Variablen zu erstellen. Dies führt zu Code, der fast wie Prosa gelesen werden kann. Dazu müssen wir aber zunächst einen neuen Operator kennenlernen.</p>
<section id="der-pipe-operator" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="der-pipe-operator"><span class="header-section-number">5.2.1</span> Der Pipe-Operator <code>|&gt;</code></h3>
<p>In <code>R</code> gibt es den sogenannten Pipe-Operator <code>|&gt;</code>. Der <code>|&gt;</code> hat die Eigenschaft, dass ein vorangestellter Wert (dies kann auch der Rückgabewert einer Funktion sein) als das erste Argument an eine nachfolgende Funktion übergeben wird. Dies ermöglicht es, Code zu schreiben, der sich wie gesprochener Text liest. Schauen wir uns ein einfaches Beispiel an. Wir wollen den Mittelwert eines Zahlenvektors berechnen und anschließend das Ergebnis auf die zweite Nachkommastelle runden. Normalerweise würden wir das wie folgt formulieren, wenn wir keine Zwischenvariablen definieren wollen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">3</span>, <span class="sc">-</span><span class="fl">5.22</span>, <span class="dv">5</span>, <span class="fl">6.3</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">mean</span>(vec), <span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.85</code></pre>
</div>
</div>
<p>D. h. wir haben eine Schachtelung (nesting) der Funktionen. Die <code>mean()</code>-Funktion ist innerhalb der <code>round()</code>-Funktion geschachtelt, bzw. der Rückgabewert von <code>mean()</code> wird als erstes Argument an <code>round()</code> übergeben. Schauen wir uns nun an, wie wir das gleiche Programm mit dem Pipe-Operator <code>|&gt;</code> formulieren.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>vec <span class="sc">|&gt;</span> <span class="fu">mean</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.85</code></pre>
</div>
</div>
<p>Was ist hier passiert? Die erste Pipe <code>|&gt;</code> übergibt ihr links stehendes Argument, den Vektor <code>vec</code>, an das erste Argument der rechts stehenden Funktion <code>mean()</code>. Aus <code>vec |&gt; mean()</code> wird <code>mean(vec)</code>. <code>mean()</code> ist zufrieden und berechnet den Mittelwert des Vektors, der nun als Rückgabewert zur Verfügung steht. Der zweite Pipe-Operator nimmt nun wieder diesen <em>linken</em> Wert, den berechneten Mittelwert, und übergibt diesen an das erste Argument der nachfolgenden <code>round(2)</code>-Funktion. Wenn ihr euch die Hilfe von <code>round()</code> anschaut, dann seht ihr, dass der erste Parameter der zu rundende Wert ist. Was macht jetzt aber die <code>2</code> in <code>round(2)</code>? Nun, <code>|&gt;</code> stellt den links stehenden Wert an die erste Stelle der rechts stehenden Funktion, dadurch rutscht die <code>2</code> an die zweite Argumentstelle in <code>round()</code> und bestimmt somit die Anzahl der zu rundenden Stellen.</p>
<p>Der Vorteil des Pipe-Operators ist, dass ihr das Programm nun einfach von links nach rechts lesen könnt: Nimm <code>vec</code>, stecke es in <code>mean()</code>, und stecke das, was rauskommt, in <code>round(2)</code>. Bei dem ursprünglichen Programm musstet ihr euch von innen nach außen arbeiten und dabei immer im Blick behalten, auf welcher Stufe ihr seid, um die Parameterzuordnung richtig interpretieren zu können.</p>
<p>Noch ein Beispiel: Wir wollen den Mittelwert auf den Absolutwerten des Vektors berechnen. Nach der Standardmethode:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">abs</span>(vec)), <span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.59</code></pre>
</div>
</div>
<p>Mit dem Pipe-Operator:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>vec <span class="sc">|&gt;</span> <span class="fu">abs</span>() <span class="sc">|&gt;</span> <span class="fu">mean</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.59</code></pre>
</div>
</div>
<p>Wenn die Pipe anfängt, zu lang zu werden, dann hat es sich eingebürgert, nach der Pipe eine neue Zeile anzufangen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>vec <span class="sc">|&gt;</span> <span class="fu">abs</span>() <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.59</code></pre>
</div>
</div>
<p>Der Pipe-Operator <code>|&gt;</code> ist so alltäglich, dass ihr in RStudio einen Shortcut für ihn habt: <kbd aria-hidden="true">STRG+SHIFT+m</kbd><span class="visually-hidden">STRG+SHIFT+m</span>.</p>
<p>Bei der Verwendung der Pipe nicht vergessen, das Ergebnis der Pipe dann letztendlich doch wieder einer Variable zuzuweisen. Ansonsten berechnet <code>R</code> den Wert und schmeißt ihn gleich wieder weg.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.59</code></pre>
</div>
</div>
<p>Der Pipe-Operator <code>|&gt;</code> ist im alltäglichen Umgang mit Datenprozessierung im Zusammenhang mit <code>tidyverse</code> praktisch unabkömmlich, und praktisch jegliche Codeschnipsel, die ihr im Netz dazu findet, verwenden Pipes. Tatsächlich ist die dahinterliegende Idee in der Informatik <span class="citation" data-cites="kernighan1984">(siehe <a href="references.html#ref-kernighan1984" role="doc-biblioref">Kernighan und Pike 1984</a>)</span> schon relativ lange bekannt. Die darüberliegende Idee ist nämlich: Anstatt große, komplizierte Funktionen zu schreiben, die eine Vielzahl von Argumenten haben und mehrere unterschiedliche Aufgaben erledigen, werden lieber viele kleine, spezialisierte Programme erstellt. Die spezialisierten Programme können dann zusammengesetzt werden, um komplizierte Aufgaben zu erfüllen. Der Pipe-Operator ist dabei zentral für diese Idee, da er es ermöglicht, die spezialisierten, kleinen Programme einfach aneinander zu hängen. Ähnlich wie bei einem Kinderwasserspielzeug mit Rohren, Schaufeln und Filtern können durch Umordnung der Einzelfunktionen beliebig komplexe Mechanismen abgebildet werden. Unter Linux bash ist daher auch ein Pipe-Operator <code>|</code> zu finden.</p>
<p>Nach diesem Ausflug zurück zur Datenbearbeitung mit dem <code>tidyverse</code>. Um die Daten möglichst einfach mit dem <code>tidyverse</code> verarbeiten zu können, sollten die Daten im <code>tibble()</code> einer bestimmten Struktur folgen. Im <code>tidyverse</code> wird diese Anordnung als <em>tidy-Data</em> bezeichnet.</p>
</section>
<section id="tidy-data" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="tidy-data"><span class="header-section-number">5.2.2</span> Tidy-Data</h3>
<p>Zu tidy-Data gibt es in der einfachsten Form nur drei Regeln, die zu beachten sind:</p>
<ol type="1">
<li>Jede Spalte ist eine Variable.</li>
<li>Jede Zeile ist eine Beobachtung.</li>
<li>Jede Zelle ist ein einzelner Eintrag.</li>
</ol>
<p>Schauen wir uns wieder ein einfaches, fiktives Beispiel mit Sprunghöhen an.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'pre'</span>, <span class="st">'post'</span>), <span class="dv">4</span>),</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">gender =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'m'</span>, <span class="st">'f'</span>), <span class="at">each =</span> <span class="dv">4</span>),</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">rep</span>(<span class="fu">round</span>(<span class="fu">runif</span>(<span class="dv">4</span>, <span class="dv">20</span>, <span class="dv">40</span>)), <span class="at">each =</span> <span class="dv">2</span>),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">cmj =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">8</span>, <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">20</span>), <span class="dv">2</span>), <span class="dv">1</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
  time  gender   age   cmj
  &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 pre   m         27  27.6
2 post  m         27  21.6
3 pre   m         25  23.7
4 post  m         25  22.9
5 pre   f         36  24.2
6 post  f         36  21  
7 pre   f         36  24.2
8 post  f         36  23.6</code></pre>
</div>
</div>
<p>Wir haben vier Spalten: <code>time</code>, <code>gender</code>, <code>age</code> und <code>cmj</code>, die jeweils eine Variable darstellen. In jeder Zeile ist eine Beobachtung eine Sprunghöhe <code>cmj</code> einer Person eines Alters <code>age</code> und <code>gender</code> zu einem bestimmten Zeitpunkt <code>time</code>. Schaut also tidy aus.</p>
<p>Diese Darstellung ist aber wahrscheinlich unterschiedlich zu derjenigen, wie ihr solche Daten schon öfter gesehen habt. Wahrscheinlich nämlich eher so:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  gender   age pre       post     
  &lt;chr&gt;  &lt;dbl&gt; &lt;list&gt;    &lt;list&gt;   
1 m         27 &lt;dbl [1]&gt; &lt;dbl [1]&gt;
2 m         25 &lt;dbl [1]&gt; &lt;dbl [1]&gt;
3 f         36 &lt;dbl [2]&gt; &lt;dbl [2]&gt;</code></pre>
</div>
</div>
<p>Diese Darstellung ist zwar kompakter, entspricht aber nicht mehr den tidy-Anforderungen, da wir nun nicht mehr nur eine Beobachtung pro Zeile haben. Wir haben für jede Person die Sprunghöhe zu zwei Zeitpunkten in einer Zeile. Die Daten sind in dieser Darstellung also <em>untidy</em>. Die <em>tidy</em>-Version ist etwas länger und enthält redundante Informationen, aber wir werden im Folgenden sehen, dass diese Darstellung in der Verarbeitung zahlreiche Vorteile hat. Dazu werden wir auch Funktionen kennenlernen, mit denen wir zwischen diesen beiden Formaten hin- und herwechseln können. Die <em>tidy</em>-Darstellung wird als Long-Format bezeichnet, während die <em>untidy</em>-Darstellung als Wide-Format bezeichnet wird.</p>
</section>
<section id="filter" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="filter"><span class="header-section-number">5.2.3</span> <code>filter()</code></h3>
<p>Lernen wir jetzt unseren ersten <code>tidyverse</code>-Befehl zur Datenmanipulation kennen. Die Befehle werden als Verben bezeichnet, und die Regel für die Funktionsnamen ist zum Glück ziemlich einfach: “Was im Namen draufsteht, ist auch in der Packung drin.” Der Befehl <code>filter</code> filtert Daten, d.&nbsp;h. wir geben einen Sack Daten rein und wollen nur einen Teil wieder herausbekommen, der bestimmte Eigenschaften hat. Dazu können wir einfache Regeln mittels der Vergleichsoperatoren in <code>filter()</code> zusammen mit den Spaltennamen im <code>tibble()</code> verwenden. Wollen wir aus unserem Datensatz nur alle weiblichen Datenpunkte herausfiltern, und wir wissen, dass die Information über das Geschlecht in der Spalte <code>gender</code> steht und mit <code>f</code> für weiblich kodiert ist, dann können wir mit dem Vergleich <code>gender == 'f'</code> die Daten entsprechend filtern.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">filter</span>(gender <span class="sc">==</span> <span class="st">'f'</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  time  gender   age   cmj
  &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 pre   f         36  24.2
2 post  f         36  21  
3 pre   f         36  24.2
4 post  f         36  23.6</code></pre>
</div>
</div>
<p>Wollen wir dagegen auf das Alter mit <code>age &lt; 30</code> filtern, verwenden wir:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">filter</span>(age <span class="sc">&lt;</span> <span class="dv">30</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  time  gender   age   cmj
  &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 pre   m         27  27.6
2 post  m         27  21.6
3 pre   m         25  23.7
4 post  m         25  22.9</code></pre>
</div>
</div>
<p>Wenn die Daten mehrere Bedingungen erfüllen müssen, verwenden wir entsprechend mehrere Filteranweisungen. Die Vergleiche werden intern mittels einer Und-Operation zusammengesetzt.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">filter</span>(age <span class="sc">&lt;</span> <span class="dv">25</span>, gender <span class="sc">==</span> <span class="st">'f'</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 4
# ℹ 4 variables: time &lt;chr&gt;, gender &lt;chr&gt;, age &lt;dbl&gt;, cmj &lt;dbl&gt;</code></pre>
</div>
</div>
<p><code>filter()</code> gibt uns in diesem Beispiel also alle Datenpunkte zurück, bei denen <code>age &lt; 25</code> und <code>gender == 'f'</code> gilt. Durch die Kombination von mehreren Vergleichen können relativ einfach komplexe Bedingungen formuliert werden.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tipp
</div>
</div>
<div class="callout-body-container callout-body">
<p>Manchmal möchten wir nur alle vollständigen Zeilen aus einem Datensatz</p>
<p>weiterverwenden. Dies könnten wir mit <code>filter()</code> erreichen, dazu müssten wir aber für jede Spalte einen Vergleich mit <code>is.na()</code> schreiben, wenn die fehlenden Werte <code>NA</code> über mehrere Spalten verteilt sind. Schneller geht dies mit dem Befehl <code>drop_na()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>df_missing <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="cn">NA</span>, <span class="dv">13</span>, <span class="dv">14</span>), <span class="at">z =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">22</span>, <span class="dv">23</span>, <span class="cn">NA</span>))</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>df_missing</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
      x     y     z
  &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
1     1    11    21
2     2    NA    22
3     3    13    23
4     4    14    NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>df_missing <span class="sc">|&gt;</span> <span class="fu">drop_na</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
      x     y     z
  &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
1     1    11    21
2     3    13    23</code></pre>
</div>
</div>
</div>
</div>
<p>Insgesamt führt <code>filter()</code> in den meisten Fällen dazu, dass wir ein <code>tibble</code> mit weniger Zeilen als ursprünglich erhalten.</p>
</section>
<section id="select" class="level3" data-number="5.2.4">
<h3 data-number="5.2.4" class="anchored" data-anchor-id="select"><span class="header-section-number">5.2.4</span> <code>select()</code></h3>
<p>Das nächste Verb aus dem <code>tidyverse</code> ist <code>select()</code>. Mit <code>select()</code> können wir einzelne Variablen/Spalten aus einem <code>tibble()</code> selektieren. Wollen wir zum Beispiel aus unserem Datensatz nur die beiden Spalten <code>time</code> und <code>gender</code> auswählen, dann können wir dies mit <code>select()</code> wie folgt formulieren:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">select</span>(time, gender)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 2
  time  gender
  &lt;chr&gt; &lt;chr&gt; 
1 pre   m     
2 post  m     
3 pre   m     
4 post  m     
5 pre   f     
6 post  f     
7 pre   f     
8 post  f     </code></pre>
</div>
</div>
<p>Der Rückgabewert von <code>select()</code> ist entsprechend ein <code>tibble</code>, das nur die selektierten Spalten enthält. Ähnlich wie das auch bei der Indexierung von Elementen in Vektoren funktioniert, versteht <code>select()</code> auch eine Ausschlusssyntax mit <code>-</code>. Wollen wir z. B. alle Spalten außer <code>gender</code> auswählen, formulieren wir dies wie folgt:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>gender)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
  time    age   cmj
  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
1 pre      27  27.6
2 post     27  21.6
3 pre      25  23.7
4 post     25  22.9
5 pre      36  24.2
6 post     36  21  
7 pre      36  24.2
8 post     36  23.6</code></pre>
</div>
</div>
<div id="exm-select-01" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 5.2</strong></span> Da wir jetzt schon zwei Verben kennen, können wir auch direkt sehen, wie wir durch die Kombination der Befehle komplexere Anweisungen relativ einfach in Code übersetzen können. Wollen wir zum Beispiel alle Datenpunkte von Frauen, die älter als 28 sind, verwenden und brauchen dann die <code>gender</code>-Variable nicht mehr, können wir dies wie folgt übersetzen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">filter</span>(gender <span class="sc">==</span> <span class="st">'f'</span>, age <span class="sc">&gt;</span> <span class="dv">27</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>gender)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  time    age   cmj
  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
1 pre      36  24.2
2 post     36  21  
3 pre      36  24.2
4 post     36  23.6</code></pre>
</div>
</div>
</div>
<p>Insgesamt führt <code>select()</code> dazu, dass wir ein <code>tibble</code> erhalten, das weniger Spalten als ursprünglich enthält.</p>
</section>
<section id="mutate" class="level3" data-number="5.2.5">
<h3 data-number="5.2.5" class="anchored" data-anchor-id="mutate"><span class="header-section-number">5.2.5</span> <code>mutate()</code></h3>
<p>In den beiden vorhergehenden Fällen haben wir die Daten nicht wirklich verändert, sondern entweder nur bestimmte Fälle mit <code>filter()</code> oder bestimmte Variablen mit <code>select()</code> ausgewählt. Oft kommt es aber vor, dass wir aus den bestehenden Daten neue Daten erstellen wollen. Um neue Daten zu berechnen, verwenden wir im <code>tidyverse</code> das Verb <code>mutate()</code>.</p>
<p>In unserem Datensatz liegen die Sprunghöhen in Zentimetern vor, wir benötigen aber für weitere Berechnungen die Sprunghöhen in Metern. Dazu wollen wir eine neue Spalte erstellen, die wir, um sie von der anderen Spalte abzugrenzen, mit <code>cmj_m</code> bezeichnen wollen. Dazu setzen wir <code>mutate()</code> wie folgt ein:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">cmj_m =</span> cmj <span class="sc">/</span> <span class="dv">100</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 5
  time  gender   age   cmj cmj_m
  &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 pre   m         27  27.6 0.276
2 post  m         27  21.6 0.216
3 pre   m         25  23.7 0.237
4 post  m         25  22.9 0.229
5 pre   f         36  24.2 0.242
6 post  f         36  21   0.21 
7 pre   f         36  24.2 0.242
8 post  f         36  23.6 0.236</code></pre>
</div>
</div>
<p>Wir sehen, dass eine neue Spalte in dem <code>tibble</code> erstellt wurde, eben mit dem Namen <code>cmj_m</code>.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warnung
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>mutate()</code> verhindert nicht, Variablen mit neuen Werten zu überschreiben. Würden wir die Sprunghöhen in Zentimetern später nicht mehr benötigen, könnten wir die Spalte <code>cmj</code> auch überschreiben.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">cmj =</span> cmj <span class="sc">/</span> <span class="dv">100</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
  time  gender   age   cmj
  &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 pre   m         27 0.276
2 post  m         27 0.216
3 pre   m         25 0.237
4 post  m         25 0.229
5 pre   f         36 0.242
6 post  f         36 0.21 
7 pre   f         36 0.242
8 post  f         36 0.236</code></pre>
</div>
</div>
</div>
</div>
<p>Der große Vorteil von <code>mutate()</code> ist hier auch wieder, dass wir direkt auf die Spaltennamen zugreifen können und nicht wie sonst notwendig den <code>$</code>-Operator.</p>
<p>Durch <code>mutate()</code> werden insgesamt also zusätzliche Spalten an das ursprüngliche <code>tibble</code> angehängt.</p>
<div id="exm-mutate-01" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 5.3</strong></span> Aufbauend auf dem Beispiel von eben: Wollen wir zum Beispiel die Spalte mit den Sprunghöhen nicht beibehalten, aber einen neuen Namen verwenden, damit wir später nachvollziehen können, dass wir die Sprunghöhen bearbeitet haben, könnten wir wieder mit einer Kombination der Verben <code>mutate()</code> und <code>select()</code> in einer Pipe vorgehen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">cmj_m =</span> cmj <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>cmj)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
  time  gender   age cmj_m
  &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 pre   m         27 0.276
2 post  m         27 0.216
3 pre   m         25 0.237
4 post  m         25 0.229
5 pre   f         36 0.242
6 post  f         36 0.21 
7 pre   f         36 0.242
8 post  f         36 0.236</code></pre>
</div>
</div>
</div>
</section>
<section id="summarize" class="level3" data-number="5.2.6">
<h3 data-number="5.2.6" class="anchored" data-anchor-id="summarize"><span class="header-section-number">5.2.6</span> <code>summarize()</code></h3>
<p>Mit der <code>summarize()</code>-Funktion werden alle Beobachtungen (Zeilen) in eine Zeile zusammengefasst. Wollen wir zum Beispiel die durchschnittliche Sprunghöhe über alle Beobachtungen berechnen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">cmj_bar =</span> <span class="fu">mean</span>(cmj))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  cmj_bar
    &lt;dbl&gt;
1    23.6</code></pre>
</div>
</div>
<p><code>summarize()</code> kann auch mehrere Werte berechnen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">cmj_bar =</span> <span class="fu">mean</span>(cmj), <span class="at">age_bar =</span> <span class="fu">mean</span>(age))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  cmj_bar age_bar
    &lt;dbl&gt;   &lt;dbl&gt;
1    23.6      31</code></pre>
</div>
</div>
</section>
<section id="group_by" class="level3" data-number="5.2.7">
<h3 data-number="5.2.7" class="anchored" data-anchor-id="group_by"><span class="header-section-number">5.2.7</span> <code>group_by()</code></h3>
<p>Die <code>summarize()</code>-Funktion wird tatsächlich erst richtig mächtig im Zusammenhang mit der <code>group_by()</code>-Funktion. Mit <code>group_by()</code> kann ein Datensatz anhand der Werte einer Variable in Untergruppen geschnitten werden. Wollen wir in unserem Beispiel die Mittelwerte für verschiedene Zeitpunkte berechnen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">group_by</span>(time) <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">cmj_bar =</span> <span class="fu">mean</span>(cmj))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  time  cmj_bar
  &lt;chr&gt;   &lt;dbl&gt;
1 post     22.3
2 pre      24.9</code></pre>
</div>
</div>
<p>Das Gruppieren funktioniert auch über mehrere Variablen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">group_by</span>(time, gender) <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">cmj_bar =</span> <span class="fu">mean</span>(cmj))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
# Groups:   time [2]
  time  gender cmj_bar
  &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;
1 post  f         22.3
2 post  m         22.2
3 pre   f         24.2
4 pre   m         25.6</code></pre>
</div>
</div>
<p>Die Kombination aus <code>filter()</code>, <code>group_by()</code> und <code>summarize()</code> deckt wahrscheinlich mehr als die Hälfte der Anwendungen bei der Datenanalyse ab. Die folgenden Befehle sind etwas spezialisierter.</p>
</section>
<section id="separate" class="level3" data-number="5.2.8">
<h3 data-number="5.2.8" class="anchored" data-anchor-id="separate"><span class="header-section-number">5.2.8</span> <code>separate()</code></h3>
<p>Mit dem <code>separate()</code>-Befehl kann eine Variable, in der mehrere Informationen gespeichert sind, in mehrere Variablen separiert werden.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  Kondition  wert
  &lt;chr&gt;     &lt;int&gt;
1 pre_trt       1
2 post_trt      2
3 pre_con       3
4 post_con      4</code></pre>
</div>
</div>
<p>Die Variable <code>Kondition</code> hat zwei Variablen in einer kodiert (<em>untidy</em>). Mit <code>separate()</code> können wir <code>Kondition</code> aufteilen. <code>separate()</code> benötigt als Parameter neben dem Spaltennamen einen Vektor der neuen Spaltennamen, übergeben an das Funktionsargument <code>into</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>df_2 <span class="sc">|&gt;</span> <span class="fu">separate</span>(Kondition, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">'time'</span>, <span class="st">'group'</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  time  group  wert
  &lt;chr&gt; &lt;chr&gt; &lt;int&gt;
1 pre   trt       1
2 post  trt       2
3 pre   con       3
4 post  con       4</code></pre>
</div>
</div>
</section>
<section id="pivot_wider" class="level3" data-number="5.2.9">
<h3 data-number="5.2.9" class="anchored" data-anchor-id="pivot_wider"><span class="header-section-number">5.2.9</span> <code>pivot_wider()</code></h3>
<p>Mit <code>pivot_wider()</code> können <em>tidy</em>-Datensätze von der Long-Version in die Wide-Version umkodiert werden. Im einfachsten Fall benötigt <code>pivot_wider()</code> zwei Argumente. <code>names_from</code> wird der Variablenname übergeben, der einzelne <code>wide</code>-Variablen kodiert. <code>values_from</code> spezifiziert die einzutragenden Variablen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>df_w <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> time, <span class="at">values_from =</span> cmj)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>df_w</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  gender   age pre       post     
  &lt;chr&gt;  &lt;dbl&gt; &lt;list&gt;    &lt;list&gt;   
1 m         27 &lt;dbl [1]&gt; &lt;dbl [1]&gt;
2 m         25 &lt;dbl [1]&gt; &lt;dbl [1]&gt;
3 f         36 &lt;dbl [2]&gt; &lt;dbl [2]&gt;</code></pre>
</div>
</div>
</section>
<section id="pivot_longer" class="level3" data-number="5.2.10">
<h3 data-number="5.2.10" class="anchored" data-anchor-id="pivot_longer"><span class="header-section-number">5.2.10</span> <code>pivot_longer()</code></h3>
<p>Die Umkehrfunktion von <code>pivot_wider()</code> ist <code>pivot_longer()</code>. Wieder im einfachsten Fall müssen die umzukodierenden Spalten angegeben werden, zusammen mit dem neuen Spaltennamen für die Indizierung (<code>names_to</code>) und dem neuen Spaltennamen für die Werte (<code>values_to</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>df_w <span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="fu">c</span>(pre, post), <span class="at">names_to =</span> <span class="st">"time"</span>, <span class="at">values_to =</span> <span class="st">"cmj"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  gender   age time  cmj      
  &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;list&gt;   
1 m         27 pre   &lt;dbl [1]&gt;
2 m         27 post  &lt;dbl [1]&gt;
3 m         25 pre   &lt;dbl [1]&gt;
4 m         25 post  &lt;dbl [1]&gt;
5 f         36 pre   &lt;dbl [2]&gt;
6 f         36 post  &lt;dbl [2]&gt;</code></pre>
</div>
</div>
<p>Zusammenfassend ist das hier nur eine schnelle Übersicht über die möglichen Befehle gewesen. Um die Details der Funktionen zu verstehen, ist natürlich mehr Übung notwendig. Meistens hilft es aber schon zu wissen, welche der Funktionen ungefähr helfen könnte, um dann zusammen mit der Dokumentation eine Lösung zu finden. Eine exzellente Quelle für eine umfassendere Auseinandersetzung mit dem <code>tidyverse</code> ist das Buch <em>R for Data Science</em> von <span class="citation" data-cites="wickham2023">Wickham, Çetinkaya-Rundel, und Grolemund (<a href="references.html#ref-wickham2023" role="doc-biblioref">2023</a>)</span>, das ihr auch kostenlos in der aktuellsten Form <a href="https://r4ds.had.co.nz">online</a> findet.</p>
</section>
<section id="joins" class="level3" data-number="5.2.11">
<h3 data-number="5.2.11" class="anchored" data-anchor-id="joins"><span class="header-section-number">5.2.11</span> Joins</h3>
<p>Manchmal möchten wir Informationen aus mehreren Tabellen zusammenfügen. Sei zum Beispiel der folgende Fall gegeben: Wir haben in einer Tabelle <code>anthro</code> anthropometrische Merkmale unserer Probanden und in einer Tabelle <code>df_exp</code> die Experimentaldaten.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  pid     BMI height
  &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 P1       18    170
2 P2       25    180</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  pid   speed
  &lt;chr&gt; &lt;int&gt;
1 P1       11
2 P2       12
3 P3       13</code></pre>
</div>
</div>
<p>Um Daten aus verschiedenen Tabellen zusammenzufügen, gibt es eine Familie von Funktionen, die unter <code>join</code> zusammengefasst sind (<code>left_join()</code>, <code>right_join()</code>, <code>full_join()</code>). Der Unterschied besteht darin, was mit Daten gemacht wird, die in einer der Tabellen fehlen. Wir fokussieren uns hier auf <code>left_join()</code>. Wenn das Prinzip allerdings verstanden wurde, dann ist die Herleitung der beiden anderen Varianten einfach (siehe Dokumentation dazu).</p>
<p>Um die Tabellen zusammenzufügen, brauchen wir eine Variable, die die einzelnen Fälle indiziert und in beiden Tabellen vorhanden ist. Oben haben wir dazu die Variable <code>pid</code> definiert. Damit können wir den Join einfach durchführen:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  pid   speed   BMI height
  &lt;chr&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 P1       11    18    170
2 P2       12    25    180
3 P3       13    NA     NA</code></pre>
</div>
</div>
<p>Wir erhalten eine Tabelle, bei der für jede Zeile aus der <em>linken</em> Tabelle <code>df_exp</code> die <code>pid</code>-entsprechende Zeile aus <code>anthro</code> hinzugefügt wurde. Wenn der entsprechende Wert aus der <em>rechten</em> Tabelle fehlt, dann werden entsprechend fehlende Werte <code>NA</code> eingesetzt.</p>
<p>Manchmal kommt es vor, dass die Namen der Indexvariablen in den beiden Tabellen unterschiedlich sind. Mit der Funktion <code>join_by(x == y)</code> kann die Zusammenfügung trotzdem durchgeführt werden.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  pid   speed   BMI
  &lt;chr&gt; &lt;int&gt; &lt;dbl&gt;
1 P1       11    18
2 P2       12    25
3 P3       13    NA</code></pre>
</div>
</div>
</section>
<section id="spezialthemen" class="level3" data-number="5.2.12">
<h3 data-number="5.2.12" class="anchored" data-anchor-id="spezialthemen"><span class="header-section-number">5.2.12</span> Spezialthemen</h3>
<section id="rowid_to_column-und-row_number" class="level4" data-number="5.2.12.1">
<h4 data-number="5.2.12.1" class="anchored" data-anchor-id="rowid_to_column-und-row_number"><span class="header-section-number">5.2.12.1</span> <code>rowid_to_column()</code> und <code>row_number()</code></h4>
<p>Manchmal ist es von Vorteil, wenn eine Variable vorhanden ist, die die Zeilen eindeutig identifiziert. Eine einfache Lösung ist die Funktion <code>rowid_to_column()</code>, mit der ein fortlaufender Zähler an der ersten Stelle eingefügt wird.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">rowid_to_column</span>(<span class="at">var =</span> <span class="st">"rid"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 5
    rid time  gender   age   cmj
  &lt;int&gt; &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;
1     1 pre   m         27  27.6
2     2 post  m         27  21.6
3     3 pre   m         25  23.7
4     4 post  m         25  22.9
5     5 pre   f         36  24.2
6     6 post  f         36  21  
7     7 pre   f         36  24.2
8     8 post  f         36  23.6</code></pre>
</div>
</div>
<p>Eine weitere Möglichkeit ist die Verwendung der Funktion <code>row_number()</code> innerhalb von <code>mutate()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">rid =</span> <span class="fu">row_number</span>(), <span class="at">.before =</span> <span class="dv">1</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 5
    rid time  gender   age   cmj
  &lt;int&gt; &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;
1     1 pre   m         27  27.6
2     2 post  m         27  21.6
3     3 pre   m         25  23.7
4     4 post  m         25  22.9
5     5 pre   f         36  24.2
6     6 post  f         36  21  
7     7 pre   f         36  24.2
8     8 post  f         36  23.6</code></pre>
</div>
</div>
<p>Dieser Ansatz hat auch noch den Vorteil, dass wir eine eindeutige ID nach einem beliebigen Muster erstellen können. Würde zum Beispiel ein Identifier für Probanden fehlen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">pid =</span> <span class="fu">paste0</span>(<span class="st">'Proband_'</span>, <span class="fu">row_number</span>()), <span class="at">.before =</span> <span class="dv">1</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 5
  pid       time  gender   age   cmj
  &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 Proband_1 pre   m         27  27.6
2 Proband_2 post  m         27  21.6
3 Proband_3 pre   m         25  23.7
4 Proband_4 post  m         25  22.9
5 Proband_5 pre   f         36  24.2
6 Proband_6 post  f         36  21  
7 Proband_7 pre   f         36  24.2
8 Proband_8 post  f         36  23.6</code></pre>
</div>
</div>
</section>
<section id="pull" class="level4" data-number="5.2.12.2">
<h4 data-number="5.2.12.2" class="anchored" data-anchor-id="pull"><span class="header-section-number">5.2.12.2</span> <code>pull()</code></h4>
<p>Manchmal möchte man die Werte einer Variablen aus der Tabelle extrahieren. Dies kann mit dem Befehl <code>pull()</code> durchgeführt werden. Möchte ich zum Beispiel nur die Einträge für das Alter extrahieren, kann ich den folgenden Befehl benutzen:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 27 27 25 25 36 36 36 36</code></pre>
</div>
</div>
<p>Wir erhalten in diesem Fall einen Vektor mit den Einträgen.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-kernighan1984" class="csl-entry" role="listitem">
Kernighan, Brian W, und Rob Pike. 1984. <span>„The Unix Programming Environment. Prentice hall“</span>. <em>Englewood Cliffs, NY</em>.
</div>
<div id="ref-wickham2023" class="csl-entry" role="listitem">
Wickham, Hadley, Mine Çetinkaya-Rundel, und Garrett Grolemund. 2023. <em>R for data science</em>. " O’Reilly Media, Inc.".
</div>
</div>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./r_functions.html" class="pagination-link" aria-label="Funktionen in `R`">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Funktionen in <code>R</code></span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./r_visualization.html" class="pagination-link" aria-label="Datenvisualisierung mit `ggplot2`">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Datenvisualisierung mit <code>ggplot2</code></span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>