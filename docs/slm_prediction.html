<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Skriptum - Fortgeschrittene Statistik - 15&nbsp; Vorhersage</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./mlm_title.html" rel="next">
<link href="./slm_model_fit.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>
<script>
  MathJax = {
    tex: {
      tags: 'ams'  // should be 'ams', 'none', or 'all'
    }
  };
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./slm_title.html">Das einfache Regressionmodell</a></li><li class="breadcrumb-item"><a href="./slm_prediction.html"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Vorhersage</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Skriptum - Fortgeschrittene Statistik</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vorwort</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./r_startup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Eine Schnelleinführung in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Eine Übersicht über <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_kickoff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title"><code>R</code> Kickoff</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_flowcontrol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Ablaufkontrolle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Einfache Datenbearbeitung und Visualisierung in <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Visualisierung in <code>R</code> mit <code>ggplot2</code> - Eine Einführung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_literate_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Literate programming in <code>R</code></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stats_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistik</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Eine kleine Welt der Unsicherheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_significance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Statistische Signifikanz, p-Wert und Power</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Parameterschätzung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Theoretische Verteilungen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_hypotheses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Hypothesen testen</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./slm_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Das einfache Regressionmodell</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Einführung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Inferenz</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_model_fit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Modellfit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_prediction.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Vorhersage</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./mlm_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Einführung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_interactions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Interaktionseffekte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_dummy_coding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Integration von nominalen Variablen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_hierarchies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Modellhierarchien</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./lm_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Das allgemeine lineare Modell</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lm_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Synthese</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ed_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelles Design</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Einführung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_crd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Completely Randomized Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_linear_contrasts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Lineare Kontraste</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_crfd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Completely Randomized Factorial Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_ancova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_crbd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Completely Randomized Block Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_split_plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Split-plot Design</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literatur</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#vorhergesagte-werte-haty_i" id="toc-vorhergesagte-werte-haty_i" class="nav-link active" data-scroll-target="#vorhergesagte-werte-haty_i"><span class="header-section-number">15.1</span> Vorhergesagte Werte <span class="math inline">\(\hat{y}_i\)</span></a>
  <ul class="collapse">
  <li><a href="#berechnung-von-haty_i-in-r" id="toc-berechnung-von-haty_i-in-r" class="nav-link" data-scroll-target="#berechnung-von-haty_i-in-r"><span class="header-section-number">15.1.1</span> Berechnung von <span class="math inline">\(\hat{y}_i\)</span> in <code>R</code></a></li>
  </ul></li>
  <li><a href="#unsicherheit-in-der-vorhersage" id="toc-unsicherheit-in-der-vorhersage" class="nav-link" data-scroll-target="#unsicherheit-in-der-vorhersage"><span class="header-section-number">15.2</span> Unsicherheit in der Vorhersage</a>
  <ul class="collapse">
  <li><a href="#vorhersagen-in-r-mit-predict-continued" id="toc-vorhersagen-in-r-mit-predict-continued" class="nav-link" data-scroll-target="#vorhersagen-in-r-mit-predict-continued"><span class="header-section-number">15.2.1</span> Vorhersagen in <code>R</code> mit <code>predict()</code> (continued)</a></li>
  <li><a href="#konfidenzband-für-die-regressiongerade" id="toc-konfidenzband-für-die-regressiongerade" class="nav-link" data-scroll-target="#konfidenzband-für-die-regressiongerade"><span class="header-section-number">15.2.2</span> Konfidenzband für die Regressiongerade</a></li>
  </ul></li>
  <li><a href="#die-modellgüte-beurteilen" id="toc-die-modellgüte-beurteilen" class="nav-link" data-scroll-target="#die-modellgüte-beurteilen"><span class="header-section-number">15.3</span> Die Modellgüte beurteilen</a>
  <ul class="collapse">
  <li><a href="#root-mean-square-hatsigma2" id="toc-root-mean-square-hatsigma2" class="nav-link" data-scroll-target="#root-mean-square-hatsigma2"><span class="header-section-number">15.3.1</span> Root-mean-square <span class="math inline">\(\hat{\sigma}^2\)</span></a></li>
  <li><a href="#der-determinationskoeffizient-r2-als-maß-für-die-modellgüte" id="toc-der-determinationskoeffizient-r2-als-maß-für-die-modellgüte" class="nav-link" data-scroll-target="#der-determinationskoeffizient-r2-als-maß-für-die-modellgüte"><span class="header-section-number">15.3.2</span> Der Determinationskoeffizient <span class="math inline">\(R^2\)</span> als Maß für die Modellgüte</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./slm_title.html">Das einfache Regressionmodell</a></li><li class="breadcrumb-item"><a href="./slm_prediction.html"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Vorhersage</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Vorhersage</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="vorhergesagte-werte-haty_i" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="vorhergesagte-werte-haty_i"><span class="header-section-number">15.1</span> Vorhergesagte Werte <span class="math inline">\(\hat{y}_i\)</span></h2>
<p>Wenn ein einfaches lineares Modell gefittet wurde, ist eine zentrale Fragestellung welche Vorhersagen anhand des Modells getroffen werden können. Wir hatten schon vorher gesehen, dass Vorhersagen mittels eines <em>hats</em> über der Variable angezeigt werden. Beim einfachen linearen Regressionmodell liegen die vorhergesagten Werte <span class="math inline">\(\hat{y}_i\)</span> auf der berechneten Regressionsgerade. Da die Regressionsgerade anhand des Modells berechnet wird, berechnet sich der Werte <span class="math inline">\(\hat{y}_i\)</span> für einen gegeben <span class="math inline">\(x\)</span>-Wert nach.</p>
<p><span class="math display">\[\begin{equation}
\hat{y} = \hat{\beta_0} + \hat{\beta_0} x
\end{equation}\]</span></p>
<p>Wie schon mehrfach besprochen ist die Regressionsgerade inherent unsicher. Wir haben Unsicherheiten bezüglich der geschätzen Modellkoeffizienten <span class="math inline">\(\hat{\beta}_0\)</span> und <span class="math inline">\(\hat{\beta}_1\)</span> und diese Unsicherheit überträgt sich daher auf die geschätzen Werte <span class="math inline">\(\hat{y}_i\)</span>. Dies Unsicherheit muss daher bei deren Interpretation der Werte berücksichtigt werden.</p>
<section id="berechnung-von-haty_i-in-r" class="level3" data-number="15.1.1">
<h3 data-number="15.1.1" class="anchored" data-anchor-id="berechnung-von-haty_i-in-r"><span class="header-section-number">15.1.1</span> Berechnung von <span class="math inline">\(\hat{y}_i\)</span> in <code>R</code></h3>
<p>In <a href="#fig-pred-01" class="quarto-xref">Abbildung&nbsp;<span>15.1</span></a> sind die bereits behandelten Sprungdaten gegen die Anlaufgeschwindigkeiten zusammen mit der Regressionsgeraden und vorhergesagten Werten (rot) abgetragen.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-pred-01" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pred-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="slm_prediction_files/figure-html/fig-pred-01-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pred-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;15.1: Vorhersagewerte <span class="math inline">\(\hat{y}_i\)</span> (rote Punkte) für die Sprungdaten.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <code>R</code> können die vorhergesagten Werte des mittels <code>lm()</code> gefitteten Modells mit der Hilfsfunktion <code>predict()</code> bestimmt werden. Wenn der Funktion <code>predict()</code> keine weiteren Parameter außer dem <code>lm</code>-Objekt übergeben werden, berechnet <code>predict()</code> die vorhergesagten Werte <span class="math inline">\(\hat{y}_i\)</span> für alle die <span class="math inline">\(x\)</span>-Werte die auch zum fitten des Modells benutzt wurden. Die Reihenfolge der Werte <span class="math inline">\(\hat{y}_i\)</span> enspricht dabei den Werten im Original-<code>data.frame()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>] </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2        3        4        5 
4.523537 4.725140 4.856256 4.761778 5.416207 </code></pre>
</div>
</div>
<p>Der Übersicht halber haben uns nur die ersten fünf Werte ausgeben lassen. Als kleine Anwendung, können wir mittels <code>predict()</code> die Residuen auch von Hand ohne die <code>resid()</code>-Funktion berechnen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>(jump<span class="sc">$</span>jump_m <span class="sc">-</span> <span class="fu">predict</span>(mod))[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          1           2           3           4           5 
-0.16267721 -0.41248842 -0.29359256 -0.01047071  0.09927500 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">resid</span>(mod)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          1           2           3           4           5 
-0.16267721 -0.41248842 -0.29359256 -0.01047071  0.09927500 </code></pre>
</div>
</div>
<p>Meistens liegt das Interesse jedoch weniger auf den vorhergesagten Werten <span class="math inline">\(\hat{y}_i\)</span> für die gemessenen Werte, sondern es sollen Werte vorhergesagt werden für <span class="math inline">\(x\)</span>-Werte die nicht im Datensatz enthalten sind. Operational ändert sich nichts, es wird immer noch das gefittete Modell verwendetet und es müssen lediglich neue <span class="math inline">\(x\)</span>-Werte übergeben werden.</p>
<p>In <code>R</code> kann dies mittels des zweite Parameter in <code>predict()</code> erreicht werden. Soll zum Beispiel die Sprungweite für eine Anlaufgeschwindigkeit von <span class="math inline">\(v = 11.5[m/s]\)</span> berechnen werden, muss zunächst ein neues <code>tibble()</code> erstellt werden, welches den gewünschten <span class="math inline">\(x\)</span>-Wert enthält. Dabei muss der Spaltenname in dem neuen <code>tibble()</code> demjenigen im Original-<code>tibble()</code> entsprechen. Ansonsten funktioniert die Anwendung von <code>predict()</code> nicht.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">v_ms =</span> <span class="fl">11.5</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
   v_ms
  &lt;dbl&gt;
1  11.5</code></pre>
</div>
</div>
<p>Dieses <code>tibble()</code> kann nun zusammen mit dem <code>lm()</code>-Objekt an <code>predict()</code> übergeben werden.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod, <span class="at">newdata =</span> df)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
8.614136 </code></pre>
</div>
</div>
<p>D.h., bei einer Anlaufgeschwindigkeit von <span class="math inline">\(v = 11.5[m/s]\)</span> ist anhand des Modells eine Sprungweite von <span class="math inline">\(8.6m\)</span> zu erwarten.</p>
</section>
</section>
<section id="unsicherheit-in-der-vorhersage" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="unsicherheit-in-der-vorhersage"><span class="header-section-number">15.2</span> Unsicherheit in der Vorhersage</h2>
<p>Wie schon angesprochen ist unser Modell mit Unsicherheiten behaftet. Diese drücken sich in den Standardfehler für die beiden Koeffizienten <span class="math inline">\(\hat{\beta_0}\)</span> und <span class="math inline">\(\hat{\beta_1}\)</span> aus (siehe <a href="#tbl-pred-01" class="quarto-xref">Tabelle&nbsp;<span>15.1</span></a>).</p>
<div class="cell">
<div id="tbl-pred-01" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-pred-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;15.1: Modellparameter und Standardfehler
</figcaption>
<div aria-describedby="tbl-pred-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Schätzer</th>
<th style="text-align: right;"><span class="math inline">\(s_e\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.14</td>
<td style="text-align: right;">0.23</td>
</tr>
<tr class="even">
<td style="text-align: left;">v_ms</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">0.02</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Der vorhergesagte Wert <span class="math inline">\(\hat{y}\)</span> ist daher für sich alleine ist noch nicht brauchbar, da auch Informationen über dessen Unsicherheit notwendig sind um die Ergebnisse korrekt zu interpretieren.</p>
<p>Es können zwei unterschiedliche Anwendungsfälle voneinander unterschieden werden.</p>
<ol type="1">
<li>Der mittlere, erwartete Wert <span class="math inline">\(\hat{\bar{y}}_{neu}\)</span> (auch <span class="math inline">\(\hat{E}[y|x]\)</span>)</li>
<li>Die Vorhersage eines einzelnen Wertes <span class="math inline">\(\bar{y}_{neu}\)</span></li>
</ol>
<p>Im konkreten Fall werden damit zwei unterschiedliche Fragestellungen beantwortet. Im 1. Fall lautet die Frage, ich habe eine Trainingsgruppe und möchte wissen was der mittlere Wert der Gruppe anhand des Modells ist, wenn alle eine bestimmte Anlaufgeschwindigkeit <span class="math inline">\(v_{neu}\)</span> haben. Im 2. Fall lautet die Frage welche Weite eine einzelne Athletin für die Anlaufgeschwindigkeit <span class="math inline">\(v_{neu}\)</span> springen sollte. In beiden Fällen werden die Athleten nicht genau den Wert des Regressionsmodells treffen. Heuristisch können wir aber einsehen, dass im 1. Fall der Gruppenvorhersage die auftretenden Streuungen nach oben bzw. nach unten sich gegenseitig im Schnitt ausbalancieren sollten. Im 2. Fall der einzelnen Athletin ist dies nicht der Fall. Daher ist die Vorhersage im 2. Fall mit einer höhere Unsicherheit behatete. Diese Unterschied sollte sich dementsprechend in den Varianzen der beiden Vorhersagen wiederspiegeln.</p>
<p>Der vorhergesagte Wert <span class="math inline">\(\hat{y}_{neu}\)</span> ist in beiden Fällen gleich und entspricht der oben beschriebenen Methode anhand des Modell <span class="math inline">\(y_{neu} = \hat{\beta}_0 + \hat{\beta}_1 \times x_{\text{neu}}\)</span>.</p>
<p>Die Varianz für den ersten Fall, für den erwarteten Mittelwert errechnet nach:</p>
<p><span class="math display">\[\begin{equation}
Var(\hat{\bar{y}}_{neu}) = \hat{\sigma}^2 \left[\frac{1}{n} + \frac{(x_{neu} - \bar{x})^2}{\sum(x_i - \bar{x})^2}\right] = \hat{\sigma}_{\hat{\bar{y}}_{neu}}^2
\label{eq-slm-pred-hatbary}
\end{equation}\]</span></p>
<p>Das dazugehörige Konfidenzintervall errechnet sich mittels:</p>
<p><span class="math display">\[\begin{equation}
\hat{\bar{y}}_{neu} \pm q_{t(1-\alpha/2;n-2)} \times \hat{\sigma}_{\hat{\bar{y}}_{neu}}
\end{equation}\]</span></p>
<p>Die Varianz für die Vorhersage eines einzelnen Wertes errechnet sich dagegen nach:</p>
<p><span class="math display">\[\begin{equation}
Var(\hat{y}_{neu}) = \hat{\sigma}^2 \left[1 + \frac{1}{n} + \frac{(x_{neu} - \bar{x})^2}{\sum(x_i - \bar{x})^2}\right] = \hat{\sigma}^2 + \hat{\sigma}_{\hat{\bar{y}}_{neu}}^2 = \hat{\sigma}_{\hat{y}_{neu}}^2
\label{eq-slm-pred-haty}
\end{equation}\]</span></p>
<p>In Formel <span class="math inline">\(\eqref{eq-slm-pred-haty}\)</span> sehen wir, dass sich die Varianz für einen einezelnen vorhergesagten Wert <span class="math inline">\(\hat{y}\)</span> aus zwei Komponenten zusammensetzt. Einmal die Varianz aufgrund des vorhgesagten Mittelwerts und zusätzlich die Varianz auf Grund des Modells <span class="math inline">\(\sigma^2\)</span>. Insgesamt für das zu dem folgenden Konfidenzintervall:</p>
<p><span class="math display">\[\begin{equation}
\hat{y}_{neu} \pm q_{t(1-\alpha/2;n-2)} \times \hat{\sigma}_{\hat{y}_{neu}}
\end{equation}\]</span></p>
<p>Da wir <span class="math inline">\(\sigma^2\)</span> in den seltensten Fällen kennen, sondern ebenfalls anhand der Daten schätzen, wird der bereits besprochene Schätzer <span class="math inline">\(\hat{\sigma}^2 = MSE\)</span> verwendet.</p>
<p>In beiden Berechnungen (Formeln <span class="math inline">\(\eqref{eq-slm-pred-haty}\)</span> und <span class="math inline">\(\eqref{eq-slm-pred-hatbary}\)</span>) ist der folgende Term enthalten:</p>
<p><span class="math display">\[
\frac{(x_{neu} - \bar{x})^2}{\sum(x_i - \bar{x})^2}
\]</span></p>
<p>enthalten. Anhand des Zählers kann abgeleitet werden, dass die Unsicherheit der Vorhersage mit dem Abstand vom Mittelwert der <span class="math inline">\(x\)</span>-Werte zunimmt. Rein heuristisch macht dies Sinn, da davon ausgegangen werden kann, dass um den Mittelwert der <span class="math inline">\(x\)</span>-Werte auch die meiste Information über <span class="math inline">\(y\)</span> vorhanden ist und dementsprechend umso weiter die Werte sich vom <span class="math inline">\(\bar{x}\)</span> entfernen die Information abnimmt. Im Nenner ist wiederum wie auch beim Standardfehler <span class="math inline">\(\sigma_{\beta_1}\)</span> des Steigungskoeffizienten <span class="math inline">\(\beta_1\)</span> zu sehen, dass die Varianz abnimmt mit der Streuung der <span class="math inline">\(x\)</span>-Werte. Daher, wenn eine Vorhersage in einem bestimmten Bereich von <span class="math inline">\(x\)</span>-Werten durchgeführt werden soll, dann sollte darauf geachtet werden möglichst diesen Bereich auch zu samplen um die Unsicherheit so klein wie möglich zu halten.</p>
<section id="vorhersagen-in-r-mit-predict-continued" class="level3" data-number="15.2.1">
<h3 data-number="15.2.1" class="anchored" data-anchor-id="vorhersagen-in-r-mit-predict-continued"><span class="header-section-number">15.2.1</span> Vorhersagen in <code>R</code> mit <code>predict()</code> (continued)</h3>
<p>In <code>R</code> kann die Art des Konfidenzintervalls für die Vorhersage mittels des dritten Arguments zu <code>predict()</code> bestimmt werden. Dabei steht <code>confidence</code> für das Konfidenzintervall der mitteleren Vorhersage und <code>prediction</code> für das Konfidenzintervall eines einzelnen Wertes.</p>
<section id="erwarteter-mittelwert" class="level4" data-number="15.2.1.1">
<h4 data-number="15.2.1.1" class="anchored" data-anchor-id="erwarteter-mittelwert"><span class="header-section-number">15.2.1.1</span> Erwarteter Mittelwert</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">v_ms =</span> <span class="fl">11.5</span>) <span class="co"># oder tibble(v_ms = 11.5)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod, <span class="at">newdata =</span> df, <span class="at">interval =</span> <span class="st">'confidence'</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 8.614136 8.482039 8.746234</code></pre>
</div>
</div>
</section>
<section id="individuelle-werte" class="level4" data-number="15.2.1.2">
<h4 data-number="15.2.1.2" class="anchored" data-anchor-id="individuelle-werte"><span class="header-section-number">15.2.1.2</span> Individuelle Werte</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod, <span class="at">newdata =</span> df, <span class="at">interval =</span> <span class="st">'prediction'</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 8.614136 8.118445 9.109827</code></pre>
</div>
</div>
<p>Wir sehen hier, das das Konfidenzintervall, wie erwartet für den individuellen Wert <span class="math inline">\(\hat{y}\)</span> weiter ist, als das Konfidenzband für den mittleren Wert <span class="math inline">\(\hat{\bar{y}}\)</span>.</p>
</section>
</section>
<section id="konfidenzband-für-die-regressiongerade" class="level3" data-number="15.2.2">
<h3 data-number="15.2.2" class="anchored" data-anchor-id="konfidenzband-für-die-regressiongerade"><span class="header-section-number">15.2.2</span> Konfidenzband für die Regressiongerade</h3>
<p>In oftmals ist auch ein Konfidenzband für die gesamte Regressiongerade von Interesse. In diesem Fall kann das Konfidenzband über die folgende Formel nach der Working-Hotelling-Methode abgeschätzt werden.</p>
<p><span class="math display">\[\begin{equation}
\bar{Y} \pm W \sigma_{\hat{\bar{Y}}_{new}}
\label{eq-slm-pred-hotelling}
\end{equation}\]</span></p>
<p>Mit <span class="math inline">\(W^2 = 2 F(1-\alpha,2, n-2)\)</span>, wobei <span class="math inline">\(F(1-\alpha,2,n-2)\)</span> die Quartile der <span class="math inline">\(F\)</span>-Verteilung mit <span class="math inline">\(df_1 = 2\)</span> bzw. <span class="math inline">\(df_2 = n-2\)</span> Freiheitsgraden ist.</p>
<p>In <a href="#fig-slm-pred-confband" class="quarto-xref">Abbildung&nbsp;<span>15.2</span></a> ist das Konfidenzband nach Formel <span class="math inline">\(\eqref{eq-slm-pred-hotelling}\)</span> abgetragen.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-slm-pred-confband" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-slm-pred-confband-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="slm_prediction_files/figure-html/fig-slm-pred-confband-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-slm-pred-confband-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;15.2: Konfidenzbänder für <span class="math inline">\(\hat{E}[y|x]\)</span> und <span class="math inline">\(\hat{y}\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wir können sehen, das das Konfidenzband für Band gegen Ende der Werte breiter wird. Insbesondere wenn die Vorhersage außerhalb des Bereichs der beobachteten Daten geht, wird die Unsicherheit und damit das Band breiter.</p>
<p>Weiterführende Informationen findet ihr beispielsweise in <span class="citation" data-cites="kutner2005">(<a href="references.html#ref-kutner2005" role="doc-biblioref">Kutner u.&nbsp;a. 2005, 52ff</a>)</span>.</p>
</section>
</section>
<section id="die-modellgüte-beurteilen" class="level2" data-number="15.3">
<h2 data-number="15.3" class="anchored" data-anchor-id="die-modellgüte-beurteilen"><span class="header-section-number">15.3</span> Die Modellgüte beurteilen</h2>
<section id="root-mean-square-hatsigma2" class="level3" data-number="15.3.1">
<h3 data-number="15.3.1" class="anchored" data-anchor-id="root-mean-square-hatsigma2"><span class="header-section-number">15.3.1</span> Root-mean-square <span class="math inline">\(\hat{\sigma}^2\)</span></h3>
<p>Wie wir bereits bei der betrachtung von Vorhersagen gesehen haben, ist die Verbundene Unsicherheit ursächlich in den Formeln <span class="math inline">\(\eqref{eq-slm-pred-haty}\)</span> und <span class="math inline">\(\eqref{eq-slm-pred-hatbary}\)</span> von der Residualvarianz <span class="math inline">\(\sigma^2\)</span> bzw. derem Schätzer <span class="math inline">\(\hat{\sigma}^2 = MSE\)</span> abhängig. Daher kann dieser Wert, der auch als Standardschätzfehler bezeichnet wird, auch direkt als ein Kriterium der Modellgüte interpretiert werden. Insbesondere die Wurzel aus diesem Wert kann direkt interpretiert werden, da sie die gleichen Einheiten wie die abhängige Variable <span class="math inline">\(y\)</span> besitzt. Dabei ist weniger die absolute Höhe der Residualsvarianz von Interesse sondern immer in Bezug auf die konkrete Fragestellung.</p>
<p>Im vorliegenden Fall haben wir beispielsweise für das Sprungbeispiel <span class="math inline">\(\hat{\sigma} = 0.24\)</span> beobachtet. D.h. im Mittel liegen unser Modell knapp einen viertel Meter daneben. Ob eine derart große Abweichung das Modell unbrauchbar bei der Entscheidungsfindung ist, ist keine Entscheidung die über die Statistik getroffen werden kann, sondern diese Entscheidung muss durch die Anwenderin des Modell getroffen werden.</p>
<section id="root-mean-in-r" class="level4" data-number="15.3.1.1">
<h4 data-number="15.3.1.1" class="anchored" data-anchor-id="root-mean-in-r"><span class="header-section-number">15.3.1.1</span> Root-mean in <code>R</code></h4>
<p>In <code>R</code> können wir den Standardschätzfehler mittels der <code>sigma()</code>-Funktion bestimmen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sigma</span>(mod)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2369055</code></pre>
</div>
</div>
<p>Der Wert wird auch bei der <code>summary()</code>-Funktion ausgegeben.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = jump_m ~ v_ms, data = jump)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.44314 -0.22564  0.02678  0.19638  0.42148 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.13854    0.23261  -0.596    0.555    
v_ms         0.76110    0.02479  30.702   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2369 on 43 degrees of freedom
Multiple R-squared:  0.9564,    Adjusted R-squared:  0.9554 
F-statistic: 942.6 on 1 and 43 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
</section>
<section id="der-determinationskoeffizient-r2-als-maß-für-die-modellgüte" class="level3" data-number="15.3.2">
<h3 data-number="15.3.2" class="anchored" data-anchor-id="der-determinationskoeffizient-r2-als-maß-für-die-modellgüte"><span class="header-section-number">15.3.2</span> Der Determinationskoeffizient <span class="math inline">\(R^2\)</span> als Maß für die Modellgüte</h3>
<p>Im Folgenden schauen wir uns noch einen weiteren Parameter an um die Modellgüte zu beurteilen. Fangen wir dazu mit einem einfachen Modell mit nur vier Datenpunkten an.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">x</th>
<th style="text-align: right;">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.26</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.29</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.52</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">3.04</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>In <a href="#fig-slm-pred-simplemod" class="quarto-xref">Abbildung&nbsp;<span>15.3</span></a> ist die Regressionsgerade und die vier Datenpunkte abgebildet.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-slm-pred-simplemod" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-slm-pred-simplemod-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="slm_prediction_files/figure-html/fig-slm-pred-simplemod-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-slm-pred-simplemod-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;15.3: Regressionsgerade (rot) für das einfache Modell mit vier Punkten.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Schauen wir uns nun noch einmal die möglichen Abweichung im einfachen Regressionmodells an.</p>
<p>Als erste Abweichung definieren wir die <strong>Gesamtvarianz</strong> <span class="math inline">\(SSTO\)</span> (siehe Formel <span class="math inline">\(\eqref{eq-slm-pred-sstot}\)</span>).</p>
<p><span class="math display">\[\begin{equation}
SSTO := \sum_{i=1}^N (y_i - \bar{y})^2
\label{eq-slm-pred-sstot}
\end{equation}\]</span></p>
<p>D.h. die Gesamtvarianz berechnet sich als die quadrierten Abweichungen der <span class="math inline">\(y_i\)</span>-Werte vom Gesamtmittelwert <span class="math inline">\(\bar{y}\)</span>.</p>
<p>Die zweite Regressionkomponenten ist die sogenannte <strong>Regressionsvarianz</strong> <span class="math inline">\(SSR\)</span>. Diese ist definiert nach Formel <span class="math inline">\(\eqref{eq-slm-pred-ssreg}\)</span>:</p>
<p><span class="math display">\[\begin{equation}
SSR :=\sum_{i=1}^N(\hat{y}_i - \bar{y})^2
\label{eq-slm-pred-ssreg}
\end{equation}\]</span></p>
<p>Die Regressionsvarianz wird als die Summe der quadrierte Abweichungen der <span class="math inline">\(y_i\)</span>-Werte vom Gesamtmittelwert <span class="math inline">\(\bar{y}\)</span>.</p>
<p>Als letzte Abweichung haben wir dann noch die uns bereits bekannte <strong>Residualvarianz</strong> <span class="math inline">\(SSE\)</span> (siehe Formel <span class="math inline">\(\eqref{eq-slm-pred-ssres}\)</span>).</p>
<p><span class="math display">\[\begin{equation}
SSE := \sum_{i=1}^N (y_i - \hat{y}_i)^2
\label{eq-slm-pred-ssres}
\end{equation}\]</span></p>
<p>In <a href="#fig-slm-pred-simpledev" class="quarto-xref">Abbildung&nbsp;<span>15.4</span></a> sind die drei verschiedenen Abweichung noch einmal graphisch dargestellt.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-slm-pred-simpledev" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-slm-pred-simpledev-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="slm_prediction_files/figure-html/fig-slm-pred-simpledev-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-slm-pred-simpledev-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;15.4: Minimalmodell der Abweichungen
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wir sehen anhand der Pfeile in <a href="#fig-slm-pred-simpledev" class="quarto-xref">Abbildung&nbsp;<span>15.4</span></a> das ein additiver Zusammenhang zwischen den Abweichungen besteht. Der blaue Pfeil setzt sich aus der Addition zwischen dem grünen und dem grauen Pfeil zusammen. Rein algebraisch gilt ebenfalls:</p>
<p><span class="math display">\[\begin{equation*}
y_i - \bar{y} = y_i - \hat{y}_i + \hat{y}_i - \bar{y} = (y_i - \hat{y}_i) + (\hat{y}_i - \bar{y})
\end{equation*}\]</span></p>
<p>Tatsächlich lässt sich zeigen, dass dieser Zusammenhang auch für die Summe der quadrierten Abweichung gilt.</p>
<p><span class="math display">\[\begin{equation}
SSTO = SSR + SSE
\end{equation}\]</span></p>
<p>D.h. die Gesamtvarianz setzt sich aus zwei verschiedenen Komponenten zusammen. Einmal der Teil der Varianz der anhand des Modells erklärt werden kann (<span class="math inline">\(SSR\)</span>) und derjenige Teil der nicht anhand des Modells erklärt werden kann (<span class="math inline">\(SSE\)</span>).</p>
<p>Aus diesem Zusammenhang lässt sich eine Metrik erstellen um die Modellgüte zu beurteilen. Schauen wir uns dazu an, was passiert wenn wir einen perfekten Zusammenhang zwischen der <span class="math inline">\(X\)</span> und <span class="math inline">\(Y\)</span>-Variablen haben. In <a href="#fig-slm-pred-r2-perfect" class="quarto-xref">Abbildung&nbsp;<span>15.5</span></a> ist ein solcher Zusammenhang abgebildet.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-slm-pred-r2-perfect" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-slm-pred-r2-perfect-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="slm_prediction_files/figure-html/fig-slm-pred-r2-perfect-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-slm-pred-r2-perfect-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;15.5: Beispiel für einen perfekter linearen Zusammenhang zwischen <span class="math inline">\(x\)</span> und <span class="math inline">\(y\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In diesem Fall, liegen die beobachteten Werte <span class="math inline">\(y_i\)</span> genau auf der Regressionsgeraden. D.h. die Abweichungen <span class="math inline">\(y_i - \hat{y}_i = 0\)</span> und damit <span class="math inline">\(SSE = 0\)</span>. Bereichnen wir nun des Verhältnis von <span class="math inline">\(SSR\)</span> zu <span class="math inline">\(SSTO\)</span> dann erhalten wir.</p>
<p><span class="math display">\[\begin{equation}
\frac{SSR}{SSTO} = 1
\end{equation}\]</span></p>
<p>In <a href="#fig-slm-pred-r2-null" class="quarto-xref">Abbildung&nbsp;<span>15.6</span></a> ist das gegenteilige Beispiel abgebildet. Es besteht keine Zusammenhang zwischen der <span class="math inline">\(x\)</span> und <span class="math inline">\(y\)</span>-Variable.</p>
<p>In <a href="#fig-slm-pred-r2-null" class="quarto-xref">Abbildung&nbsp;<span>15.6</span></a> ist das gegenteilige Beispiel abgebildet. Es besteht keine Zusammenhang zwischen der <span class="math inline">\(x\)</span> und <span class="math inline">\(y\)</span>-Variable.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-slm-pred-r2-null" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-slm-pred-r2-null-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="slm_prediction_files/figure-html/fig-slm-pred-r2-null-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-slm-pred-r2-null-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;15.6: Beispiel für keinen linearen Zusammenhang zwischen <span class="math inline">\(x\)</span> und <span class="math inline">\(y\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In diesem Fall hat die Regressiongerade die Steigung <span class="math inline">\(\beta_1 = 0\)</span> und der <span class="math inline">\(y\)</span>-Achsenabschnitt geht durch den Mittelwert <span class="math inline">\(\bar{y}\)</span> der <span class="math inline">\(y\)</span>-Werte. Für die Abweichungen resultiert daraus, dass nun <span class="math inline">\(\hat{y}_i - \bar{y} = 0\)</span> und somit <span class="math inline">\(SSR = 0\)</span> gilt</p>
<p>Bilden wir wieder das Verhältnis von <span class="math inline">\(SSR\)</span> zu <span class="math inline">\(SSTO\)</span> dann erhalten wir:</p>
<p><span class="math display">\[\begin{equation*}
\frac{SSR}{SSTO} = 0
\end{equation*}\]</span></p>
<p>Insgesamt zeigen diese beiden Beispiel das wir mittels des Verhältnisses von <span class="math inline">\(SSR\)</span> zu <span class="math inline">\(SSTO\)</span> eine Metrik erhalten die wiedergibt wie gut die <span class="math inline">\(x\)</span> und <span class="math inline">\(y\)</span>-Variablen einen linearen Zusammenhang aufweisen. Das Verhältnis wird als Determinationskoeffizient <span class="math inline">\(R^2\)</span> bezeichnet. Die Metrik ist beschränkt auf Werte zwischen <span class="math inline">\(0\)</span> und <span class="math inline">\(1\)</span> wobei wie wir gesehen bei <span class="math inline">\(R^2 = 0\)</span> kein Zusammenhang besteht während bei <span class="math inline">\(R^2 = 1\)</span> ein perfekter Zusammenhang besteht. Insgesamt gilt:</p>
<p><span class="math display">\[\begin{equation}
R^2 = \frac{SSR}{SSTO} = 1 - \frac{SSE}{SSTO} \in [0,1]
\label{eq-slm-pred-rsquared}
\end{equation}\]</span></p>
<p>Es besteht auch ein enger Zusammenhang zwischen dem Determinationskoeffizienten <span class="math inline">\(R^2\)</span> und dem Korrelationskoeffizienten <span class="math inline">\(r_{xy} = \pm\sqrt{R^2}\)</span>. Dieser Zusammenhang gilt allerdings nur für die einfache lineare Regression und gilt nicht mehr bei der multiplen Regression die wir später kennenlernen werden.</p>
<p>Im Zusammenhang mit dem Determinationskoeffizienten <span class="math inline">\(R^2\)</span> gilt es auf ein Missverständnis hinzuweisen. Ein hoher <span class="math inline">\(R^2\)</span> zeigt nicht an, dass präzise Vorhersagen mittels des Modells getroffen werden. Der Determinationskoeffzient bestimmt nur die relative Reduktion der Varianz an nicht die Absolute. Ob ein Modell nützlich zur Prädiktion ist, hängt wie oben besprochen sehr eng mit dem absoluten Höhe der Residualvarianz zusammen.</p>
<p>Im Zusammenhang mit der multiplen Regression gibt es auch noch einen korrigierten Determinationskoeffizient <span class="math inline">\(R_a^2\)</span> bei dem ein penalty term auf Grund der Anzahl der Prädiktoren <span class="math inline">\(X_i\)</span> eingefügt wird.</p>
<p><span class="math display">\[\begin{equation}
R_a^2 = 1 - \frac{\frac{SSE}{n-p}}{\frac{SSTO}{n-1}} = 1 - \frac{n-1}{n-p}\frac{SSE}{SSTO}
\label{eq-slm-pres-rsquaredadj}
\end{equation}\]</span></p>
<section id="determinationskoeffizient-r2-in-r" class="level4" data-number="15.3.2.1">
<h4 data-number="15.3.2.1" class="anchored" data-anchor-id="determinationskoeffizient-r2-in-r"><span class="header-section-number">15.3.2.1</span> Determinationskoeffizient <span class="math inline">\(R^2\)</span> in <code>R</code></h4>
<p>In <code>R</code> erhalten wir den Determinationskoeffizienten über die <code>summary()</code>-Funktion. In unserem Beispiel zum Weitsprung erhalten wir beispielsweise:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = jump_m ~ v_ms, data = jump)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.44314 -0.22564  0.02678  0.19638  0.42148 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.13854    0.23261  -0.596    0.555    
v_ms         0.76110    0.02479  30.702   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2369 on 43 degrees of freedom
Multiple R-squared:  0.9564,    Adjusted R-squared:  0.9554 
F-statistic: 942.6 on 1 and 43 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>D.h. es wurde ein sehr guter Modellfit bezüglich eines linearen Zusammenhang zwischen der Anlaufgeschwindigkeit und der Sprungweite mit <span class="math inline">\(R^2 = 0.96\)</span> gefunden. Hier haben wir aber auch direkt den Fall, dass wir ein hohes <span class="math inline">\(R^2\)</span> beobachten aber die absolute Varianz trotzdem relativ hoch ist.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-kutner2005" class="csl-entry" role="listitem">
Kutner, Michael H, Christopher J Nachtsheim, John Neter, und William Li. 2005. <em>Applied Linear Statistical Models</em>. 5. Aufl. McGraw-Hill Irwin New York.
</div>
</div>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./slm_model_fit.html" class="pagination-link" aria-label="Modellfit">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Modellfit</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./mlm_title.html" class="pagination-link" aria-label="Multiple Regression">
        <span class="nav-page-text">Multiple Regression</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>