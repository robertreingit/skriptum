<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Scriptum - Fortgeschrittene Statistik - 8&nbsp; Vorhersage</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./mlm_title.html" rel="next">
<link href="./slm_model_fit.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Vorhersage</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Scriptum - Fortgeschrittene Statistik</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Vorwort</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stats_title.html" class="sidebar-item-text sidebar-link">Statistik</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_basics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Eine kleine Welt der Unsicherheit</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_significance.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Statistische Signifikanz, p-Wert und Power</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_distributions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Verteilungen</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_hypotheses.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Hypothesen testen</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./slm_title.html" class="sidebar-item-text sidebar-link">Das einfache Regressionmodell</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_basics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Einführung</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_inference.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Inferenz</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_model_fit.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Modellfit</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_prediction.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Vorhersage</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./mlm_title.html" class="sidebar-item-text sidebar-link">Multiple Regression</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_basics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Einführung</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_interactions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Interaktionseffekte</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_dummy_coding.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Integration von nominale Variablen</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_hierarchies.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Modellhierarchien</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./lm_title.html" class="sidebar-item-text sidebar-link">Das allgemeine lineare Modell</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lm_basics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Synthese</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">Literatur</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#vorhergesagte-werte-haty_i" id="toc-vorhergesagte-werte-haty_i" class="nav-link active" data-scroll-target="#vorhergesagte-werte-haty_i"><span class="toc-section-number">8.1</span>  Vorhergesagte Werte <span class="math inline">\(\hat{y}_i\)</span></a></li>
  <li><a href="#unsicherheit-in-der-vorhersage" id="toc-unsicherheit-in-der-vorhersage" class="nav-link" data-scroll-target="#unsicherheit-in-der-vorhersage"><span class="toc-section-number">8.2</span>  Unsicherheit in der Vorhersage</a></li>
  <li><a href="#vorhersagen-in-r-mit-predict" id="toc-vorhersagen-in-r-mit-predict" class="nav-link" data-scroll-target="#vorhersagen-in-r-mit-predict"><span class="toc-section-number">8.3</span>  Vorhersagen in R mit <code>predict()</code></a>
  <ul class="collapse">
  <li><a href="#erwarteter-mittelwert" id="toc-erwarteter-mittelwert" class="nav-link" data-scroll-target="#erwarteter-mittelwert"><span class="toc-section-number">8.3.1</span>  Erwarteter Mittelwert</a></li>
  <li><a href="#individuelle-werte" id="toc-individuelle-werte" class="nav-link" data-scroll-target="#individuelle-werte"><span class="toc-section-number">8.3.2</span>  Individuelle Werte</a></li>
  </ul></li>
  <li><a href="#konfidenzintervalle-graphisch" id="toc-konfidenzintervalle-graphisch" class="nav-link" data-scroll-target="#konfidenzintervalle-graphisch"><span class="toc-section-number">8.4</span>  Konfidenzintervalle graphisch</a></li>
  <li><a href="#r2-und-root-mean-square" id="toc-r2-und-root-mean-square" class="nav-link" data-scroll-target="#r2-und-root-mean-square"><span class="toc-section-number">8.5</span>  <span class="math inline">\(R^2\)</span> und Root-mean-square</a></li>
  <li><a href="#einfaches-modell" id="toc-einfaches-modell" class="nav-link" data-scroll-target="#einfaches-modell"><span class="toc-section-number">8.6</span>  Einfaches Modell</a></li>
  <li><a href="#nochmal-abweichungen" id="toc-nochmal-abweichungen" class="nav-link" data-scroll-target="#nochmal-abweichungen"><span class="toc-section-number">8.7</span>  Nochmal Abweichungen</a></li>
  <li><a href="#verhältnis-von-ssr-zu-ssto" id="toc-verhältnis-von-ssr-zu-ssto" class="nav-link" data-scroll-target="#verhältnis-von-ssr-zu-ssto"><span class="toc-section-number">8.8</span>  Verhältnis von <span class="math inline">\(SSR\)</span> zu <span class="math inline">\(SSTO\)</span></a></li>
  <li><a href="#determinationskoeffizient-r2" id="toc-determinationskoeffizient-r2" class="nav-link" data-scroll-target="#determinationskoeffizient-r2"><span class="toc-section-number">8.9</span>  Determinationskoeffizient <span class="math inline">\(R^2\)</span></a>
  <ul class="collapse">
  <li><a href="#korrigierter-determinationskoeffizient-r_a2" id="toc-korrigierter-determinationskoeffizient-r_a2" class="nav-link" data-scroll-target="#korrigierter-determinationskoeffizient-r_a2"><span class="toc-section-number">8.9.1</span>  Korrigierter Determinationskoeffizient <span class="math inline">\(R_a^2\)</span></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Vorhersage</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">

</div>
<section id="vorhergesagte-werte-haty_i" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="vorhergesagte-werte-haty_i"><span class="header-section-number">8.1</span> Vorhergesagte Werte <span class="math inline">\(\hat{y}_i\)</span></h2>
<div class="cell">

</div>
<p>Wenn ein einfaches lineares Modell gefittet wurde ist eine zentrale Frage welche Vorhersagen anhand des Modell getroffen werden können. Die Vorhersagen <span class="math inline">\(\hat{y}_i\)</span> liegen auf der vorhergesagten Regressionsgerade und berechnen sich nach dem Modell für einen gegeben <span class="math inline">\(x\)</span>-Wert.</p>
<p><span class="math display">\[
\hat{y} = \hat{\beta_0} + \hat{\beta_0} x
\]</span></p>
<p>Wie schon mehrfach besprochen unterliegt die Regressionsgerade inherent der Unsicherheit bezüglich der geschätzen Modellkoeffizienten <span class="math inline">\(\hat{\beta}_0\)</span> und <span class="math inline">\(\hat{\beta}_1\)</span>. Diese Unsicherheit überträgt sich auf die geschätzen Werte <span class="math inline">\(\hat{y}_i\)</span> und muss daher bei deren Interpretation berücksichtigt werden.</p>
<p>In <a href="#fig-pred-01">Abbildung&nbsp;<span>8.1</span></a> sind die bereits behandelten Sprungdaten gegen die Anlaufgeschwindigkeiten zusammen mit der Regressionsgeraden und vorhergesagten Werten (rot) abgetragen.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-pred-01" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="slm_prediction_files/figure-html/fig-pred-01-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;8.1: Vorhersagewerte <span class="math inline">\(\hat{y}_i\)</span> (rote Punkte) für die Sprungdaten.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>In <code>R</code> können die vorhergesagten Werte des mittels <code>lm()</code> gefitteten Modells mit der Hilfsfunktion <code>predict()</code> bestimmt werden. Wenn der Funktion <code>predict()</code> keine weiteren Parameter außer dem <code>lm</code>-Objekt übergeben werden, berechnet <code>predict()</code> die vorhergesagten Werte <span class="math inline">\(\hat{y}_i\)</span> für alle die <span class="math inline">\(x\)</span>-Werte die auch zum fitten des Modells benutzt wurden. Die Reihenfolge der Werte <span class="math inline">\(\hat{y}_i\)</span> enspricht dabei den Werten im Original-<code>data.frame()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>] </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2        3        4        5 
4.523537 4.725140 4.856256 4.761778 5.416207 </code></pre>
</div>
</div>
<p>Wir haben uns hier nur die ersten fünf Werte ausgeben lassen, da nur demonstriert werden soll wie die <code>predict()</code>-Funktion angewendet werden kann. Um eine Anwendung zu geben, so können mittels <code>predict()</code> die Residuen auch von Hand ohne die <code>resid()</code>-Funktion erhalten werden.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>(jump<span class="sc">$</span>jump_m <span class="sc">-</span> <span class="fu">predict</span>(mod))[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          1           2           3           4           5 
-0.16267721 -0.41248842 -0.29359256 -0.01047071  0.09927500 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">resid</span>(mod)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          1           2           3           4           5 
-0.16267721 -0.41248842 -0.29359256 -0.01047071  0.09927500 </code></pre>
</div>
</div>
<p>Wiederum nur zur Demonstration die ersten fünf Wert um die Äquivalenz der beiden Methoden zu demonstrieren.</p>
<p>Meistens liegt das Interesse jedoch weniger auf den vorhergesagten Werten <span class="math inline">\(\hat{y}_i\)</span> für die gemessenen Werte, sondern es sollen Werte vorhergesagt werden für <span class="math inline">\(x\)</span>-Werte die nicht im Datensatz enthalten sind. Operational ändert sich nichts, es wird immer noch das gefittete Modell verwendetet und es müssen lediglich neue <span class="math inline">\(x\)</span>-Werte übergeben werden.</p>
<p>In <code>R</code> kann dies mittels des zweite Parameter in <code>predict()</code> erreicht werden. Soll zum Beispiel die Sprungweite für eine Anlaufgeschwindigkeit von <span class="math inline">\(v = 11.5[m/s]\)</span> berechnen werden, muss zunächst ein neues <code>tibble()</code> erstellt werden, welches den gewünschten <span class="math inline">\(x\)</span>-Wert enthält. Dabei muss der Spaltenname in dem neuen <code>tibble()</code> demjenigen im Original-<code>tibble()</code> entsprechen. Ansonsten funktioniert die Anwendung von <code>predict()</code> nicht.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">v_ms =</span> <span class="fl">11.5</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
   v_ms
  &lt;dbl&gt;
1  11.5</code></pre>
</div>
</div>
<p>Dieses <code>tibble()</code> kann nun zusammen mit dem <code>lm()</code>-Objekt an <code>predict()</code> übergeben werden.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod, <span class="at">newdata =</span> df)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
8.614136 </code></pre>
</div>
</div>
<p>D.h., bei einer Anlaufgeschwindigkeit von <span class="math inline">\(v = 11.5[m/s]\)</span> ist anhand des Modells eine Sprungweite von <span class="math inline">\(8.6m\)</span> zu erwarten.</p>
</section>
<section id="unsicherheit-in-der-vorhersage" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="unsicherheit-in-der-vorhersage"><span class="header-section-number">8.2</span> Unsicherheit in der Vorhersage</h2>
<p>Wie schon angesprochen ist unser Modell natürlich mit Unsicherheiten behaftet. Diese drücken sich in den Standardfehler für die beiden Koeffizienten <span class="math inline">\(\hat{\beta_0}\)</span> und <span class="math inline">\(\hat{\beta_1}\)</span> (siehe <a href="#tbl-pred-01">Tabelle&nbsp;<span>8.1</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-pred-01" class="anchored">
<table class="table table-sm table-striped">
<caption>Tabelle&nbsp;8.1: Modellparameter und Standardfehler</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Schätzer</th>
<th style="text-align: right;"><span class="math inline">\(s_e\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.14</td>
<td style="text-align: right;">0.23</td>
</tr>
<tr class="even">
<td style="text-align: left;">v_ms</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">0.02</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Der vorhergesagte Wert <span class="math inline">\(\hat{y}\)</span> ist daher für sich alleine ist noch nicht brauchbar, da auch Informationen über dessen Unsicherheit notwendig sind um die Ergebnisse korrekt zu interpretieren.</p>
<p>Es können zwei unterschiedliche Anwendungsfälle voneinander unterschieden werden.</p>
<ol type="1">
<li>Der mittlere, erwartete Wert <span class="math inline">\(\hat{\bar{y}}_{neu}\)</span></li>
<li>Die Vorhersage eines einzelnen Wertes <span class="math inline">\(\bar{y}_{neu}\)</span></li>
</ol>
<p>Im konkreten Fall werden damit zwei unterschiedliche Fragestellungen beantwortet. Im 1. Fall lautet die Frage, ich habe eine Trainingsgruppe und möchte wissen was der mittlere Wert der Gruppe anhand des Modells ist, wenn alle eine bestimmte Anlaufgeschwindigkeit <span class="math inline">\(v_{neu}\)</span> haben. Im 2. Fall lautet die Frage welche Weite eine einzelne Athletin für die Anlaufgeschwindigkeit <span class="math inline">\(v_{neu}\)</span> springen sollte. In beiden Fällen werden keiner genau den Wert des Regressionsmodells treffen, aber im 1. Fall der Gruppe werden sich Streuungen nach oben bzw. nach unten gegenseitig im Schnitt ausbalancieren während im 2. Fall der einzelnen Athletin dies nicht der Fall ist. Daher hat die Vorhersage im 2. Fall eine höhere Unsicherheit. Diese Unterschied sollte sich dementsprechend in den Varianzen der beiden Vorhersagen wiederspiegeln.</p>
<p>Wie bereits erwähnt, der vorhergesagte Wert <span class="math inline">\(\hat{y}_{neu}\)</span> ist in beiden Fällen gleich und entsprecht der oben beschriebenen Methode anhand des Modell <span class="math inline">\(y_{neu} = \hat{\beta}_0 + \hat{\beta}_1 \times x_{\text{neu}}\)</span>.</p>
<p>Für den erwarteten Mittelwert errechnet sich die Varianz nach:</p>
<p><span class="math display">\[\begin{equation}
Var(\hat{\bar{y}}_{neu}) = \hat{\sigma}^2 \left[\frac{1}{n} + \frac{(x_{neu} - \bar{x})^2}{\sum(x_i - \bar{x})^2}\right] = \hat{\sigma}_{\hat{\bar{y}}_{neu}}^2
\end{equation}\]</span></p>
<p>Das dazugehörige Konfidenzintervall errechnet sich danach mittels:</p>
<p><span class="math display">\[\begin{equation}
\hat{\bar{y}}_{neu} \pm q_{t(1-\alpha/2;n-2)} \times \hat{\sigma}_{\hat{\bar{y}}_{neu}}
\end{equation}\]</span></p>
<p>Die Varianz für die Vorhersage eines einzelnen Wertes errechnet sich:</p>
<p><span class="math display">\[\begin{equation}
Var(\hat{y}_{neu}) = \hat{\sigma}^2 \left[1 + \frac{1}{n} + \frac{(x_{neu} - \bar{x})^2}{\sum(x_i - \bar{x})^2}\right] = \hat{\sigma}^2 + \hat{\sigma}_{\hat{\bar{y}}_{neu}}^2 = \hat{\sigma}_{\hat{y}_{neu}}^2
\end{equation}\]</span></p>
<p>Was wiederum zu dem folgenden Konfidenzintervall führt:</p>
<p><span class="math display">\[\begin{equation}
\hat{y}_{neu} \pm q_{t(1-\alpha/2;n-2)} \times \hat{\sigma}_{\hat{y}_{neu}}
\end{equation}\]</span></p>
<p>In beiden Fällen ist der Term</p>
<p><span class="math display">\[
\frac{(x_{neu} - \bar{x})^2}{\sum(x_i - \bar{x})^2}
\]</span></p>
<p>enthalten. Anhand des Zählers kann abgeleitet werden, dass die Unsicherheit der Vorhersage mit dem Abstand vom Mittelwert der <span class="math inline">\(x\)</span>-Werte zunimmt. Rein heuristisch macht dies Sinn, da davon ausgegangen werden kann, dass um den Mittelwert der <span class="math inline">\(x\)</span>-Werte auch die meiste Information über <span class="math inline">\(y\)</span> vorhanden ist und dementsprechend umso weiter die Werte sich vom <span class="math inline">\(\bar{x}\)</span> entfernen die Information abnimmt. Im Nenner ist wiederum wie auch beim Standardfehler <span class="math inline">\(\sigma_{\beta_1}\)</span> des Steigungskoeffizienten <span class="math inline">\(\beta_1\)</span> zu sehen, dass die Varianz abnimmt mit der Streuung der <span class="math inline">\(x\)</span>-Werte. Daher, wenn eine Vorhersage in einem bestimmten Bereich von <span class="math inline">\(x\)</span>-Werten durchgeführt werden soll, dann sollte darauf geachtet werden möglichst diesen Bereich auch zu samplen um die Unsicherheit so klein wie möglich zu halten.</p>
</section>
<section id="vorhersagen-in-r-mit-predict" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="vorhersagen-in-r-mit-predict"><span class="header-section-number">8.3</span> Vorhersagen in R mit <code>predict()</code></h2>
<section id="erwarteter-mittelwert" class="level3" data-number="8.3.1">
<h3 data-number="8.3.1" class="anchored" data-anchor-id="erwarteter-mittelwert"><span class="header-section-number">8.3.1</span> Erwarteter Mittelwert</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">v_ms =</span> <span class="fl">11.5</span>) <span class="co"># oder tibble(v_ms = 11.5)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod, <span class="at">newdata =</span> df, <span class="at">interval =</span> <span class="st">'confidence'</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 8.614136 8.482039 8.746234</code></pre>
</div>
</div>
</section>
<section id="individuelle-werte" class="level3" data-number="8.3.2">
<h3 data-number="8.3.2" class="anchored" data-anchor-id="individuelle-werte"><span class="header-section-number">8.3.2</span> Individuelle Werte</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod, <span class="at">newdata =</span> df, <span class="at">interval =</span> <span class="st">'prediction'</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 8.614136 8.118445 9.109827</code></pre>
</div>
</div>
</section>
</section>
<section id="konfidenzintervalle-graphisch" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="konfidenzintervalle-graphisch"><span class="header-section-number">8.4</span> Konfidenzintervalle graphisch</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="slm_prediction_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Weiterführende Literatur sind <span class="citation" data-cites="kutner2005">Kutner u.&nbsp;a. (<a href="references.html#ref-kutner2005" role="doc-biblioref">2005</a>)</span></p>
</section>
<section id="r2-und-root-mean-square" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="r2-und-root-mean-square"><span class="header-section-number">8.5</span> <span class="math inline">\(R^2\)</span> und Root-mean-square</h2>
<div class="cell">

</div>
</section>
<section id="einfaches-modell" class="level2" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="einfaches-modell"><span class="header-section-number">8.6</span> Einfaches Modell</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>mod0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, simple)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod0)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x, data = simple)

Residuals:
      1       2       3       4 
-0.5817  0.9898 -0.2345 -0.1736 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   1.8414     0.7008   2.628    0.119
x             0.4574     0.3746   1.221    0.346

Residual standard error: 0.8376 on 2 degrees of freedom
Multiple R-squared:  0.4271,    Adjusted R-squared:  0.1406 
F-statistic: 1.491 on 1 and 2 DF,  p-value: 0.3465</code></pre>
</div>
</div>
</section>
<section id="nochmal-abweichungen" class="level2" data-number="8.7">
<h2 data-number="8.7" class="anchored" data-anchor-id="nochmal-abweichungen"><span class="header-section-number">8.7</span> Nochmal Abweichungen</h2>
<ol type="1">
<li><p><strong>Gesamtvarianz</strong>: <span class="math display">\[
SSTO := \sum_{i=1}^N (y_i - \bar{y})^2
\]</span></p></li>
<li><p><strong>Regressionsvarianz</strong>: <span class="math display">\[
SSR :=\sum_{i=1}^N(\hat{y}_i - \bar{y})^2
\]</span></p></li>
<li><p><strong>Residualvarianz</strong>: <span class="math display">\[
SSE := \sum_{i=1}^N (y_i - \hat{y}_i)^2
\]</span></p></li>
</ol>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="slm_prediction_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Minimalmodell der Abweichungen</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="verhältnis-von-ssr-zu-ssto" class="level2" data-number="8.8">
<h2 data-number="8.8" class="anchored" data-anchor-id="verhältnis-von-ssr-zu-ssto"><span class="header-section-number">8.8</span> Verhältnis von <span class="math inline">\(SSR\)</span> zu <span class="math inline">\(SSTO\)</span></h2>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="slm_prediction_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Perfekter Zusammenhang</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><span class="math display">\[
\frac{SSR}{SSTO} = 1
\]</span></p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="slm_prediction_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Kein Zusammenhang</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><span class="math display">\[
\frac{SSR}{SSTO} = 0
\]</span></p>
</section>
<section id="determinationskoeffizient-r2" class="level2" data-number="8.9">
<h2 data-number="8.9" class="anchored" data-anchor-id="determinationskoeffizient-r2"><span class="header-section-number">8.9</span> Determinationskoeffizient <span class="math inline">\(R^2\)</span></h2>
<p>Es gilt: <span class="math inline">\(SSTO = SSR + SSE\)</span></p>
<p><span class="math display">\[
R^2 = \frac{SSR}{SSTO} = 1 - \frac{SSE}{SSTO} \in [0,1]
\]</span> <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<section id="korrigierter-determinationskoeffizient-r_a2" class="level3" data-number="8.9.1">
<h3 data-number="8.9.1" class="anchored" data-anchor-id="korrigierter-determinationskoeffizient-r_a2"><span class="header-section-number">8.9.1</span> Korrigierter Determinationskoeffizient <span class="math inline">\(R_a^2\)</span></h3>
<p><span class="math display">\[
R_a^2 = 1 - \frac{\frac{SSE}{n-p}}{\frac{SSTO}{n-1}} = 1 - \frac{n-1}{n-p}\frac{SSE}{SSTO}
\]</span></p>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-kutner2005" class="csl-entry" role="doc-biblioentry">
Kutner, Michael H, Christopher J Nachtsheim, John Neter, und William Li. 2005. <em>Applied Linear Statistical Models</em>. 5. Aufl. McGraw-Hill Irwin New York.
</div>
</div>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Bei der einfachen Regression gilt: <span class="math inline">\(r_{xy} = \pm\sqrt{R^2}\)</span><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./slm_model_fit.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Modellfit</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./mlm_title.html" class="pagination-link">
        <span class="nav-page-text">Multiple Regression</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>