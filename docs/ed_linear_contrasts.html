<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>28&nbsp; Lineare Kontraste – Skriptum - Fortgeschrittene Statistik</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ed_crfd.html" rel="next">
<link href="./ed_crd.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-70a47bd5681a7291082a5b9f83d58762.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>
<script>

  MathJax = {

    tex: {

      tags: 'ams'  // should be 'ams', 'none', or 'all'

    }

  };

</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ed_title.html">Experimentelles Design</a></li><li class="breadcrumb-item"><a href="./ed_linear_contrasts.html"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Lineare Kontraste</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Skriptum - Fortgeschrittene Statistik</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vorwort</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./r_startup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Eine Einführung in die Programmiersprache R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Eine Übersicht über <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_vars_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Variablen und Datentypen in <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_flowcontrol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Ablaufkontrolle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Funktionen in <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Datenverarbeitung mit <code>tidyverse</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Datenvisualisierung mit <code>ggplot2</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_literate_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Literate programming in <code>R</code></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stats_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistik - Die Grundlagen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Eine kleine Welt der Unsicherheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_significance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Statistische Signifikanz</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Hypothesentests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Theoretische Verteilungen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_hypotheses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Weitere Grundlagen der Statistik</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./slm_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Das einfache Regressionmodell</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Einführung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Inferenz</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_model_fit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Modellfit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slm_prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Vorhersage</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./likelihood.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Maximum-Likelihood</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./mlm_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Einführung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_interactions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Interaktionseffekte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_dummy_coding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Integration von nominalen Variablen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_hierarchies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Modellhierarchien</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Polynome und Prädiktion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlm_lmm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Gemischte Lineare Modelle</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./ed_title.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelles Design</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Einführung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_reliability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Messfehler und Reliabilität</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_crd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Completely Randomized Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_linear_contrasts.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Lineare Kontraste</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_crfd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Completely Randomized Factorial Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_ancova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_crbd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Block Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ed_split_plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Split-Unit Designs</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix_math.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Mathematische Grundlagen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literatur</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#das-multiple-comparison-problem" id="toc-das-multiple-comparison-problem" class="nav-link active" data-scroll-target="#das-multiple-comparison-problem"><span class="header-section-number">28.1</span> Das multiple-comparison Problem</a></li>
  <li><a href="#kontraste-psi" id="toc-kontraste-psi" class="nav-link" data-scroll-target="#kontraste-psi"><span class="header-section-number">28.2</span> Kontraste <span class="math inline">\(\psi\)</span></a>
  <ul class="collapse">
  <li><a href="#struktur-von-kontrasten" id="toc-struktur-von-kontrasten" class="nav-link" data-scroll-target="#struktur-von-kontrasten"><span class="header-section-number">28.2.1</span> Struktur von Kontrasten</a></li>
  <li><a href="#varianz-von-kontrasten" id="toc-varianz-von-kontrasten" class="nav-link" data-scroll-target="#varianz-von-kontrasten"><span class="header-section-number">28.2.2</span> Varianz von Kontrasten</a></li>
  <li><a href="#hypothesentests-für-kontraste" id="toc-hypothesentests-für-kontraste" class="nav-link" data-scroll-target="#hypothesentests-für-kontraste"><span class="header-section-number">28.2.3</span> Hypothesentests für Kontraste</a></li>
  <li><a href="#konfidenzintervalle-von-kontrasten" id="toc-konfidenzintervalle-von-kontrasten" class="nav-link" data-scroll-target="#konfidenzintervalle-von-kontrasten"><span class="header-section-number">28.2.4</span> Konfidenzintervalle von Kontrasten</a></li>
  </ul></li>
  <li><a href="#einteilung-der-mehrfachvergleiche" id="toc-einteilung-der-mehrfachvergleiche" class="nav-link" data-scroll-target="#einteilung-der-mehrfachvergleiche"><span class="header-section-number">28.3</span> Einteilung der Mehrfachvergleiche</a>
  <ul class="collapse">
  <li><a href="#false-discovery-rate-fdr" id="toc-false-discovery-rate-fdr" class="nav-link" data-scroll-target="#false-discovery-rate-fdr"><span class="header-section-number">28.3.1</span> False Discovery Rate FDR </a></li>
  </ul></li>
  <li><a href="#mehrfachvergleiche-in-r" id="toc-mehrfachvergleiche-in-r" class="nav-link" data-scroll-target="#mehrfachvergleiche-in-r"><span class="header-section-number">28.4</span> Mehrfachvergleiche in <code>R</code></a>
  <ul class="collapse">
  <li><a href="#das-package-emmeans" id="toc-das-package-emmeans" class="nav-link" data-scroll-target="#das-package-emmeans"><span class="header-section-number">28.4.1</span> Das package <code>emmeans</code></a></li>
  <li><a href="#cohens-d-für-mehrfachvergleiche" id="toc-cohens-d-für-mehrfachvergleiche" class="nav-link" data-scroll-target="#cohens-d-für-mehrfachvergleiche"><span class="header-section-number">28.4.2</span> Cohen’s d für Mehrfachvergleiche</a></li>
  </ul></li>
  <li><a href="#bestimmung-des-replikationsfaktors-anhand-des-konfidenzintervalls" id="toc-bestimmung-des-replikationsfaktors-anhand-des-konfidenzintervalls" class="nav-link" data-scroll-target="#bestimmung-des-replikationsfaktors-anhand-des-konfidenzintervalls"><span class="header-section-number">28.5</span> Bestimmung des Replikationsfaktors anhand des Konfidenzintervalls</a></li>
  <li><a href="#vollständige-dokumentation-eines-crds" id="toc-vollständige-dokumentation-eines-crds" class="nav-link" data-scroll-target="#vollständige-dokumentation-eines-crds"><span class="header-section-number">28.6</span> Vollständige Dokumentation eines CRDs</a></li>
  <li><a href="#zum-weiterlesen" id="toc-zum-weiterlesen" class="nav-link" data-scroll-target="#zum-weiterlesen"><span class="header-section-number">28.7</span> Zum Weiterlesen</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ed_title.html">Experimentelles Design</a></li><li class="breadcrumb-item"><a href="./ed_linear_contrasts.html"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Lineare Kontraste</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Lineare Kontraste</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Bei der Analyse eines CRDs ist bisher nur untersucht worden, ob es <em>irgendwo</em> zwischen den verschiedenen Faktorstufen einen relevanten Unterschied gibt. Im nächsten Schritt soll daher nun bestimmt werden zwischen welchen der verschiedenen Faktorstufen ein Unterschied besteht. D.h. es müssen immer paarweise Vergleiche zwischen den Faktorstufen durchgeführt werden, um zu überprüfen zwischen welchen ein Unterschied besteht. Im einfachen Fall aus dem Laufbeispiel mit drei Faktorstufen (Koffein, Placebo und Control, siehe <a href="#fig-ed-lc-01" class="quarto-xref">Abbildung&nbsp;<span>28.1</span></a>) können daher drei verschiedene paarweise Vergleiche durchgeführt werden.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ed-lc-01" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ed-lc-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_linear_contrasts_files/figure-html/fig-ed-lc-01-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ed-lc-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;28.1: Einfluss von Koffeine auf die Laufleistung über 8km
</figcaption>
</figure>
</div>
</div>
</div>
<p>D.h. in dem Beispiel können Koffein mit Placebo, Koffein mit Control und Placebo mit Control miteinander verglichen werden. In allen drei Fällen werden die Mittelwerte <span class="math inline">\(\mu_i\)</span> der jeweiligen Faktorstufen miteinander verglichen.</p>
<p>Ein Problem bei diesen Vergleich ist allerdings, dass jede Faktorstufe in mehreren (im Beispiel zwei) Vergleichen beteiligt ist. Wenn nun mehr Faktorstufen vorhanden sind, dann ist entsprechend jeder Gruppenmittel noch öfter in den paarweisen vergleichen beteiligt. Allgemein gilt bei <span class="math inline">\(K\)</span>-Faktorstufen:</p>
<p><span class="math display">\[\begin{equation}
\text{Anzahl der Paarvergleiche} = K(K-1)
\end{equation}\]</span></p>
<p>Dadurch, das jeder Mittelwert <span class="math inline">\(\mu_i\)</span> in mehreren Vergleichen beteiligt ist, führt dies zu dem Problem der <strong>Mehrfachvergleiche</strong> .</p>
<section id="das-multiple-comparison-problem" class="level2" data-number="28.1">
<h2 data-number="28.1" class="anchored" data-anchor-id="das-multiple-comparison-problem"><span class="header-section-number">28.1</span> Das multiple-comparison Problem</h2>
<p>Allgemein gilt, wenn mehrere statistische Tests durchgeführt werden und der <span class="math inline">\(\alpha\)</span>-Fehler betrachtet wird, dann folgt über die Gesamtheit der Tests, dass der <span class="math inline">\(\alpha\)</span>-Fehler für einen individuellen Test nicht mehr gleich dem nominalen Level, also <span class="math inline">\(\alpha = 0.05\)</span> ist. Tatsächlich ist der <span class="math inline">\(\alpha\)</span>-Fehler in diesem Fall deutlich höher als <span class="math inline">\(\alpha = 0.05\)</span>. Werden beispielsweise <span class="math inline">\(100\)</span> verschiedene Tests auf dem gleichen Datensatz durchgeführt, dann würden unter der Annahme, dass die <span class="math inline">\(H_0\)</span> zutrifft, im Mittel <span class="math inline">\(5\)</span> Tests <em>statistisch signifikant</em> werden, ohne das ein Effekt besteht. Daher könnte eine Strategie sein, möglichst viele unterschiedliche Tests auf einem Datensatz durchzuführen, irgendeiner davon wird schon signifikant werden.</p>
<p>Die Überlegung dazu ist die Folgende. Es werden <span class="math inline">\(m\)</span> Hypothesen getestet. Jede dieser Hypothese soll für sich genommen eine Irrtumswahrscheinlichkeit von <span class="math inline">\(\alpha\)</span> haben und in allen Fällen sei die <span class="math inline">\(H_0\)</span> zutreffend. Dann haben ist für jeden einzelnen Test die Wahrscheinlichkeit eine korrekte Entscheidung zu treffen <span class="math inline">\(P(\text{korrekt Entschieden}) = 1 - \alpha\)</span>. Wenn nun <span class="math inline">\(m\)</span> unabhängige Hypothesentestungen durchführt werden, wird die Wahrscheinlichkeit sich korrekt zu entscheiden insgesamt <span class="math inline">\(m\)</span>-Mal miteinander multipliziert.</p>
<p><span class="math display">\[\begin{equation}
P(\text{korrekte Entscheidung}) = (1-\alpha)\cdots(1-\alpha) = (1-\alpha)^m
\end{equation}\]</span></p>
<p>Das Komplementär dieser Wahrscheinlichkeit ist dann die Wahrscheinlichkeit mindestens eine <em>falsche</em> Entscheidung zu treffen. Daraus folgt, dass diese Wahrscheinlichkeit, mindestens einen <span class="math inline">\(\alpha\)</span>-Fehler zu begehen, folgt <span class="math inline">\(1 - P(\text{korrekte Entscheidung})\)</span> ist.</p>
<p><span class="math display">\[\begin{equation}
P(\text{min. }1\text{ Type-I Fehler}) = 1 - (1-\alpha)^m
\end{equation}\]</span></p>
<p>Wird diese Wahrscheinlichkeit gegen die Anzahl der Test abgetragen, ergibt sich der folgende Zusammenhang (siehe <a href="#fig-ed-lc-02" class="quarto-xref">Abbildung&nbsp;<span>28.2</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ed-lc-02" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ed-lc-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_linear_contrasts_files/figure-html/fig-ed-lc-02-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ed-lc-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;28.2: Inflation des <span class="math inline">\(\alpha\)</span>-Fehlers mit <span class="math inline">\(\alpha=0.05\)</span>
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-ed-lc-02" class="quarto-xref">Abbildung&nbsp;<span>28.2</span></a> ist zu erkennen, dass die Wahrscheinlichkeit für mindestens einen <span class="math inline">\(\alpha\)</span> sehr schnell mit der Anzahl der Tests ansteigt. D.h. ab etwa 15 Tests liegt die Wahrscheinlichkeit für ein statistisch signifikantes Ergebnis bei etwas über <span class="math inline">\(50\%\)</span>. Daher, umso mehr Tests in einer Untersuchung durchgeführt werden, umso höher die Wahrscheinlichkeit, dass ein Test <em>anspringt</em>. Um dieses Problem einzufangen, sollte daher für die Anzahl der Tests kontrolliert werden (siehe allerdings <span class="citation" data-cites="rothman1990">Rothman (<a href="references.html#ref-rothman1990" role="doc-biblioref">1990</a>)</span> für eine Gegenposition).</p>
<p>Ein Umstand macht die Kontrolle der <span class="math inline">\(\alpha\)</span>-Fehlerrate allerdings etwas undurchsichtig, da nicht eindeutig ist auf welchem Level die Fehlerkontrolle stattfinden soll. In <a href="#fig-ed-lc-errors" class="quarto-xref">Abbildung&nbsp;<span>28.3</span></a> ist die typische Struktur eines Experiments dargestellt.</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div id="fig-ed-lc-errors" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ed-lc-errors-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>
<svg width="672" height="288" viewbox="0.00 0.00 489.00 306.40" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 302.4)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-302.4 485,-302.4 485,4 -4,4"></polygon>
<g id="clust1" class="cluster">
<title>cluster_0</title>
<polygon fill="lightgray" stroke="black" points="8,-177.6 8,-254.4 382,-254.4 382,-177.6 8,-177.6"></polygon>
<text text-anchor="middle" x="195" y="-237.8" font-family="Times,serif" font-size="14.00">Experiment wise error rate</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_1</title>
<polygon fill="lightgray" stroke="black" points="190,-92.8 190,-169.6 397,-169.6 397,-92.8 190,-92.8"></polygon>
<text text-anchor="middle" x="293.5" y="-153" font-family="Times,serif" font-size="14.00">Family wise error rate</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_2</title>
<polygon fill="lightgray" stroke="black" points="219,-8 219,-84.8 473,-84.8 473,-8 219,-8"></polygon>
<text text-anchor="middle" x="346" y="-68.2" font-family="Times,serif" font-size="14.00">Error rate per test</text>
</g>
<!-- Ex -->
<g id="node1" class="node">
<title>Ex</title>
<ellipse fill="none" stroke="black" cx="200" cy="-280.4" rx="56.17" ry="18"></ellipse>
<text text-anchor="middle" x="200" y="-276.2" font-family="Times,serif" font-size="14.00">Experiment</text>
</g>
<!-- E1 -->
<g id="node2" class="node">
<title>E1</title>
<ellipse fill="magenta" stroke="black" cx="294" cy="-203.6" rx="79.94" ry="18"></ellipse>
<text text-anchor="middle" x="294" y="-199.4" font-family="Times,serif" font-size="14.00">Primary Endpoint</text>
</g>
<!-- Ex&#45;&#45;E1 -->
<g id="edge1" class="edge">
<title>Ex--E1</title>
<path fill="none" stroke="black" d="M219.93,-263.54C235.56,-251.1 257.25,-233.84 273.12,-221.22"></path>
</g>
<!-- E2 -->
<g id="node3" class="node">
<title>E2</title>
<ellipse fill="magenta" stroke="black" cx="106" cy="-203.6" rx="89.73" ry="18"></ellipse>
<text text-anchor="middle" x="106" y="-199.4" font-family="Times,serif" font-size="14.00">Secondary Endpoint</text>
</g>
<!-- Ex&#45;&#45;E2 -->
<g id="edge2" class="edge">
<title>Ex--E2</title>
<path fill="none" stroke="black" d="M180.07,-263.54C164.44,-251.1 142.75,-233.84 126.88,-221.22"></path>
</g>
<!-- F1 -->
<g id="node4" class="node">
<title>F1</title>
<ellipse fill="orange" stroke="black" cx="346" cy="-118.8" rx="43.48" ry="18"></ellipse>
<text text-anchor="middle" x="346" y="-114.6" font-family="Times,serif" font-size="14.00">Faktor 1</text>
</g>
<!-- E1&#45;&#45;F1 -->
<g id="edge3" class="edge">
<title>E1--F1</title>
<path fill="none" stroke="black" d="M304.77,-185.44C313.82,-171.04 326.66,-150.6 335.59,-136.37"></path>
</g>
<!-- F2 -->
<g id="node5" class="node">
<title>F2</title>
<ellipse fill="orange" stroke="black" cx="241" cy="-118.8" rx="43.48" ry="18"></ellipse>
<text text-anchor="middle" x="241" y="-114.6" font-family="Times,serif" font-size="14.00">Faktor 2</text>
</g>
<!-- E1&#45;&#45;F2 -->
<g id="edge4" class="edge">
<title>E1--F2</title>
<path fill="none" stroke="black" d="M283.02,-185.44C273.8,-171.04 260.72,-150.6 251.61,-136.37"></path>
</g>
<!-- Y1 -->
<g id="node6" class="node">
<title>Y1</title>
<ellipse fill="yellow" stroke="black" cx="431" cy="-34" rx="33.63" ry="18"></ellipse>
<text text-anchor="middle" x="431" y="-29.8" font-family="Times,serif" font-size="14.00">MW1</text>
</g>
<!-- F1&#45;&#45;Y1 -->
<g id="edge5" class="edge">
<title>F1--Y1</title>
<path fill="none" stroke="black" d="M367.3,-102.88C374.47,-97.5 382.33,-91.17 389,-84.8 399.96,-74.33 410.95,-61.18 418.94,-51.02"></path>
</g>
<!-- Y2 -->
<g id="node7" class="node">
<title>Y2</title>
<ellipse fill="yellow" stroke="black" cx="346" cy="-34" rx="33.63" ry="18"></ellipse>
<text text-anchor="middle" x="346" y="-29.8" font-family="Times,serif" font-size="14.00">MW2</text>
</g>
<!-- F1&#45;&#45;Y2 -->
<g id="edge6" class="edge">
<title>F1--Y2</title>
<path fill="none" stroke="black" d="M346,-100.64C346,-86.43 346,-66.34 346,-52.13"></path>
</g>
<!-- Y3 -->
<g id="node8" class="node">
<title>Y3</title>
<ellipse fill="yellow" stroke="black" cx="261" cy="-34" rx="33.63" ry="18"></ellipse>
<text text-anchor="middle" x="261" y="-29.8" font-family="Times,serif" font-size="14.00">MW3</text>
</g>
<!-- F1&#45;&#45;Y3 -->
<g id="edge7" class="edge">
<title>F1--Y3</title>
<path fill="none" stroke="black" d="M324.7,-102.88C317.53,-97.5 309.67,-91.17 303,-84.8 292.04,-74.33 281.05,-61.18 273.06,-51.02"></path>
</g>
</g>
</svg>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ed-lc-errors-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;28.3: Beispiel für die entstehende Hierarchie von Fehlern bei Mehrfachvergleichen bei einem Experiment.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In dem Beispiel sind zwei Endpunkte in dem Experiment geplant gewesen (Primary und Secondary Endpoint). Diese könnte zum Beispiel die Squad und die Hip thrust Leistung in der Stichprobe sein. Beide Endpunkte wurden unter jeweils zwei verschiedenen Faktoren untersucht (z.B. Ernährungsergänzung und Kontrolle). Faktor 1 besitzt drei Faktorstufen. D.h. es können drei paarweise Vergleiche zwischen den Mittelwerten (MW) der drei Stufen durchgeführt werden. Ähnliches trifft aber auch auf Faktor 2 zu. Bei zwei Endpunkten verdoppelt sich noch einmal die Anzahl der Test bzw. wenn bei noch weitere Endpunkte haben entsprechend mehr.</p>
<p>Dies führt dazu, dass mehrere Ebenen vorliegen, auf denen ein Fehlerkontrollmechanismus ansetzen kann. Die Kontrolle kann entweder auf der Ebene der Endpunkte, der Ebene der Faktoren innerhalb eines Endpunktes oder auf der Ebene der einzelnen Faktorstufen innerhalb eines Faktors innerhalb eines Endpunktes kontrolliert werden. Von oben nach unten werden diese Ebenen als <em>Experiment</em> , <em>family</em> und <em>test</em> wise error rates bezeichnet. Die Kontrolle ist dabei von unten nach oben immer strikter da die Anzahl der zu berücksichtigenden Test immer größer wird. Dazu kommt, dass es leider in der Literatur dazu keinen klaren Konsens gibt auf welcher Ebene die Mehrfachtestung berücksichtigt werden sollte. In den meisten Fällen wird daher auf der <em>test</em>-Ebene kontrolliert.</p>
</section>
<section id="kontraste-psi" class="level2" data-number="28.2">
<h2 data-number="28.2" class="anchored" data-anchor-id="kontraste-psi"><span class="header-section-number">28.2</span> Kontraste <span class="math inline">\(\psi\)</span></h2>
<p>Im folgenden wird ein etwas allgemeineres Rahmenwerk aufgebaut um Vergleiche zwischen Faktorstufen durchzuführen. Dazu wird zunächst das Konzept eines Kontrasts für Mittelwertsvergleiche benötigt.Ein Kontrast <span class="math inline">\(\psi\)</span> ist dabei ein Spezialfall einer sogenannten Linearkombination . Allgemein hat eine Linearkombination die folgende Form.</p>
<p><span class="math display">\[\begin{equation*}
\sum_{i=1}^K c_i \cdot a_i
\end{equation*}\]</span></p>
<p>Eine Linearkombination besteht aus der Summe von Produkten bei denen jeweils ein Element <span class="math inline">\(a_i\)</span> mit einem Faktor <span class="math inline">\(c_i\)</span> multipliziert wird. Die <span class="math inline">\(c_i\)</span>s werden als Gewichte bezeichnet, daher wird auch oft in der Literatur die Schreibweise <span class="math inline">\(w_i \cdot a_i\)</span> verwendet vom Englischen <span class="math inline">\(w\)</span>eights. Seien zum Beispiel ein Vektor <span class="math inline">\(\boldsymbol{a}\)</span> mit den Elementen <span class="math inline">\(\boldsymbol{a} = (1,2,3)\)</span> und ein Gewichtsvektor mit den Elementen <span class="math inline">\(\boldsymbol{c} = (1/2,1/2,1/3)\)</span> gegeben. Dann hat die entsprechende Linearkombination die folgende Form:</p>
<p><span class="math display">\[\begin{equation}
\sum_{i=1}^K c_i \cdot a_i = \frac{1}{2}\cdot 1 + \frac{1}{2}\cdot 2 + \frac{1}{3}\cdot 3 = 2\frac{1}{2}
\label{eq-ed-lc-ex-01}
\end{equation}\]</span></p>
<p>Ein Kontrast <span class="math inline">\(\psi\)</span> ist nun ein Spezialfall einer Linearkombination. Beim einem Kontrast sind die Gewichte <span class="math inline">\(a_i\)</span> so gewählt, dass die Summe der Gewichte <span class="math inline">\(a_i\)</span> Null ergibt. D.h. es gilt:</p>
<p><span class="math display">\[\begin{equation*}
\psi = \sum_{i=1}^K c_i \cdot a_i \quad \text{mit } \sum_{i=1}^K c_i = 0
\end{equation*}\]</span></p>
<p>Das vorhergehende Beispiel der Linearkombination in Formel <span class="math inline">\(\eqref{eq-ed-lc-ex-01}\)</span> stellt somit keinen Kontrast dar, da <span class="math inline">\(1/2 + 1/2 + 1/3 = 1\frac{1}{3} \neq 0\)</span> gilt. Dagegen wäre die folgende Linearkombination mit <span class="math inline">\(\boldsymbol{c} = (1/2,1/2,-1)\)</span> ein Kontrast, da <span class="math inline">\(\frac{1}{2} + \frac{1}{2} - 1 = 0\)</span>.</p>
<p><span class="math display">\[\begin{equation*}
\sum_{i=1}^K c_i \cdot a_i = \frac{1}{2}\cdot 1 + \frac{1}{2}\cdot 2 - \frac{1}{3}\cdot 3
\end{equation*}\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tipp
</div>
</div>
<div class="callout-body-container callout-body">
<p>Linearkombination können in <code>R</code> einfach über das Skalarprodukt berechnet werden.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>c_i <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>a_i <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(a_i) <span class="sc">%*%</span> c_i</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]  2.5</code></pre>
</div>
</div>
<p>Was einen Spezialfall des Matrizenprodukts darstellt.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">nr=</span><span class="dv">2</span>, <span class="at">byrow=</span>T)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>mat</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    1    2    3
[2,]    4    5    6</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>mat <span class="sc">%*%</span> c_i</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]  2.5
[2,]  6.5</code></pre>
</div>
</div>
</div>
</div>
<section id="struktur-von-kontrasten" class="level3" data-number="28.2.1">
<h3 data-number="28.2.1" class="anchored" data-anchor-id="struktur-von-kontrasten"><span class="header-section-number">28.2.1</span> Struktur von Kontrasten</h3>
<p>Seien nun die Elemente von <span class="math inline">\(\boldsymbol{a}\)</span> die Modellparameter eines statistischen Models, die Modellparameter könnten z.B. die Mittelwerte dreier Faktorstufen bilden. Dann ergibt sich die folgende Definition für einen Kontrast:</p>
<div id="def-contrast" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 28.1 (Kontrast)</strong></span> Ein Kontrast <span class="math inline">\(\psi\)</span> ist eine Linearkombination von Modellparametern deren Koeffizienten sich zu Null addieren.</p>
</div>
<p>Zum Beispiel der Fall des CRD Modells mit einem Faktor und <span class="math inline">\(K\)</span> Faktorstufen.</p>
<p><span class="math display">\[\begin{equation*}
Y_{ij} = \mu + \tau_i + \epsilon_{ij}
\end{equation*}\]</span></p>
<p>Die jeweiligen Effekte der Faktorstufen werden durch die Parameter <span class="math inline">\(\tau_i,i=1,\ldots,K\)</span> (die Abweichungen der Gruppenmittelwerte <span class="math inline">\(\mu_i\)</span> vom Gesamtmittelwert <span class="math inline">\(\mu\)</span>, repräsentiert. Die allgemeine Form eines Kontrasts <span class="math inline">\(\psi\)</span> für ein CRD Modell hat dann die Form:</p>
<p><span class="math display">\[\begin{equation}
\psi = \sum_{i=1}^k c_i \tau_i, \quad \text{mit } \sum_{i=1}^k c_i=0
\label{eq-ed-lc-crd-con}
\end{equation}\]</span></p>
<p>In den meisten Fällen werden mittels eines Kontrasts die Mittelwerte <span class="math inline">\(\mu_i\)</span> der Faktorstufen miteinander verglichen. Der Effekt der <span class="math inline">\(i\)</span>-ten Stufe, der Mittelwert der <span class="math inline">\(i\)</span>-ten Stufe, setzt sich nach dem Modell zusammen aus der Summe aus dem Gesamtmittelwert <span class="math inline">\(\mu\)</span> und dem Effekt der Faktorstufe <span class="math inline">\(\tau_i\)</span>. D.h. <span class="math inline">\(\mu_i = \mu + \tau_i\)</span> und dieser ist bei einem CRD gleich dem Gruppenmittelwert <span class="math inline">\(\bar{y}_i\)</span>. D.h. ein Schätzer für einen Kontrast <span class="math inline">\(\hat{\psi}\)</span> hat die Form.</p>
<p><span class="math display">\[\begin{equation}
\hat{\psi} = \sum_{i=1}^K c_i (\hat{\mu} + \hat{\tau_i}) = \sum_{i=1}^K c_i \bar{y}_{i}
\end{equation}\]</span></p>
<p>Unter Verwendung der Eigenschaft, dass die Summe der Gewichte <span class="math inline">\(c_i\)</span> eines Kontrasts <span class="math inline">\(\psi\)</span> zu <span class="math inline">\(0\)</span> addieren, gilt:</p>
<p><span class="math display">\[\begin{equation*}
\psi=\sum_{i=1}^Kc_i(\mu + \tau_i) = \sum_{i=1}^Kc_i \mu + \sum_{i=1}^K c_i\tau_i=\mu\underbrace{\sum_{i=1}^K c_i}_{=0} + \sum_{i=1}^K c_i\tau_i = \sum_{i=1}^K c_i\tau_i
\end{equation*}\]</span></p>
<p>Beim vorliegen von Daten, kommen überall über die Variablen die üblichen Hütchen für Schätzer und aus <span class="math inline">\((\hat{\mu}+\hat{\tau}_i\)</span> wird <span class="math inline">\(\bar{y}_{i}\)</span>. D.h. über den Vergleich der Mittelwerte <span class="math inline">\(\bar{y}_i\)</span> mittels eines Kontrast können die Modellparameter <span class="math inline">\(\tau_i\)</span> miteinander verglichen werden.</p>
<p>Durch eine geschickte Kombination von <span class="math inline">\(c_i\)</span> können nun gewünschte Gruppenvergleiche durchgeführt werden. Im Beispiel der Laufdaten, können mittels des folgenden Schemas von <span class="math inline">\(c_i\)</span>s die paarweisen Gruppenvergleich als Kontraste definiert werden (siehe <a href="#tbl-ed-lc-contrast-01" class="quarto-xref">Tabelle&nbsp;<span>28.1</span></a>).</p>
<div id="tbl-ed-lc-contrast-01" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ed-lc-contrast-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;28.1: Paarvergleiche der Gruppen aus dem Beispiel
</figcaption>
<div aria-describedby="tbl-ed-lc-contrast-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Kontrast</th>
<th>Koffein <span class="math inline">\((c_1)\)</span></th>
<th>Placebo <span class="math inline">\((c_2)\)</span></th>
<th>Control <span class="math inline">\((c_3)\)</span></th>
<th><span class="math inline">\(\sum_{i=1}^K c_i\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\Delta_{\text{Koffein-Placebo}}\)</span></td>
<td><span class="math inline">\(1\)</span></td>
<td><span class="math inline">\((-1)\)</span></td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\Delta_{\text{Koffein-Control}}\)</span></td>
<td><span class="math inline">\(1\)</span></td>
<td><span class="math inline">\(0\)</span></td>
<td><span class="math inline">\((-1)\)</span></td>
<td>0</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\Delta_{\text{Placebo-Control}}\)</span></td>
<td><span class="math inline">\(0\)</span></td>
<td><span class="math inline">\(1\)</span></td>
<td><span class="math inline">\((-1)\)</span></td>
<td>0</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>An einem Beispiel wird mit konkreten Zahlen kann das Schema besser nachvollzogen werden. In <a href="#tbl-ed-lc-coffein-psi" class="quarto-xref">Tabelle&nbsp;<span>28.2</span></a> sind die Gruppenmittelwerte aus dem Koffeinbeispiel mit den Laufdaten abgebildet.</p>
<div class="cell">
<div id="tbl-ed-lc-coffein-psi" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ed-lc-coffein-psi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;28.2: Gruppenmittelwerte aus der Koffeinstudie
</figcaption>
<div aria-describedby="tbl-ed-lc-coffein-psi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Gruppe</th>
<th style="text-align: right;"><span class="math inline">\(\bar{y}_{i.}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Koffein</td>
<td style="text-align: right;">1914.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Placebo</td>
<td style="text-align: right;">1924.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Control</td>
<td style="text-align: right;">1927.5</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Es soll nun ein Vergleich zwischen den Gruppen Koffein und Placebo bestimmt werden. Dazu werden aus <a href="#tbl-ed-lc-contrast-01" class="quarto-xref">Tabelle&nbsp;<span>28.1</span></a> die Gewichte aus der ersten Zeile <span class="math inline">\(\Delta_{\text{K-C}} = (1,-1,0)\)</span> ausgewählt. Mit Hilfe dieser Gewichte wird nun die Linearkombination mit den Mittelwerten aus <a href="#tbl-ed-lc-coffein-psi" class="quarto-xref">Tabelle&nbsp;<span>28.2</span></a> gebildet. Damit ergibt sich der folgende Term.</p>
<p><span class="math display">\[\begin{equation*}
\hat{\psi}_{\text{K-C}} = \sum_{i=1}^k c_i \bar{y}_{i.} = 1 \cdot 1914.2 + (-1) \cdot 1924.7 + 0 \cdot 1927.5 = -10.5
\end{equation*}\]</span></p>
<p>Somit wird für den paarweisen Vergleich zwischen den Faktorstufen Koffein und Placebo ein Unterschied von <span class="math inline">\(-10.5\)</span> geschätzt. Die beiden verbleibenden paarweisen Vergleichen können parallel durchgeführt werden.</p>
<p>Allgemein wird zwischen zwei Arten von Kontrasten unterschieden: <strong>Einfache Kontraste</strong> und <strong>komplexe Kontraste</strong>. Einfache Kontraste sind paarweisen Vergleiche während alle anderen Arten von Kontrasten als komplexe Kontraste bezeichnet werden. Im Beispiel ist zu erkennen, dass bei paarweisen Kontrasten immer ein Kontrastgewicht auf <span class="math inline">\(c_i = 1\)</span> und ein weiteres Gewicht auf <span class="math inline">\(c_j = -1\)</span> gesetzt wird. Die verbleibenden Gewichte werden alle auf <span class="math inline">\(c_l = 0, \forall l \neq i,j\)</span> gesetzt.</p>
<p>Als nächstes wird nun ein komplexer Kontrast erstellt. Zum Beispiel soll untersucht werden, ob es einen Unterschied zwischen der Kontrollgruppe und den beiden Gruppen die eine Pille bekommen haben gibt. D.h. es soll untersucht werden ob die Gabe einer Pille unabhängig davon ob in der Pille ein Wirkstoff (Koffein) oder nicht (Placebo) gewesen ist eine Wirkung auf die Laufleistung hat. Dazu kann die folgende Überlegung durchgefüht werden. Der Effekt der Gabe eine Pille kann als der mittlere Effekt der beiden Faktorstufen Placebo und Koffein angesehen werden. Dieser <em>mittlere</em> Effekt soll mit dem <em>Effekt</em> der Kontrollkondition verglichen werden.</p>
<p>Der mittlere Effekt von Placebo und Koffein ist einfach der Mittelwert der beiden Faktorstufen also <span class="math inline">\((\tau_{\text{Placebo}} + \tau_{\text{Koffein}})/2\)</span>. Mittels eines Kontrasts kann dieser Vergleich nun wie folgt operationalisiert werden.</p>
<p><span class="math display">\[\begin{equation*}
c_1 = \frac{1}{2}, c_2 = \frac{1}{2}, c_3 = -1
\end{equation*}\]</span></p>
<p>Die ersten beiden Gewichte <span class="math inline">\(c_1\)</span> und <span class="math inline">\(c_2\)</span> bilden den Mittelwerte der beiden Effekte Koffein und Placebo. Dieser Mittelwert der Mittelwerte wird soll num mit dem Mittelwert der Kontrollgruppe verglichen werden. Dazu bekommt der Mittelwert der Kontrollgruppe das Gewicht <span class="math inline">\(c_3 = -1\)</span>. Wenn nun die Summe der Gewichte gebildet, dann ergibt sich <span class="math inline">\(\frac{1}{2} + \frac{1}{2} - 1 = 0\)</span>. D.h. dieser Vergleich der Gruppenmittelwerte bildet einen Kontrast. Konkrete angewendet auf das Beispiel folgt somit:</p>
<p><span class="math display">\[\begin{equation*}
\hat{\psi} = \sum_{i=1}^k c_i \bar{y}_{i.} = \frac{1}{2} \cdot 1914.2 + \frac{1}{2} \cdot 1924.7 + (-1) \cdot 1927.5 = -8.05
\end{equation*}\]</span></p>
<p>D.h. der Effekt der Pillengabe unabhängig davon ob die Pille einen Wirkstoff enthält ist <span class="math inline">\(-8.05s\)</span>.</p>
<p>Zusammengefasst ermöglichen Kontraste beliebige Vergleiche zwischen mehreren Faktorstufen durchzuführen um Modellparameter miteinander zu vergleichen. Die üblichen paarweisen Vergleich bilden hierbei einen Spezialfall (einfache Kontraste) der allgemeineren komplexen Kontrasten. Um nun zu bewerten ob ein beobachteter Kontrast <span class="math inline">\(\psi_i\)</span> auch wirklich bedeutsam ist, ist die Kenntnis der Unsicherheit über den Kontrast notwendig. Daher wird nun als nächstes die Varianz <span class="math inline">\(Var(\psi_i)\)</span> eines Kontrasts <span class="math inline">\(\psi_i\)</span> bzw. der Standardfehler, die Wurzel der Varianz, betrachtet.</p>
</section>
<section id="varianz-von-kontrasten" class="level3" data-number="28.2.2">
<h3 data-number="28.2.2" class="anchored" data-anchor-id="varianz-von-kontrasten"><span class="header-section-number">28.2.2</span> Varianz von Kontrasten</h3>
<p>Um die Varianz von Kontrasten herzuleiten zu können, folgen zunächst noch einmal kurz ein Regeln die schon in Kapitel 12 behandelt wurden. Zunächst zur Wiederholung der Standardfehler des Mittelwerts, da dieser immer wieder auftauchen wird.</p>
<p><span class="math display">\[\begin{equation}
\sigma_{\bar{x}} = \frac{\sigma}{\sqrt{n}}
\end{equation}\]</span></p>
<p>Die Varianz des Mittelwerts ist dementsprechend das Quadrat des Standardfehlers <span class="math inline">\(\sigma_{\bar{x}}^2\)</span>. Sei beispielsweise der Mittelwert in der Stichprobe unter der <span class="math inline">\(i\)</span>-ten Faktorstufe <span class="math inline">\(\bar{Y}_i\)</span> mit der Stichprobengröße <span class="math inline">\(n_i\)</span>, dann gilt:</p>
<p><span class="math display">\[\begin{equation*}
Var(\bar{Y}_i) = \frac{\sigma^2}{n_i}
\end{equation*}\]</span></p>
<p>Im Beispiel war der Schätzer für der <code>Residual standard error</code> <span class="math inline">\(=6.6\)</span>. Daraus folgt für den Standardfehler des Mittelwerts für die Gruppe Koffein mit <span class="math inline">\(n_i = 20\)</span> pro Gruppe.</p>
<p><span class="math display">\[\begin{equation*}
s_{\text{Koffein}} = \frac{6.6}{\sqrt{20}} = 1.5
\end{equation*}\]</span></p>
<p>Die zweite wichtige Regel im Zusammenhang mit Kontrasten und deren Varianzen ist die Rechenregel für die Linearkombination von unabhängigen Zufallsvariablen die ebenfalls in Kapitel 12 behandelt wurde. Wichtig für die weiteren Herleitungen ist insbesondere das Beispiel <a href="stats_hypotheses.html#exm-ed-hypo-var-diff" class="quarto-xref">Beispiel&nbsp;<span>12.9</span></a>. Die allgemeine Regel lautet:</p>
<p><span class="math display">\[\begin{equation*}
Var\left(\sum_{i=1}^n a_i X_i\right) = \sum_{i=1}^n a_i^2 Var(X_i)
\end{equation*}\]</span></p>
<p>D.h. bei unabhängigen Zufallsvariablen, diese können beispielsweise die Mittelwerte der Gruppen sein da die Gruppen unabhängig voneinander sind, berechnet sich die Varianz der Linearkombination dadurch, dass die Gewichte <span class="math inline">\(a_i\)</span> quadriert werden und mit den Werten der Zufallsvariablen multipliziert werden. Anschließen erfolgt die Summation über alle Produkte.</p>
<p>Angewendet auf einen Kontrast <span class="math inline">\(\psi\)</span> folgt für die Varianz des Kontrast unter der Annahme das die Mittelwerte <span class="math inline">\(\bar{Y}_{i}\)</span> alle die gleiche Varianz <span class="math inline">\(\sigma^2\)</span> haben (die übliche Annahme der Homoskedastizität im linearen Modell), also <span class="math inline">\(Var(\bar{Y}_{i}) = \sigma^2\)</span>.</p>
<p><span class="math display">\[\begin{equation}
\begin{aligned}
Var(\psi) &amp;= Var\left(\sum c_i \bar{Y}_{i}\right) \\
&amp;= \sum c_i^2 Var(\bar{Y}_{i}) \quad\text{Anwendung der Regel} \\
  &amp;= \sum c_i^2(\sigma^2/n_i) \quad\text{Homoskedastizität}\\
  &amp;= \sigma^2\sum(c_i^2/n_i)
\end{aligned}
\label{eq-ed-lc-var-con-pop}
\end{equation}\]</span></p>
<p>D.h. die Kontrastgewichte <span class="math inline">\(c_i\)</span> werden quadriert und durch die jeweilige Stichprobengröße <span class="math inline">\(n_i\)</span> der <span class="math inline">\(i\)</span>-ten Faktorstufe geteilt. Anschließend wird die Summe über alle Quotienten gebildet und mit dem Standardfehler der Residuen multipliziert. Wie bisher immer geschene, wird die Varianz <span class="math inline">\(\sigma^2\)</span> anhand der Stichprobe mittels des <span class="math inline">\(MSE\)</span> bzw. in der Terminologie des CRD <span class="math inline">\(MS_{\text{within}}\)</span> abgeschätzt. Kurz zur Erinnerung, der <span class="math inline">\(MSE\)</span> ist die Quadratsumme der Residuen <span class="math inline">\(e_i\)</span> geteilt durch die Differenz der Stichprobengröße <span class="math inline">\(N\)</span> und der Anzahl der Parameter <span class="math inline">\(p\)</span>. Daraus folgt für die den Schätzer der Varianz des Kontrasts <span class="math inline">\(\widehat{Var}(\psi)\)</span>.</p>
<p><span class="math display">\[\begin{equation}
\widehat{Var}(\psi) = \widehat{Var}\left(\sum c_i \bar{y}_{i.}\right) = MS_w\sum (c_i^2/n_i)
\label{eq-ed-lc-var-con}
\end{equation}\]</span></p>
<p>Diese Formel ist die gleiche Formel die in Kapitel 23 bei der Einführung zum Experimentellen Design verwendet wurde, um die Verteilungen der Stichprobengrößen in die beiden Gruppen zu verteilen.</p>
<p>Um nun von der Varianz auf den Standardfehler des Kontrasts <span class="math inline">\(s_{\psi}\)</span> zu kommen, wird wie immer die Wurzel der Varianz gezogen. In der Benutzung der Symbole wird wieder der übliche Übergang <span class="math inline">\(\sqrt{\hat{\sigma}^2} = s\)</span> wie bei der Verwendung der Standardabweichung verwendet.</p>
<p><span class="math display">\[\begin{equation}
s_{\psi} = \sqrt{MS_w\sum (c_i^2/n_i)}
\label{eq-ed-lc-se-contrast}
\end{equation}\]</span></p>
<div class="line-block"><span class="math inline">\(n_i\)</span> = Stichprobengröße in Faktorstufe <span class="math inline">\(i\)</span><br>
<span class="math inline">\(\hat{\sigma}^2 = MS_w = MSE\)</span></div>
<p>Angewendet auf den Kontrast bei Paarvergleichen folgen für den Vergleich der Faktorstufen <span class="math inline">\(i\)</span> und <span class="math inline">\(j\)</span> dargestellt mittels der Kontrastgewichte <span class="math inline">\(c_i\)</span> die folgenden Terme <span class="math inline">\(c_i^2 = (1)^2, c_j^2 = (-1)^2\)</span> während alle anderen <span class="math inline">\(c_l = 0\)</span> sind.</p>
<p><span class="math display">\[\begin{equation}
Var(\psi) = Var\left(\tau_i - \tau_j\right) = \sigma^2\left(\frac{1}{n_i} + \frac{1}{n_j}\right)
\end{equation}\]</span></p>
<p>Hier wird der Äquivalenz zu der in Kapitel 23 verwendet Formel noch mal deutlicher. Wenn nun ein experimentelles Design verwendet wurde bei dem die Stichprobengrößen unter allen Faktorstufen gleich groß sind, also <span class="math inline">\(n_i = n_j = n\)</span>, gilt, dann kann diese Formel noch weiter vereinfacht werden. Mit der Festsetzung <span class="math inline">\(2n = N\)</span> folgt für den Standardfehler des Kontrasts <span class="math inline">\(\sigma_{\psi}\)</span> in der Population:</p>
<p><span class="math display">\[\begin{equation*}
\sigma_{\psi} = s_{\Delta} = \sqrt{\sigma^2\left(\frac{1}{N/2}
+\frac{1}{N/2}\right)}=\sqrt{\sigma^2\frac{2}{N/2}} = \sigma\sqrt\frac{4}{N}=\sigma \frac{2}{\sqrt{N}}
\end{equation*}\]</span></p>
<p>Beziehungsweise in der Stichprobe dann entsprechend.</p>
<p><span class="math display">\[\begin{equation}
s_{\psi} = s_{\Delta} = \sqrt{MSE}\frac{2}{\sqrt{N}}
\end{equation}\]</span></p>
<p>D.h. der Kontrast für den Vergleich zwischen zwei Mittelwerten hat im Vergleich zu Standardfehler des Mittelwerts die doppelte Größe. Insgesamt wird aber wieder der gleiche Wurzelzusammenhang enthalten, der dazu führt, dass der Standardfehler für den Kontrast mit zunehmender Stichprobengröße stetig abnimmt, aber die Abnahme mit größer werdenden Stichproben immer kleiner wird. Anders herum bei kleinen Stichprobengrößen führt jeder Hinzunahme von Stichproben zu einer <em>relativ</em> stärkeren Verkleinerung des Standardfehlers und damit zu einer Erhöhung der Power (siehe Kapitel 9).</p>
</section>
<section id="hypothesentests-für-kontraste" class="level3" data-number="28.2.3">
<h3 data-number="28.2.3" class="anchored" data-anchor-id="hypothesentests-für-kontraste"><span class="header-section-number">28.2.3</span> Hypothesentests für Kontraste</h3>
<p>Ein Hypothesentest für den Kontrast kann nun wieder nach dem üblichen Muster konstruiert werden indem die Größe des Kontrasts <span class="math inline">\(\hat{\psi}\)</span> anhand des Standardfehlers kalibriert wurde, also der Quotient aus dem Kontrast und dem Standardfehler <span class="math inline">\(s_{\psi}\)</span> gebildet wird. Die entsprechenden Hypothesen ergeben sich dann aus der Annahme das unter der <span class="math inline">\(H_0\)</span> der Kontrast den Wert Null annimmt und entsprechend unter der Alternativhypothese ungleich Null ist.</p>
<p><span class="math display">\[\begin{equation}
\begin{split}
H_{0,\psi}:  \sum_{i=1}^k c_i \tau_i = 0 \\
H_{1,\psi}:  \sum_{i=1}^k c_i \tau_i \neq 0
\end{split}
\end{equation}\]</span></p>
<p>Die resultierende Teststatistik <span class="math inline">\(t\)</span> ist dementsprechend der Quotient aus der Effektstärke, der Kontrast, normiert durch deren Standardfehler. Wenn dieses Verhältnis größer als ein kritischer Wert <span class="math inline">\(w\)</span> ist, kann die entsprechende <span class="math inline">\(H_0\)</span> abgelehnt werden. Es folgt somit:</p>
<p><span class="math display">\[\begin{equation}
\text{Lehne }H_0\text{ ab, wenn} \left|\frac{\sum_{i=1}^K c_k \tau_i}{\sqrt{MSE\sum_{i=1}^K c_i^2/n_i}}\right| &gt; w
\label{eq-ed-lc-w}
\end{equation}\]</span></p>
<p>Der kritische Wert <span class="math inline">\(w\)</span> ist wieder die Quantile <span class="math inline">\(q_{\alpha}\)</span> einer entsprechenden theoretischen Verteilung. Welche theoretische Verteilung gewählt werden muss, hängt nun davon welche Art der <span class="math inline">\(\alpha\)</span>-Kontrolle angewendet werden soll. Im folgenden Abschnitt werden verschiedene Methoden vorgestellt eine <span class="math inline">\(\alpha\)</span>-Kontrolle (family wise error rate) durchzuführen.</p>
</section>
<section id="konfidenzintervalle-von-kontrasten" class="level3" data-number="28.2.4">
<h3 data-number="28.2.4" class="anchored" data-anchor-id="konfidenzintervalle-von-kontrasten"><span class="header-section-number">28.2.4</span> Konfidenzintervalle von Kontrasten</h3>
<p>Nach dem bereits mehrfach verwendeten Muster können auch Konfidenzintervalle für einen Kontrast <span class="math inline">\(\psi\)</span> erstellt werden. Das Berechnungsmuster folgt dabei immer dem gleichen Schema (siehe auch Kapitel 10):</p>
<p><span class="math display">\[\begin{gather*}
\text{CI}(\hat{\psi}) = \sum_i c_i \hat{\tau}_i \pm w \sqrt{\widehat{Var}\left(\sum c_i \hat{\tau}_i\right)} = \hat{\psi} + w \times s_{\psi}\\
\text{estimate } \pm (\text{kritischer Wert}) \times (\text{Standardfehler})
\end{gather*}\]</span></p>
<p>Der Kontrastschätzer <span class="math inline">\(\hat{\psi}\)</span> bleibt dabei gleich und es ändert sich je nach gewählter Methode für Mehrfachvergleiche um das Gesamt-<span class="math inline">\(\alpha\)</span> zu kontrollieren der kritische Wert <span class="math inline">\(w\)</span>.</p>
</section>
</section>
<section id="einteilung-der-mehrfachvergleiche" class="level2" data-number="28.3">
<h2 data-number="28.3" class="anchored" data-anchor-id="einteilung-der-mehrfachvergleiche"><span class="header-section-number">28.3</span> Einteilung der Mehrfachvergleiche</h2>
<p>Mehrfachvergleiche können zunächst in zwei Arten unterschieden werden. Vergleiche die <strong>vor</strong> dem Experiment geplant wurden und Vergleiche die <strong>nach einsehen der Daten</strong> auf Basis der Ergebnisse durchgeführt werden. Vergleiche die vor der Durchführung des Experiments festgelegt werden, werden als <em>pre-planned</em> bezeichnet. Vergleiche die dagegen nach der Durchführung des Experiments nach der Einsicht der Daten durchgeführt werden, werden als <em>post-hoc</em> Vergleiche bezeichnet. Zwischen diesen beiden Vergleichen wird unterschieden, da bei den <em>post-hoc</em> dadurch, das die Daten schon bekannt sind, die Vergleiche durch die Daten beeinflusst werden. Daher muss in diesem Fall die Kontrolle strikter sein, als wenn die Vergleiche im Voraus geplant wurden.</p>
<p>In der Literatur sind mittlerweile zahllose unterschiedliche Arten vorhanden die <span class="math inline">\(\alpha\)</span>-Kontrolle bei Mehrfachvergleiche durchzuführen. Die Unterschiede zielen dabei immer darauf ab, die <span class="math inline">\(\alpha\)</span>-Kontrolle zu gewährleisten und dabei aber die Power nicht zu stark zu verkleinern. Im Folgenden wird nur eine kleine Auswahl der üblichsten Methoden besprochen. In <a href="#tbl-ed-lc-contype" class="quarto-xref">Tabelle&nbsp;<span>28.3</span></a> sind die Bonferroni, Tukey, Scheffé, Dunnet und die FisherLSD Korrekturmethoden inklusive der Art der Kontraste tabellarisch dargestellt.</p>
<div id="tbl-ed-lc-contype" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ed-lc-contype-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;28.3: Systematik Mehrfachvergleiche
</figcaption>
<div aria-describedby="tbl-ed-lc-contype-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Zeitpunkt</th>
<th>Kontraste</th>
<th>Kontrolliert</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Bonferroni</td>
<td>pre-planned</td>
<td>einfache und komplexe</td>
<td>Ja</td>
</tr>
<tr class="even">
<td>Tukey</td>
<td>pre-planned</td>
<td>alle paarweisen</td>
<td>Ja</td>
</tr>
<tr class="odd">
<td>Scheffé</td>
<td>post-hoc</td>
<td>einfache und komplexe</td>
<td>Ja</td>
</tr>
<tr class="even">
<td>Dunnet</td>
<td>pre-planned</td>
<td>paarweise TRT gegen CON</td>
<td>Ja</td>
</tr>
<tr class="odd">
<td>FisherLSD</td>
<td>post-hoc</td>
<td>einfache und komplexe</td>
<td>Nein<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Die <strong>Bonferroni-Korrektur</strong> ist in der Literatur weit verbreitet, da sie relativ einfach durchzuführen ist. Die <span class="math inline">\(\alpha\)</span>-Korrektur wird erreicht, indem ein <em>korrigiertes</em> Signifikanzlevel <span class="math inline">\(\alpha^*\)</span> berechnet wird. Sind in einer Analyse <span class="math inline">\(m\)</span> Kontraste zu berechnen, dann errechnet sich das korrigierte <span class="math inline">\(\alpha\)</span>-Level mittels.</p>
<p><span class="math display">\[\begin{equation*}
\alpha^* = \alpha / m
\end{equation*}\]</span></p>
<p>Die Bonferroni-Korrektur kontrolliert dadurch das Gesamt-<span class="math inline">\(\alpha\)</span> und ist anwendbar bei einfachen und/oder komplexen Kontraste. Allerdings, müssen diese Kontraste <strong>pre-planned</strong> sein, d.h. die Vergleiche müssen vor Einsicht in die Daten festgelegt worden sein. Die Bonferroni-Methode ist üblicherweise eher konservativ d.h. die Power ist eher gering. Dies gilt insbesondere wenn die Anzahl der Test <span class="math inline">\(m\)</span> groß ist und dadurch <span class="math inline">\(\alpha^*\)</span> relativ schnell sehr klein wird. Der kritische Wert in Formel <span class="math inline">\(\eqref{eq-ed-lc-w}\)</span> wird unter der Bonferroni-Korrektur mittels der <span class="math inline">\(t\)</span>-Verteilung mit <span class="math inline">\(N-K\)</span> Freiheitsgraden und <span class="math inline">\(1-\alpha/(2m)\)</span>-Quantile bestimmt.</p>
<p><span class="math display">\[\begin{equation}
w_{\text{Bonferroni}} = t_{N-K,1-\alpha/(2m)}
\end{equation}\]</span></p>
<p>Eine Variante der Bonferroni-Korrektur die ein höhere Power hat, ist die Bonferroni-Holm-Korrektur <span class="citation" data-cites="holm1979">(<a href="references.html#ref-holm1979" role="doc-biblioref">Holm 1979</a>)</span>. Die Bonferroni-Holm-Korrektur ist ein sequentielles Verfahren zur Kontrolle des <span class="math inline">\(\alpha\)</span>-Fehlers. Zunächst werden die p-Werte aller durchgeführten Tests der Größe nach aufsteigend sortiert. Jeder p-Wert wird dann mit einem progressiv angepassten Signifikanzniveau verglichen, wobei der kleinste p-Wert mit <span class="math inline">\(\alpha/m\)</span> verglichen wird, der zweitkleinste mit <span class="math inline">\(\alpha/(m-1)\)</span> usw. D.h. zunächst werden die p-Werte der Größe angeordnet.</p>
<p><span class="math display">\[\begin{equation*}
p_{(1)} &lt; p_{(2)} &lt; \cdots &lt; p_{(m)}
\end{equation*}\]</span></p>
<p>Der p-Wert <span class="math inline">\(p_{(i)}\)</span> ist somit der <span class="math inline">\(i\)</span>-kleinste p-Wert. Die p-Werte werden dann der Reihe nach verglichen mit:</p>
<p><span class="math display">\[\begin{equation*}
\alpha/m, \alpha/(m-1), \ldots , \alpha/1
\end{equation*}\]</span></p>
<p>Nun wird der Index <span class="math inline">\(j\)</span> des ersten p-Werts der die jeweilige Schwelle übertrifft bestimmt.</p>
<p><span class="math display">\[\begin{equation*}
p_{(j)} &gt; \frac{\alpha}{m + 1 - j}
\end{equation*}\]</span></p>
<p>Dieser Index <span class="math inline">\(j\)</span> bestimmt die signifikanten Tests indem alle Tests mit <span class="math inline">\(p_{(i)} &lt; p_{(j)}\)</span> als statistisch signifikant gewertet werden. Die Bonferroni-Holm-Korrektur ist ebenfalls wie die Bonferroni-Korrektor für pre-planned Vergleiche zu verwenden.</p>
<p>Eine weitere weit verbreitete Methode ist die <strong>Tukey-Pairwise difference</strong> Methode . Diese Methode ist optimiert darauf alle paarweisen Vergleiche durchzuführen und daher nur für einfache Kontraste anwendbar. Durch die Optimierung sind die Konfidenzintervalle unter der Tukey-Methode üblicherweise schmaler als die der Bonferroni-Methode. Die Tukey-Methode ist ebenfalls <strong>pre-planned</strong> und im Falle von ungleichen Stichproben in den Faktorstufen ist die Methode nur asymptotisch exact. Unter der Tukey-Methode berechnet sich der kritische Wert <span class="math inline">\(w\)</span> anhand eine speziellen Verteilung, der Studentized range statistics.</p>
<p><span class="math display">\[\begin{equation}
w_{\text{Tukey}} = q_{K,N-K,\alpha/\sqrt{2}}
\label{eq-ed-lc-tukey-w}
\end{equation}\]</span></p>
<p>In <code>R</code> kann die Quantile der Studentized range distribution aus Formel <span class="math inline">\(\eqref{eq-ed-lc-tukey-w}\)</span> mittels der Funktion <code>qtukey()</code> bestimmen werden.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warnung
</div>
</div>
<div class="callout-body-container callout-body">
<p>Die Tukeykorrektur ist nur für balancierte Vergleiche, d.h. gleiche Stichprobengrößen in allen Gruppen, hergeleitet und für ungleiche Stichprobengrößen nur annährend exakt .</p>
</div>
</div>
<p>Die <strong>Scheffé-Methode</strong> ist ebenfalls sehr oft in der Literatur anzutreffen, da sie <em>post-hoc</em>, also nach Einsicht der Daten, angewendet werden kann. Mit der Scheffé-Methode können auch alle Arten von Vergleichen, einfache wie auch komplexe, durchgeführt werden. Der kritische Wert <span class="math inline">\(w\)</span> wird bei Scheffé-Methode mittels der <span class="math inline">\(F\)</span>-Verteilung mit <span class="math inline">\(K-1\)</span> und <span class="math inline">\(N-k\)</span> Freiheitsgraden bei <span class="math inline">\(1-\alpha\)</span> ermittelt. Wobei noch ein Korrekturfaktor <span class="math inline">\(K-1\)</span> multipliziert werden muss. Dabei ist die Anzahl der Vergleiche irrelevant, da der resultierende kritische Wert alle möglichen Vergleiche einbezieht.</p>
<p><span class="math display">\[\begin{equation}
w_{\text{Scheffé}} = \sqrt{(K-1)F_{K-1,N-K,1-\alpha}}
\end{equation}\]</span></p>
<p>Dementsprechend kann die Scheffé-Korrektur eigentlich immer angewendet werden, egal ob pre-planned oder post-hoc und unabhängig von der Art der Vergleichen ohne das das Risiko einer fehlerhaften Korrektur eingegangen wird.</p>
<p>Um noch einmal die Unterschiede der verschiedenen Methoden stärker zu betonen, sind in <a href="#tbl-ed-lc-contrasts-w" class="quarto-xref">Tabelle&nbsp;<span>28.4</span></a> die verschiedene kritische Werte <span class="math inline">\(w\)</span> der drei Methoden für verschiedenen Anzahl <span class="math inline">\(K\)</span> von Faktorstufen bzw. der resultierenden paarweisen Vergleichen aufgelistet.</p>
<div class="cell">
<div id="tbl-ed-lc-contrasts-w" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ed-lc-contrasts-w-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;28.4: Vergleich der kritischen Wert <span class="math inline">\(w\)</span> der verschiedenen <span class="math inline">\(\alpha\)</span>-Kontrollmethoden und einen einzelnen Test <span class="math inline">\(\alpha_{PC}\)</span>.
</figcaption>
<div aria-describedby="tbl-ed-lc-contrasts-w-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<caption>Kritische Werte <span class="math inline">\(w\)</span> für alle <span class="math inline">\(k(k-1)/2\)</span> paarweisen Vergleiche bei <span class="math inline">\(df_{\text{error}}=12\)</span>.</caption>
<thead>
<tr class="header">
<th style="text-align: right;">Stufen</th>
<th style="text-align: right;"><span class="math inline">\(\alpha_{PC}\)</span></th>
<th style="text-align: right;">Tukey</th>
<th style="text-align: right;">Bonferroni</th>
<th style="text-align: right;">Scheffé</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">4.75</td>
<td style="text-align: right;">4.75</td>
<td style="text-align: right;">4.75</td>
<td style="text-align: right;">4.75</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">4.75</td>
<td style="text-align: right;">7.12</td>
<td style="text-align: right;">7.73</td>
<td style="text-align: right;">7.77</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">4.75</td>
<td style="text-align: right;">8.81</td>
<td style="text-align: right;">9.94</td>
<td style="text-align: right;">10.47</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">4.75</td>
<td style="text-align: right;">10.16</td>
<td style="text-align: right;">11.75</td>
<td style="text-align: right;">13.04</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">4.75</td>
<td style="text-align: right;">11.28</td>
<td style="text-align: right;">13.31</td>
<td style="text-align: right;">15.53</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">4.75</td>
<td style="text-align: right;">12.25</td>
<td style="text-align: right;">14.69</td>
<td style="text-align: right;">17.98</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p><a href="#tbl-ed-lc-contrasts-w" class="quarto-xref">Tabelle&nbsp;<span>28.4</span></a> zeigt, dass der Tukey durchgehend bei den drei Methoden die kleinsten kritischen Werte <span class="math inline">\(w\)</span> verwendet. Dadurch wird entsprechend das Konfidenzintervall auch schmaler. Für diesen Fall liegt die Bonferroni-Methode immer zwischen Tukey und Scheffé die immer den größten kritischen Wert <span class="math inline">\(w\)</span> hat. Die kritischen Werte unter Scheffé werden relativ schnell größer. Da die Größe des kritischen Werts <span class="math inline">\(w\)</span> die Power beeinflusst, können wir anhand der Werte ableiten, dass die Scheffé-Methode entsprechend die geringste Power hat.</p>
<p>Zwei weitere Methoden sind noch die Methode nach Dunnet und Fisher least significant difference (FisherLSD) . Die Dunnet Methode ist ebenfalls pre-planned und ist darauf optimiert ein Kontrollkondition mit den anderen Konditionen zu vergleichen. Die FisherLSD-Methode führt keine Anpassung durch sondern ist ein Spezialfall wenn der Faktor <span class="math inline">\(K = 3\)</span> Stufen hat und im ersten Schritt ein statistisch Signifikanter <span class="math inline">\(F\)</span>-Wert gefunden wurde. Die drei individuellen Tests werden dann als normale t-Tests durchgeführt mit dem jeweils unkorrigierten <span class="math inline">\(\alpha\)</span>. In diesem Fall, wenn der paarweise Vergleich nach einen signifikanten <span class="math inline">\(F\)</span>-Test bei <span class="math inline">\(K=3\)</span> durchgeführt wird, ist eine gesonderte <span class="math inline">\(\alpha\)</span>-Kontrolle nicht mehr notwendig.</p>
<p>Zusammenfassend lässt sich sagen, dass schon vor der Durchführung des Experiments ein definierter Analyseplan vorliegen sollte. So könnte zum Beispiel festgelegt werden, welche Vergleiche von primären Interesse sind und entsprechend in einer Prä-Registrierung dokumentiert werden, die Power zu maximieren.</p>
<section id="false-discovery-rate-fdr" class="level3" data-number="28.3.1">
<h3 data-number="28.3.1" class="anchored" data-anchor-id="false-discovery-rate-fdr"><span class="header-section-number">28.3.1</span> False Discovery Rate FDR </h3>
<p>Eine weitere Methode die in den letzten Jahren immer prominenter geworden ist, ist die <strong>false discovery rate</strong> (FDR) Methode nach <span class="citation" data-cites="benjamini1995">Benjamini und Hochberg (<a href="references.html#ref-benjamini1995" role="doc-biblioref">2018</a>)</span>. Unter der fdr Methode ist der Ansatz etwas anders und es wird nicht der <span class="math inline">\(\alpha\)</span>-Fehler sondern der mittlere Quotient der falsch positiven Befunde (V) und der Gesamtanzahl der positiven Befunde (R) kontrolliert. Die Gesamtanzahl setzt sich dabei zusammen aus den falsch positiven Befunden V, d.h. korrekte <span class="math inline">\(H_0\)</span> Hypothesen die abgelehnt wurden, und den korrekt positiven Befunden (S), d.h. falsche <span class="math inline">\(H_0\)</span> Hypothesen die abgelehnt wurden.</p>
<p><span class="math display">\[\begin{equation}
\text{FDR} = E(\text{FDR}) = E\left(\frac{V}{R}\right)= E\left(\frac{V}{V + S}\right)
\label{eq-ed-linear-fdr}
\end{equation}\]</span></p>
<p>Das <span class="math inline">\(E\)</span> steht dabei wieder für den Erwartungswerts, das als der <em>Mittelwert</em> interpretiert werden kann. Die Methode ist dabei vor allem vor dem Hintergrund von Analysen entwickelt worden, bei denen die Anzahl der Tests <span class="math inline">\(m\)</span> sehr groß ist. In diesen Fällen ist beispielsweise die Bonferroni-Korrektur sehr konservativ und es werden nur sehr falsche <span class="math inline">\(H_0\)</span>-Hypothesen abgelehnt, da das Fehlerniveau <span class="math inline">\(\alpha^*\)</span> sehr klein wird.</p>
<p>Der FDR-Ansatz kann anhand eines einfachen Gedankenexperiments erläutert werden. Angenommen, es werden <span class="math inline">\(m = 10\)</span> Nullhypothesen getestet. Es wird nun eine Größe <span class="math inline">\(P\)</span> folgendermaßen definiert.</p>
<p><span class="math display">\[\begin{equation*}
P = \begin{cases}
0 \text{ wenn keine korrekte } H_0 \text{ abgelehnt wird} \\
1 \text{ wenn mindestens eine korrekte } H_0 \text{ abgelehnt wird}
\end{cases}
\end{equation*}\]</span></p>
<p>Es soll der family wise error beispielsweise mittels Bonferroni kontrolliert werden. Dann ergibt sich ein <span class="math inline">\(\alpha^* = \alpha / m = 0.005\)</span>. Mit diesem <span class="math inline">\(\alpha^*\)</span> werden die <span class="math inline">\(m = 10\)</span> Nullhypothesen getested. Wird eine <span class="math inline">\(H_0\)</span> fälschlicherweise abgelehnt ergibt sich <span class="math inline">\(P = 1\)</span>, wird keine korrekte <span class="math inline">\(H_0\)</span> abgelehnt folgt <span class="math inline">\(P = 0\)</span>. In Wirklichkeit kann <span class="math inline">\(P\)</span> nicht bestimmt werden, da nicht bekannt ist welche <span class="math inline">\(H_0\)</span> korrekt bzw. nicht korrekt sind. Wird das (Gedanken-)Experiment <em>wiederholt</em> durchgeführt, dann ergebt sich für jede Wiederholung entweder ein Wert von <span class="math inline">\(P = 0\)</span> oder <span class="math inline">\(P = 1\)</span>. Insgesamt resultiert daraus eine Folge von Nullen und Einsen.</p>
<p><span class="math display">\[\begin{equation*}
1 0 0 0 1 0 0 0 1 0 1 0 1 0 0 0 1 1 0 0\ldots
\end{equation*}\]</span></p>
<p>Wenn der Mittelwert über diese Folge von Nullen und Einsen gebildet wird (der Erwartungswert), dann sollte der Wert nicht größer als <span class="math inline">\(\alpha\)</span> werden. D.h. die Methoden die bisher verwendet wurden, wie die Bonferroni-Korrektur, kontrollieren für die Größe dieses Mittelwerts, dem Erwartungswert <span class="math inline">\(E(P)\)</span>, von <span class="math inline">\(P\)</span>.</p>
<p>Die FDR-Korrektur geht nun einen anderen Weg. Hier wird zunächst eine Größe <span class="math inline">\(Q\)</span> nach dem folgenden Schema definiert.</p>
<p><span class="math display">\[\begin{equation*}
Q = \begin{cases}
0 \text{ wenn keine korrekte } H_0 \text{ abgelehnt wird} \\
V/(V + S) \text{ wenn } V \text{ korrekte und } S \text{ falsche } H_0 \text{ abgelehnt werden}
\end{cases}
\end{equation*}\]</span></p>
<p>Der Wert <span class="math inline">\(Q\)</span> kann dadurch als der Quotient der falsch positiven <span class="math inline">\(H_0\)</span> Hypothesen interpretiert werden. Seien alle <span class="math inline">\(m H_0\)</span>-Hypothesen korrekt. Dann wird <span class="math inline">\(Q\)</span> immer Null sein, außer in den Fällen, in denen fälschlicherweise eine <span class="math inline">\(H_0\)</span> abgelehnt wird. In diesem Fall gilt dann aber <span class="math inline">\(V/V = 1\)</span>, da per Annahme <span class="math inline">\(S = 0\)</span> alle <span class="math inline">\(H_0\)</span> korrekt sind. D.h. <span class="math inline">\(Q\)</span> wird nur die Werte Eins oder Null annehmen. In diesem Fall ist <span class="math inline">\(Q\)</span> gleich zu <span class="math inline">\(P\)</span>. D.h. wenn alle <span class="math inline">\(H_0\)</span> Hypothesen korrekt sind, wird auch mit <span class="math inline">\(Q\)</span> der family wise error rate kontrolliert.</p>
<p>Nun seien aber von den <span class="math inline">\(m = 10\)</span> Experiment <span class="math inline">\(7 H_0\)</span>-Hypothesen korrekt und <span class="math inline">\(3 H_0\)</span> Hypothesen falsch (d.h. die Alternativhypothesen sind korrekt). Es wird mit Bonferroni korrigiert und das Signifikanzniveau dementsprechend auf <span class="math inline">\(\alpha^* = \alpha/m = 0.005\)</span> herunter korrigiert. Die Größe <span class="math inline">\(P\)</span> verhält sich immer noch gleich und wird in weniger als <span class="math inline">\(\alpha\%\)</span> der Fälle gleich Eins sein. <span class="math inline">\(Q\)</span> ist in denen Fällen in denen <span class="math inline">\(P=0\)</span> ist ebenfalls <span class="math inline">\(Q=0\)</span> sein, da keine korrekte <span class="math inline">\(H_0\)</span> fälschlicherweise abgelehnt werden.</p>
<p>Sei nun als weitere Annahme auch noch die Power ausreichend, so dass die falschen <span class="math inline">\(H_0\)</span> mit hoher Wahrscheinlichkeit abgelehnt werden. Wenn nun eine <span class="math inline">\(H_0\)</span> fälschlicherweise abgelehnt wird, folgt <span class="math inline">\(V &gt; 0\)</span>. Dann ist dazu in den meisten Fällen <span class="math inline">\(S = 3\)</span>, da die falschen <span class="math inline">\(H_0\)</span> mit hoher Wahrscheinlichkeit (Power) abgelehnt werden. In Abhängigkeit von der Anzahl der abgelehnten <span class="math inline">\(H_0\)</span>s wird <span class="math inline">\(V \in [1,2,\ldots,7]\)</span> sein. Mit einem <span class="math inline">\(\alpha^* = 0.005\)</span> werden aber selten mehr als eine korrekte <span class="math inline">\(H_0\)</span> abgelehnt. D.h. in den meisten Fällen resultiert <span class="math inline">\(Q = 1/(1+3) = 1/4 = 0.25\)</span> sein (Wenn V = 2 ist, dann wird <span class="math inline">\(Q = 2/5 = 0.4\)</span>. Somit resultiert bei Wiederholung des Experiments eine Folge die in etwa so aussehen könnte.</p>
<p><span class="math display">\[\begin{equation*}
0 0 \frac{1}{4} \frac{1}{4} 0 0 0 0 \frac{2}{5} \frac{1}{4} 0 \frac{1}{4} 0 \ldots
\end{equation*}\]</span></p>
<p>Jedes Mal, wenn in der Folge der <span class="math inline">\(P\)</span>s eine Eins steht, ist in der Folge der <span class="math inline">\(Q\)</span>s ein Quotient der kleiner als Eins sein wird. Daher wird der Mittelwert der Folge der <span class="math inline">\(Q\)</span>s deutlich kleiner ausfallen als derjenige der <span class="math inline">\(P\)</span>s. Um insgesamt wieder eine mittelere Rate von <span class="math inline">\(0.05\)</span> zu kommen, kann somit das <span class="math inline">\(\alpha^*\)</span>-Niveau für jeden individuellen Test liberaler angesetzt werdes führt dazu, dass die FDR-Methode eine höhere Power bei gleichzeitiger Kontrolle der Fehlerrate erreicht. Operational wird ein ähnliches Schema wie der bei der Bonferroni-Holm-Korrektur verwendet.</p>
</section>
</section>
<section id="mehrfachvergleiche-in-r" class="level2" data-number="28.4">
<h2 data-number="28.4" class="anchored" data-anchor-id="mehrfachvergleiche-in-r"><span class="header-section-number">28.4</span> Mehrfachvergleiche in <code>R</code></h2>
<section id="das-package-emmeans" class="level3" data-number="28.4.1">
<h3 data-number="28.4.1" class="anchored" data-anchor-id="das-package-emmeans"><span class="header-section-number">28.4.1</span> Das package <code>emmeans</code></h3>
<p>Wie immer, gibt es in <code>R</code> verschiedene Pakete um Mehrfachvergleiche durchzuführen. Wir beschränken uns hier hauptsächlich auf das Paket <code>emmeans</code>, da es sehr flexibel ist und mit einer Vielzahl von verschiedenen Modellen über das allgemeine lineare Modell hinaus zusammenarbeitet. Alternativen zu <code>emmeans</code> sind <code>multcomp</code> und <code>gmodels</code>.</p>
<p>Bei der Verwendung von <code>emmeans</code> ist immer ein zweistufiger Prozess durchzuführen. Zunächst müssen die Zellmittelwerte mit der Funktion <code>emmeans(&lt;MODEL&gt;, ~&lt;FAKTOR&gt;)</code> berechnet werden. Anschließen erfolgt die Berechnung der Vergleiche entweder mittels der Funktion <code>pairs()</code> bei paarweisen Vergleichen oder mit <code>contrast()</code> für beliebige Vergleiche.</p>
<p>Soll zum Beispiel mittels Bonferroni-Korrektur ein einfacher Vergleich zwischen Koffein und Placebo sowie ein komplexer Vergleich der Mittelwerte von Koffein und Placebo gegen Kontrolle durchgeführt werden. Dann können die folgenden Befehle verwendet werden:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>mod_em <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(mod_aov, <span class="at">specs=</span><span class="sc">~</span>Gruppe)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(mod_em,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">adjust=</span><span class="st">'bonferroni'</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">method =</span> <span class="fu">list</span>(</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Koffein vs. Placebo"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Tablette vs. CON"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>         ),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">infer=</span><span class="cn">TRUE</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast            estimate   SE df lower.CL upper.CL t.ratio p.value
 Koffein vs. Placebo    -10.5 2.09 57    -15.3    -5.67  -5.014  &lt;.0001
 Tablette vs. CON        -8.1 1.81 57    -12.3    -3.93  -4.476  0.0001

Confidence level used: 0.95 
Conf-level adjustment: bonferroni method for 2 estimates 
P value adjustment: bonferroni method for 2 tests </code></pre>
</div>
</div>
<p>Im ersten Schritt werden die Mittelwerte mittels <code>emmeans()</code> berechnet. Dazu wird das gefitte Modell <code>mod_aov</code> an <code>emmeans()</code> übergeben und als zweiten Parameter <code>specs</code> wird eine Formel spezifiziert für welchen Faktor die Mittelwerte berechnet werden sollen. Später bei mehrfaktoriellen Modellen gibt es hier verschiedene Möglichkeiten die Formel zu definieren. Bei diesem Beispiel sind aber nur die Mittelwerte für die Faktorstufen von <code>Gruppe</code> möglich. `emmeans()´ produziert den folgenden Output.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>mod_em</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> Gruppe  emmean   SE df lower.CL upper.CL
 Koffein   1914 1.48 57     1911     1917
 Placebo   1925 1.48 57     1922     1928
 Control   1928 1.48 57     1925     1931

Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Letztendlich sind hier die Mittelwerte der drei verschiedenen Gruppen die anhand des Modells berechnet werden sichtbar.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warnung
</div>
</div>
<div class="callout-body-container callout-body">
<p>In diesem Fall sind die Mittelwerte <span class="math inline">\(\bar{y}_i\)</span> der Rohdaten gleich denjenigen des Modell des Modells, da es sich um ein balancierten Datensatz handelt, d.h. in allen Gruppen sind die Stichproben gleich. Wenn dies nicht der Fall ist, dann müssen die geschätzten Mittelwerte <span class="math inline">\(\hat{y}_i\)</span> anhand des Modells nicht unbedingt gleich zu den Mittelwerte <span class="math inline">\(\bar{y}_i\)</span> der Rohdaten sein. Dies trifft vor allem zu, wenn die Modell komplexer werden. Die Werte von <code>emmeans()</code> werden anhand des Modells geschätzt und werden daher auch als <em>expected marginal means</em> bezeichnet (daher auch der Name des packages <code>e</code>(expected)<code>m</code>(arginal)<code>means</code>)<span class="citation" data-cites="searle1980">(siehe auch <a href="references.html#ref-searle1980" role="doc-biblioref">Searle, Speed, und Milliken 1980</a>)</span>.</p>
</div>
</div>
<p>Nachdemir die Mittelwerte mit <code>emmeans()</code> berechnet wurden, können nun die Kontraste mit der Funktion <code>contrast()</code> definiert werden. Dazu wird das <code>emmeans</code>-Objekt als erster Parameter übergeben. Über den Parameter <code>adjust</code> wird die Korrekturmethode angegeben. In diesem Fall <code>bonferroni</code>. Anschließend wird eine Liste der zu berechnenden Kontraste übergeben. Hierzu muss die Abfolge der Mittelwerte laut der Reihenfolge in der Ausgabe in <code>emmeans()</code> verwendet werden. Die Reihenfolge ist üblicherweise die Gleiche wie auch bei <code>lm()</code>. Die Kontraste werden als Liste mit <code>&lt;NAME&gt; = &lt;KONTRAST&gt;</code> übergeben. Der Name ist beliebig und sollte so gewählt werden, dass der Wert möglichst einfach interpretiert werden kann. Der Parameter <code>infer</code> kontrolliert ob direkt ein Konfidenzintervall berechnet werden soll. Alternativ könnte auch wie folgt vorgegangen werden:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>contrast_list <span class="ot">&lt;-</span><span class="fu">list</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Koffein vs. Placebo"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Tablette vs. CON"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>mod_contrast <span class="ot">&lt;-</span> <span class="fu">contrast</span>(mod_em,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">adjust =</span> <span class="st">'bonferroni'</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">method =</span> contrast_list)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>mod_contrast</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast            estimate   SE df t.ratio p.value
 Koffein vs. Placebo    -10.5 2.09 57  -5.014  &lt;.0001
 Tablette vs. CON        -8.1 1.81 57  -4.476  0.0001

P value adjustment: bonferroni method for 2 tests </code></pre>
</div>
</div>
<p>Mit nachfolgender Berechnung der Konfidenzintervalle.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mod_contrast)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast            estimate   SE df lower.CL upper.CL
 Koffein vs. Placebo    -10.5 2.09 57    -15.3    -5.67
 Tablette vs. CON        -8.1 1.81 57    -12.3    -3.93

Confidence level used: 0.95 
Conf-level adjustment: bonferroni method for 2 estimates </code></pre>
</div>
</div>
<p>Die Ergebnisse sind natürlich in beiden Ansätzen gleich und zeigen einen statistisch signifikanten Unterschied zwischen den Koffein und der Placebo Kondition, sowie einen statistisch signifikanten Unterschied zwischen der Tablettengabe unabhängig vom Wirkstoff und der Kontrollkondition.</p>
<p>Die Bonferroni-Holm-Korrektur kann mittels des <code>adjust</code>-Arguments <code>'holm'</code> angewendet werden.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(mod_em,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">adjust =</span> <span class="st">'holm'</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">method =</span> contrast_list)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast            estimate   SE df t.ratio p.value
 Koffein vs. Placebo    -10.5 2.09 57  -5.014  &lt;.0001
 Tablette vs. CON        -8.1 1.81 57  -4.476  &lt;.0001

P value adjustment: holm method for 2 tests </code></pre>
</div>
</div>
<p>Die Bejamini-Hochberg-Korrektur FDR kann mit Hilfe des Parameters <code>adjust='fdr'</code> verwendet werden.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(mod_em,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">adjust=</span><span class="st">'fdr'</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">method =</span> contrast_list)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast            estimate   SE df t.ratio p.value
 Koffein vs. Placebo    -10.5 2.09 57  -5.014  &lt;.0001
 Tablette vs. CON        -8.1 1.81 57  -4.476  &lt;.0001

P value adjustment: fdr method for 2 tests </code></pre>
</div>
</div>
<p>Sollen dagegen alle paarweisen Vergleiche beispielsweise mittels der Tukey-Methode berechnen kann die <code>pairs()</code> Methode auf die mittels <code>emmeans()</code> gefitteten Faktormittelwerte anwenden werden.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(mod_em, <span class="at">adjust=</span><span class="st">"tukey"</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast          estimate   SE df t.ratio p.value
 Koffein - Placebo   -10.48 2.09 57  -5.014  &lt;.0001
 Koffein - Control   -13.34 2.09 57  -6.383  &lt;.0001
 Placebo - Control    -2.86 2.09 57  -1.369  0.3639

P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
</div>
<p>Die Tukey Methode wird standardmäßig von <code>pairs()</code> verwendet, wenn keine Argument für <code>adjust</code> angegeben wird. Alternativ geht es auch über die <code>contrast()</code> Funktion wenn für <code>method</code> die Zeichenkette <code>pairwise</code> übergeben wird.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(mod_em, <span class="at">method=</span><span class="st">'pairwise'</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast          estimate   SE df t.ratio p.value
 Koffein - Placebo   -10.48 2.09 57  -5.014  &lt;.0001
 Koffein - Control   -13.34 2.09 57  -6.383  &lt;.0001
 Placebo - Control    -2.86 2.09 57  -1.369  0.3639

P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
</div>
<p>Soll die Korrektur mittels der Scheffé-Methode durchgeführt werden, kann dies über <code>adjust=scheffe</code> erreicht werden.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(mod_em,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">adjust=</span><span class="st">'scheffe'</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">method =</span> contrast_list) </span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast            estimate   SE df t.ratio p.value
 Koffein vs. Placebo    -10.5 2.09 57  -5.014  &lt;.0001
 Tablette vs. CON        -8.1 1.81 57  -4.476  0.0002

P value adjustment: scheffe method with rank 2 </code></pre>
</div>
</div>
<p>Um die Dunnettkorrektur zu verwenden, entsprechend <code>contrast()</code> mit dem Parameter <code>method='trt.vs.ctrl'</code>. Hier kann zusätzlich über den Parameter <code>ref</code> explizit angeben werden, welche Faktorstufe die Kontrollbedingung darstellt.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(mod_em, <span class="at">method=</span><span class="st">'trt.vs.ctrl'</span>, <span class="at">ref=</span><span class="st">'Control'</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast          estimate   SE df t.ratio p.value
 Koffein - Control   -13.34 2.09 57  -6.383  &lt;.0001
 Placebo - Control    -2.86 2.09 57  -1.369  0.3029

P value adjustment: dunnettx method for 2 tests </code></pre>
</div>
</div>
<p>Wenn die FisherLSD-Methode verwendet soll, dann kann beispielsweise wieder <code>pairs()</code> mit dem Parameter <code>adjust='none'</code> verwendet werden.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(mod_em, <span class="at">adjust=</span><span class="st">'none'</span>, <span class="at">infer=</span>T)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast          estimate   SE df lower.CL upper.CL t.ratio p.value
 Koffein - Placebo   -10.48 2.09 57   -14.66    -6.29  -5.014  &lt;.0001
 Koffein - Control   -13.34 2.09 57   -17.53    -9.16  -6.383  &lt;.0001
 Placebo - Control    -2.86 2.09 57    -7.05     1.32  -1.369  0.1765

Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Wie schon erwähnt ist das package <code>emmeans</code> extrem flexibel und bietet unzählige Möglichkeiten verschiedene Mehrfachvergleiche zu spezifizieren und entsprechend zu berechnen. Daher lohnt sich die intensive Auseinandersetzung mit der Dokumentation in jedem Fall. Wahrscheinlich geht ein Teil des Erfolges von <code>R</code> in den letzten Jahren auf die Funktionalität dieses packages zurück.</p>
</section>
<section id="cohens-d-für-mehrfachvergleiche" class="level3" data-number="28.4.2">
<h3 data-number="28.4.2" class="anchored" data-anchor-id="cohens-d-für-mehrfachvergleiche"><span class="header-section-number">28.4.2</span> Cohen’s d für Mehrfachvergleiche</h3>
<p>Über das Paket <code>emmeans</code> können auch eine Cohen’s D Typ Effektstärken mittels der Funktion <code>eff_size()</code> berechnen werden. Allerdings müssen als Parameter die zu verwendende Standardabweichung sowie die Freiheitsgrade selbst angeben werden. Diese können aber über die Funktionen <code>sigma()</code> und <code>df.residual()</code> dem gefitteten <code>lm</code>-Objekt entnommen werden.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">eff_size</span>(mod_em,</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">sigma=</span><span class="fu">sigma</span>(mod_aov),</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">edf=</span><span class="fu">df.residual</span>(mod_aov))</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast          effect.size    SE df lower.CL upper.CL
 Koffein - Placebo      -1.586 0.349 57    -2.29   -0.886
 Koffein - Control      -2.019 0.368 57    -2.76   -1.281
 Placebo - Control      -0.433 0.319 57    -1.07    0.206

sigma used for effect sizes: 6.609 
Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Standardmäßig werden paarweise Vergleiche berechnet, aber über den Parameter <code>method</code> können die Effektstärken auch für beliebige Kontraste berechnet werden.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">eff_size</span>(mod_em,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">sigma=</span><span class="fu">sigma</span>(mod_aov),</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">edf=</span><span class="fu">df.residual</span>(mod_aov),</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">method =</span> contrast_list)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast            effect.size    SE df lower.CL upper.CL
 Koffein vs. Placebo       -1.59 0.349 57    -2.29   -0.886
 Tablette vs. CON          -1.23 0.297 57    -1.82   -0.631

sigma used for effect sizes: 6.609 
Confidence level used: 0.95 </code></pre>
</div>
</div>
</section>
</section>
<section id="bestimmung-des-replikationsfaktors-anhand-des-konfidenzintervalls" class="level2" data-number="28.5">
<h2 data-number="28.5" class="anchored" data-anchor-id="bestimmung-des-replikationsfaktors-anhand-des-konfidenzintervalls"><span class="header-section-number">28.5</span> Bestimmung des Replikationsfaktors anhand des Konfidenzintervalls</h2>
<p>In Kapitel 25 zum completely randomized design wurde der Replikationsfaktor für die experimentellen Einheiten anhand der Effektstärke <span class="math inline">\(f\)</span> bestimmt. Ein weitere Möglichkeit den Replikationsfaktor zu bestimmen, die zunehmend an Bedeutung gewinnt <span class="citation" data-cites="abt2025">(<a href="references.html#ref-abt2025" role="doc-biblioref">Abt u.&nbsp;a. 2025</a>)</span>, besteht darin mittels der Kontraste bzw. deren Konfidenzintervallen die Stichprobengröße zu bestimmen. Die angesteuerte Größe ist hierbei die Breite des Konfidenzintervalls. Der direkteste Weg ist hierbei den minimal signifikanten Unterschied (<strong>minimal significant difference</strong>: msd) . Der Ansatz basiert im Grunde genommen auf der bereits behandelten Dualität von Hypothesentests und Konfidenzintervallen (Kapitel 10).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ed-lc-msd-01" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ed-lc-msd-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ed_linear_contrasts_files/figure-html/fig-ed-lc-msd-01-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ed-lc-msd-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;28.4: Der erwartete Kontrast und dessen Konfidenzintervall.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-ed-lc-msd-01" class="quarto-xref">Abbildung&nbsp;<span>28.4</span></a> ist noch einmal der Zusammenhang zwischen dem Hypothesentest unter der <span class="math inline">\(H_0\)</span> und der Breite des Konfidenzintervalls dargestellt. Wenn das Konfidenzintervall die <span class="math inline">\(H_0\)</span> nicht enthält, dann kann von einem statistisch signifikantem Ergebnis ausgegangen werden. Für einen gegebenem Effekt, im vorliegenden Fall ein Kontrast <span class="math inline">\(\psi\)</span>, und bekannter bzw. abgeschätzter Residualvarianz <span class="math inline">\(\sigma\)</span>, kann über den Standardfehler <span class="math inline">\(s_{\psi}\)</span> die notwendige Stichprobengröße bestimmen. Der minimale signifikante Unterschied kann über die folgende Formel berechnet werden.</p>
<p><span class="math display">\[\begin{equation}
msd = w \sqrt{\widehat{Var}\left(\sum c_i \hat{\tau}_i\right)}=w \times s_{\psi}
\end{equation}\]</span></p>
<p>Es soll zum Beispiel der Effekt eines Nahrungsergänzungsmittels auf die Laufleistung bei einem Mitteldistanzwettkampf ähnlich wie bei dem Koffeinexperiment untersucht weden. Es soll das gleiche Design mit Interventions-, Placebo- und Kontrollgruppe (<span class="math inline">\(K = 3\)</span>) verwendet werden. Es wird davon ausgegangen, dass ein Unterschied zwischen der Placebogruppe und der Interventionsgruppe von <span class="math inline">\(5\)</span>s mindestens gefunden werden sollte um als praktisch relevant zu gelten. Damit gilt</p>
<p><span class="math display">\[\begin{equation*}
msd = 5
\end{equation*}\]</span></p>
<p>Im Koffeinbeispiel wurde für <span class="math inline">\(\sigma^2\)</span> ein Wert von <span class="math inline">\(\hat{\sigma^2} = MSE \approx 30\)</span>s bestimmt. Daraus folgt für einen paarweisen Vergleich mit gleicher Stichprobengröße <span class="math inline">\(n\)</span> in beiden Gruppen:</p>
<p><span class="math display">\[\begin{equation*}
msd = w \sqrt{30\left(\frac{1}{n} + \frac{1}{n}\right)} = w\sqrt{30\frac{2}{n}} \leq 5
\end{equation*}\]</span></p>
<p>A-priori wird festgelegt, das nur paarweise Vergleiche durchgeführt werden soll. D.h. die Quartile muss mittels der Tukey-Methode bestimmen werden. D.h. der kritische Wert <span class="math inline">\(w\)</span> berechnet sich nach Formel <span class="math inline">\(\eqref{eq-ed-lc-tukey-w}\)</span>.</p>
<p><span class="math display">\[\begin{equation*}
w = q_{K,N-K,\alpha}/\sqrt{2}
\end{equation*}\]</span></p>
<p>Eingesetzt folgt daraus:</p>
<p><span class="math display">\[\begin{align*}
\frac{q_{K,N-K,\alpha}}{\sqrt{2}} \sqrt{30\frac{2}{n}} &amp;= q_{K,N-K,\alpha} \sqrt{\frac{30}{n}} \leq 5 = msd \\
\Leftrightarrow  q_{K,N-K,\alpha}^2 \frac{30}{n} &amp;\leq 25 \\
\Leftrightarrow  q_{K,N-K,\alpha}^2 \leq \frac{25}{30}n &amp;= \frac{5}{6}n \\
\end{align*}\]</span></p>
<p>D.h. das Quadrat der studentized range quantile muss kleiner als <span class="math inline">\(\frac{5}{6}n\)</span> sein, damit das Konfidenzintervall schmal genug ist. Da sich der Wert von <span class="math inline">\(q_{K,N-K,\alpha}\)</span> mit der Stichprobengröße ändert, wird eine try-and-error Methode durchgeführt und die Breite des Konfindenzintervalls für verschiedene Wert von <span class="math inline">\(n\)</span> mittels <code>qtukey()</code>-Funktion berechnet.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>q_t <span class="ot">&lt;-</span> <span class="fu">qtukey</span>(<span class="fl">0.975</span>,K,K<span class="sc">*</span>n<span class="sc">-</span>K)<span class="sc">**</span><span class="dv">2</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>n_w <span class="ot">&lt;-</span> <span class="dv">5</span><span class="sc">/</span><span class="dv">6</span><span class="sc">*</span>n</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Wenn die Werte in einer Tabelle abtragen folgt die folgende Liste (siehe <a href="#tbl-ed-lc-tukey-rep" class="quarto-xref">Tabelle&nbsp;<span>28.5</span></a>).</p>
<div class="cell">
<div id="tbl-ed-lc-tukey-rep" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ed-lc-tukey-rep-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;28.5: Stichprobengrößen und Vergleich mit msd
</figcaption>
<div aria-describedby="tbl-ed-lc-tukey-rep-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">n</th>
<th style="text-align: right;"><span class="math inline">\(q_{n,Kn-K,\alpha}^2\)</span></th>
<th style="text-align: right;"><span class="math inline">\(5/6n\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: right;">15.58</td>
<td style="text-align: right;">8.33</td>
</tr>
<tr class="even">
<td style="text-align: right;">11</td>
<td style="text-align: right;">15.36</td>
<td style="text-align: right;">9.17</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12</td>
<td style="text-align: right;">15.18</td>
<td style="text-align: right;">10.00</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: right;">15.04</td>
<td style="text-align: right;">10.83</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14</td>
<td style="text-align: right;">14.92</td>
<td style="text-align: right;">11.67</td>
</tr>
<tr class="even">
<td style="text-align: right;">15</td>
<td style="text-align: right;">14.82</td>
<td style="text-align: right;">12.50</td>
</tr>
<tr class="odd">
<td style="text-align: right;">16</td>
<td style="text-align: right;">14.73</td>
<td style="text-align: right;">13.33</td>
</tr>
<tr class="even">
<td style="text-align: right;">17</td>
<td style="text-align: right;">14.65</td>
<td style="text-align: right;">14.17</td>
</tr>
<tr class="odd">
<td style="text-align: right;">18</td>
<td style="text-align: right;">14.58</td>
<td style="text-align: right;">15.00</td>
</tr>
<tr class="even">
<td style="text-align: right;">19</td>
<td style="text-align: right;">14.52</td>
<td style="text-align: right;">15.83</td>
</tr>
<tr class="odd">
<td style="text-align: right;">20</td>
<td style="text-align: right;">14.47</td>
<td style="text-align: right;">16.67</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>In <a href="#tbl-ed-lc-tukey-rep" class="quarto-xref">Tabelle&nbsp;<span>28.5</span></a> ist zu sehen, dass eine Stichprobengröße von <span class="math inline">\(n = 18\)</span> also insgesamt <span class="math inline">\(N = 54\)</span> Athleten benötigt wird um die gewünschte Präzision für das Konfidenzintervall zu erreichen.</p>
<p>Die Methode die Stichprobengröße anhand der Breite des Konfidenzintervalls zu bestimmen wird als *accuracy in parameter estimation (AIPE) <span class="citation" data-cites="kelley2003">(<a href="references.html#ref-kelley2003" role="doc-biblioref">Kelley und Maxwell 2003</a>)</span> bezeichnet. Eine gute Strategie könnte daher darin bestehen, die Stichprobengröße anhand der Power und anhand der AIPE zu bestimmen. Dabei muss nicht unbedingt die minimal significant difference als die Breite des Konfidenzintervalls angesetzt werden, sondern welche Präzision bei der Bestimmung eines Modellparameters erreicht werden sollte. Der minimale Unterschied kann beispielsweise zu einem so breitem Konfidenzintervall führen, dass zwar ein statistisch signifikantes Ergebnis erreicht wird, aber die verbleibende Unsicherheit immer noch zu hoch ist. Die letztendlich gewählte Stichprobengrößen wäre dann die größere der beiden bestimmten für AIPE und Power.</p>
</section>
<section id="vollständige-dokumentation-eines-crds" class="level2" data-number="28.6">
<h2 data-number="28.6" class="anchored" data-anchor-id="vollständige-dokumentation-eines-crds"><span class="header-section-number">28.6</span> Vollständige Dokumentation eines CRDs</h2>
<p>Hier einmal beispielhaft Dokumentation eines CRD inklusive verwendeter Mehrfachvergleiche.</p>
<p>Eine einfaktorielle ANOVA mit dem Faktor Gruppe ergabe einen statistisch signifikanten Haupteffekt für Gruppe <span class="math inline">\(F(2, 57) = 22,6, p &lt; 0,001\)</span>. Überprüfung auf Varianzgleichheit zwischen den Gruppen mittels eines Levene-Tests deutete auf keine Verletzung der Voraussetzungen hin, <span class="math inline">\(F(2, 57) = 0,38, p = 0,69\)</span>. Daher wird die <span class="math inline">\(H_0\)</span>, das kein Unterschied zwischen den Gruppen besteht, abgelehnt. Die beobachtete Effektstärke <span class="math inline">\(\omega^2 = 0,42\)</span>, CI<span class="math inline">\(95\%[0,22, 0,56]\)</span> ist als großer Effekt zu interpretieren. Pre-planned Paarweisetestung mittels Tukey-Korrektur deutete auf statistisch signifikate Unterschiede zwischen den Gruppen Koffein und Placebo <span class="math inline">\(z = -10.4\)</span>, CI95%<span class="math inline">\([-15,5, -5,5], p &lt; 0,001\)</span>, und Koffein und Kontrolle, <span class="math inline">\(z = -13,3\)</span>, CI95<span class="math inline">\(\%[-18,4, -8,3], p &lt; 0,001\)</span>, hin. Insgesamt deuten die Ergebnisse daher darauf hin, dass die Gabe von Koffein zu einer bedeutsamen Leistungssteigerung <span class="math inline">\((&gt;5-10s)\)</span> in der beobachteten Untersuchungsgruppe geführt hat.</p>
</section>
<section id="zum-weiterlesen" class="level2" data-number="28.7">
<h2 data-number="28.7" class="anchored" data-anchor-id="zum-weiterlesen"><span class="header-section-number">28.7</span> Zum Weiterlesen</h2>
<p>Weiter Informationen zu Mehrfachvergleiche und den möglichen Problemen findet ihr in beispielsweise in <span class="citation" data-cites="feise2002">Feise (<a href="references.html#ref-feise2002" role="doc-biblioref">2002</a>)</span> und <span class="citation" data-cites="rothman1990">Rothman (<a href="references.html#ref-rothman1990" role="doc-biblioref">1990</a>)</span>.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-abt2025" class="csl-entry" role="listitem">
Abt, Grant, Colin Boreham, Gareth Davison, Robin Jackson, Simon Jobson, Eric Wallace, und Mark Williams. 2025. <span>„Sample size estimation revisited“</span>. <em>Journal of Sports Sciences</em>, 1–6.
</div>
<div id="ref-benjamini1995" class="csl-entry" role="listitem">
Benjamini, Yoav, und Yosef Hochberg. 2018. <span>„Controlling the False Discovery Rate: A Practical and Powerful Approach to Multiple Testing“</span>. <em>Journal of the Royal Statistical Society: Series B (Methodological)</em> 57 (1): 289–300. <a href="https://doi.org/10.1111/j.2517-6161.1995.tb02031.x">https://doi.org/10.1111/j.2517-6161.1995.tb02031.x</a>.
</div>
<div id="ref-feise2002" class="csl-entry" role="listitem">
Feise, R. J. 2002. <span>„Do multiple outcome measures require p-value adjustment?“</span> <em>BMC Med Res Methodol</em> 2: 8. <a href="https://doi.org/10.1186/1471-2288-2-8">https://doi.org/10.1186/1471-2288-2-8</a>.
</div>
<div id="ref-holm1979" class="csl-entry" role="listitem">
Holm, Sture. 1979. <span>„A Simple Sequentially Rejective Multiple Test Procedure“</span>. Journal Article. <em>Scandinavian Journal of Statistics</em> 6 (2): 65–70. <a href="https://D:/sciebo/database/3431.pdf">D:/sciebo/database/3431.pdf</a>.
</div>
<div id="ref-kelley2003" class="csl-entry" role="listitem">
Kelley, Ken, und Scott E Maxwell. 2003. <span>„Sample size for multiple regression: obtaining regression coefficients that are accurate, not simply significant.“</span> <em>Psychological methods</em> 8 (3): 305.
</div>
<div id="ref-rothman1990" class="csl-entry" role="listitem">
Rothman, K. J. 1990. <span>„No adjustments are needed for multiple comparisons“</span>. <em>Epidemiology</em> 1 (1): 43–46.
</div>
<div id="ref-searle1980" class="csl-entry" role="listitem">
Searle, S. R., F. M. Speed, und G. A. Milliken. 1980. <span>„Population Marginal Means in the Linear Model: An Alternative to Least Squares Means“</span>. Journal Article. <em>The American Statistician</em> 34 (4): 216–21. <a href="https://doi.org/10.2307/2684063">https://doi.org/10.2307/2684063</a>.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Außer wenn <span class="math inline">\(K=3\)</span><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Kopiert");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Kopiert");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ed_crd.html" class="pagination-link" aria-label="Completely Randomized Design">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Completely Randomized Design</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ed_crfd.html" class="pagination-link" aria-label="Completely Randomized Factorial Design">
        <span class="nav-page-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Completely Randomized Factorial Design</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>