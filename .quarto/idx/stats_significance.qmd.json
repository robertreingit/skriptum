{"title":"Statistische Signifikanz, p-Wert und Power","markdown":{"headingText":"Statistische Signifikanz, p-Wert und Power","containsRefs":false,"markdown":"\n```{r}\n#| echo: false\n#| warning: false\n#| message: false\nsource('_common.R')\n```\n```{r stats_significance_defs}\nn <- 20\nset.seed(123)\nworld <- tibble(ID = paste0('P',stringr::str_pad(1:n, width=2, pad=\"0\")),\n                Kraft = sample(2000:2500, n))\nworld$Kraft[13] <- 1800\nworld$Kraft[17] <- 3200\nd_gr <- 100\nd_x <- 2 \n```\n\n\n## Mit welcher Stichprobenverteilung arbeite ich denn jetzt?\n\n```{r}\n#| fig.cap: \"Mehrer mögliche Verteilungen\"\n\ndat_0s <- tibble(\n  x = seq(-10, 10, length.out=100),\n  v0 = dnorm(x, 0, 1),\n  v1 = dnorm(x, -4, 1),\n  v2 = dnorm(x, 3, 1),\n  v3 = dnorm(x, 5, 1))  %>% \n  tidyr::pivot_longer(-x, names_to=\"Verteilung\", values_to=\"v\")\nggplot(dat_0s, aes(x,v,ymin=0, ymax=v, fill=Verteilung)) +\n  geom_ribbon(alpha=.5) +\n  geom_line() +\n  labs(x = 'Werte', y = 'Dichte') \n```\n\n## Mit der Verteilung die annimmt das nichts passiert!\n\n```{r}\n#| fig.cap: \"Verteilung wenn nichts passiert.\"\n\nd_x <- 0.025\nx <- seq(-3, 3, d_x)\ndat_0 <- tibble(\n  x = x,\n  v = dnorm(x, 0, 1) \n)\n\nggplot(dat_0, aes(x,v,ymin=0, ymax=v)) +\n  #geom_area(data = low, fill='red', alpha=.8) +\n  #geom_area(data = up, fill='red', alpha=.8) +\n  geom_line() +\n  labs(x = 'Werte', y = 'Dichte') \n```\n\n```{r}\n#| fig.cap: \"Quantilefunktion wenn nichts passiert.\"\n\nxx <- seq(0,1,0.01)\nn_pts <- length(xx)\ndat_4 <- tibble(\n  x = xx,\n  v = qnorm(xx) \n)\nggplot(dat_4, aes(x,v,ymin=0, ymax=v)) +\n  geom_line() +\n  labs(x = 'Quantile', y = 'Werte') \n```\n\n## *Signifikanter* Wert\n\n```{r}\n#| fig.cap: \"Verteilung wenn nichts passiert und kritische Regionen.\"\nlow <- tibble(x = seq(-3, -2, length.out=50), v = dnorm(x))\nup <- tibble(x = seq(2, 3, length.out=50), v = dnorm(x))\nggplot(dat_0, aes(x,v,ymin=0, ymax=v)) +\n  geom_area(fill='green', alpha=.5) +\n  geom_area(data = low, fill='red', alpha=.8) +\n  geom_area(data = up, fill = 'red', alpha=.8) +\n  geom_vline(xintercept = c(-2,2), color='red', linetype='dashed') +\n  geom_label(data = tibble(x = c(-2,2), v = 0.3,\n                           labels=c(expression(k[lower]),\n                                    expression(k[upper]))),\n             aes(x,v,label=labels), parse=T) +\n  geom_line() +\n  labs(x = 'Werte', y = 'Dichte') \n```\n\nWenn der Stichprobenwert der Statistik in der *kritischen* Region auftritt, dann wird von einem **statistisch** signifikanten Effekt gesprochen. *Unter der $H_0$ bin ich überrascht diesen Wert zu sehen!*\n\n## Der p-Wert\n\n```{r}\n#| fig.cap: \"Der gelben Flächen zeigen den p-Wert für den Wert der Statistik von d = 2,5 an.\"\n\np_val <- 2.5\np_dat_up <- tibble(\n  x = seq(p_val, 3, length.out=40),\n  v = dnorm(x)\n)\np_dat_low <- tibble(\n  x = seq(-3, -p_val, length.out=40),\n  v = dnorm(x)\n)\nggplot(dat_0, aes(x,v,ymin=0, ymax=v)) +\n  geom_area(data = low, fill='red', alpha=.8) +\n  geom_area(data = up, fill='red', alpha=.8) +\n  geom_area(data = p_dat_low, fill='yellow', alpha=0.9) +\n  geom_area(data = p_dat_up, fill='yellow', alpha=0.9) +\n  geom_vline(xintercept = c(-2,2), color='red', linetype='dashed') +\n  geom_label(data = tibble(x = c(-2,2), v = 0.3,\n                           labels=c(expression(k[lower]),\n                                    expression(k[upper]))),\n             aes(x,v,label=labels), parse=T) +\n  geom_line() +\n  geom_point(data = tibble(x = p_val, v = 0), size=2) +\n  labs(x = 'Werte', y = 'Dichte') \n```\n\n## p-Werte\n\nDer p-Wert gibt die Wahrscheinlichkeit für den gefundenen oder einen noch extremeren Wert unter der $H_0$ an.\n\n\n```{r}\n#| fig.cap=\"Verschiedene P-Werte\"\n\nfoo <- function(p, lo=-3, up=3, d_x=0.025) {\n  len <- 40\n  x <- c(seq(lo, -abs(p), length.out=len))\n  tibble(x, v= dnorm(x), type=p)\n}\nfoo2 <- function(p, lo=-3, up=3, d_x=0.025) {\n  len <- 40\n  x <- c(seq(abs(p), up, length.out=len))\n  tibble(x, v= dnorm(x), type=p)\n}\np_s <- c(-2.7, -1.13, 0.7, 2.1) \np_vals <- round(2*(1 - pnorm(abs(p_s))),2)\ndat_3 <- purrr::map_dfr(p_s, foo)\ndat_3_up <- purrr::map_dfr(p_s, foo2)\nggplot(dat_3, aes(x,v,ymin=0, ymax=v)) +\n  geom_ribbon(alpha=0.5) +\n  geom_ribbon(data=dat_3_up, alpha=0.5) +\n  geom_line(data=dat_0) +\n  geom_point(data = tibble(x=p_s, v=0,type=p_s), color='red') +\n  facet_grid(~type, labeller=as_labeller(function(p){\n    paste(\"Statistik = \", p, \"\\np-Wert = \", p_vals[which(p_s == p)])\n  })) +\n  labs(x = 'Werte', y = 'Dichte') + \n  scale_x_continuous(breaks=c(-3,0,3)) +\n  theme(strip.text = element_text(size=8))\n```\n\n## p-Werte\n\n*\"[A] p-value is the probability under a specified statistical model that a statistical summary of the data (e.g., the sample mean difference between two compared groups) would be equal to or more extreme than its observed value.\"* [@wasserstein2016, p.131]\n\n*\"[T]he P value is the probability of seeing data that are as weird or more weird than those that were\nactually observed.\"* [@christensen2018, p.38]\n\n## Signifikanter Wert - Das Kleingedruckte\n\n- **Vor** dem Experiment wird für ein $H_0$ ein $\\alpha$-Level angesetzt (per Konvention $\\alpha=0,05 = 5\\%$)\n- Anhand des $\\alpha$-Levels können **kritische Werte** ($k_{lower}, k_{upper}$) bestimmt werden. Diese bestimmen die Grenzen der **kritischen Regionen**.\n- Wenn der gemessene Wert w der Statistik in die kritische Region fällt, also $w \\leq k_{lower}$ oder $w \\geq k_{upper}$ gilt, dann wird von einem **statistisch** signifikanten Wert gesprochen und die dazugehörige Hypothese wird **abgelehnt**. Äquivalent: Der p-Wert ist kleiner als $\\alpha$.\n- Da in $\\alpha$-Fällen ein Wert in der kritischen Region auftritt, auch wenn die $H_0$ zutrifft, wird in $\\alpha$-Fällen ein $\\alpha$-Fehler gemacht.\n\n## Signifikanter Wert - Das Kleingedruckte\n\n- Wenn der Wert w der Statistik nicht in den kritischen Regionen liegt, oder gleichwertig der p-Wert größer als $\\alpha$ ist, wird die $H_0$ **beibehalten**. D.h. nicht, dass **kein Effekt** vorliegt, sondern lediglich, dass anhand der Daten keine Evidenz diesbezüglich gefunden werden konnte!\n- Die **statistische** Signifikanz sagt nichts über die Wahrscheinlichkeit der Theorie aus!\n- Ein p-Wert von $p = 0.0001$ heißt nicht, dass mit 99,99\\% Wahrscheinlichkeit ein Effekt vorliegt!\n- *Statistisch* signifikant heißt nicht automatisch *praktisch* relevant!\n\n## Nochmal, wenn die $H_0$ nicht abgelehnt wird\n\n![Ausschnitt aus @altman1995](pics/altman_1995.png){height=6cm}\n\n## Nochmal p-Wert (@wasserstein2016)\n\n1. P-values can indicate how incompatible the data are with a specified statistical model.\n2. P-values do not measure the probability that the studied hypothesis is true, or the probability that the data were produced by random chance alone.\n3. Scientific conclusions and business or policy decisions should not be based only on whether a p-value passes a specific threshold.\n4. Proper inference requires full reporting and transparency\n5. A p-value, or statistical significance, does not measure the size of an effect or the importance of a result.\n6. By itself, a p-value does not provide a good measure of evidence regarding a model or hypothesis.\n\n## Was passiert nun aber wenn die \"andere\" Hypothese zutrifft? \n\n```{r}\n#| fig.cap: \"Differenzen mit kritischen Regionen (rot) mit einer Wahrscheinlichkeit von $\\\\alpha$ wenn $H_0$ zutrifft.\"\n\ndifferences <- readr::read_csv('data/combinations_differences.csv')\nn_sim <- dim(differences)[1]\nsigma <- sd(differences$d)\nxx <- -750:1250\nn_pts <- length(xx)\nq_crit <- qnorm(0.975, 0, sd = sigma)\ndat_power <- tibble(\n  x = rep(xx,2),\n  y = c(dnorm(xx,0,sigma), dnorm(xx,500,sigma)),\n  hypo = rep(c(\"H0\",\"H500\"), c(n_pts, n_pts))\n)\nlow <- tibble(x = seq(-750,-q_crit), y = dnorm(x, 0, sigma), hypo='H50')\nup <- tibble(x = seq(q_crit, 750), y = dnorm(x, 0, sigma), hypo='H50')\nggplot(dat_power, aes(x,y,fill=hypo,ymin=0,ymax=y)) +\n  geom_ribbon(alpha=.5) +\n  geom_area(data = up, fill='red', alpha=0.8) +\n  geom_area(data = low, fill='red', alpha=.8) +\n  geom_line() +\n  scale_fill_discrete('Hypothese') +\n  labs(x = 'Differenzen[N]', y = 'relative Häufigkeit') \n```\n\n## Wir machen einen $\\beta$-Fehler! \n```{r}\n#| fig.cap: \"Differenzen mit kritischen Regionen (rot) mit einer Wahrscheinlichkeit von $\\\\alpha$ wenn $H_0$ zutrifft und $\\\\beta$ (grün) wenn $H_1$ zutrifft.\"\n\nbeta <- tibble(\n  x = -300:q_crit,\n  y = dnorm(x, 500, sigma)\n)\nggplot(dat_power, aes(x,y,fill=hypo,ymin=0,ymax=y)) +\n  geom_ribbon(alpha=.5) +\n  geom_area(data = up, fill='red', alpha=0.8) +\n  geom_area(data = low, fill='red', alpha=.8) +\n  geom_area(data = beta, fill='green', alpha=0.5) +\n  geom_line() +\n  scale_fill_discrete('Hypothese') +\n  labs(x = 'Differenzen[N]', y = 'relative Häufigkeit') \n```\n\n## Snap!(1989) - The Power\n\n```{r}\n#| fig.cap: \"$1-\\\\beta$ = Power des Tests (blaue Fläche).\"\n\nbeta <- tibble(\n  x = -300:q_crit,\n  y = dnorm(x, 500, sigma)\n)\npower <- tibble(\n  x = q_crit:max(dat_power$x),\n  y = dnorm(x, 500, sigma)\n)\nggplot(dat_power, aes(x,y,fill=hypo,ymin=0,ymax=y)) +\n  geom_ribbon(alpha=.5) +\n  geom_area(data = up, fill='red', alpha=0.8) +\n  geom_area(data = low, fill='red', alpha=.8) +\n  geom_area(data = beta, fill='green', alpha=0.5) +\n  geom_area(data = power, fill='blue', alpha=0.5) +\n  geom_line() +\n  scale_fill_discrete('Hypothese') +\n  labs(x = 'Differenzen[N]', y = 'relative Häufigkeit') \n```\n\n## Terminologie noch mal\n\n- $\\alpha$: Die Wahrscheinlichkeit sich gegen die $H_0$ zu entscheiden, wenn die $H_0$ zutrifft. $\\alpha$-Level wird vor dem Experiment festgelegt um zu kontrollieren welche Fehlerrate toleriert wird.\n- $\\beta$: Die Wahrscheinlichkeit sich gegen die $H_1$ zu entscheiden, wenn die $H_1$ zutrifft.\n- Power := $1 - \\beta$: Die Wahrscheinlichkeit sich für die $H_1$ zu entscheiden, wenn die $H_1$ zutrifft. Sollte ebenfalls **vor** dem Experiment festgelegt werden.\n\n\n## Wie können wir die Power erhöhen? \n\n```{r}\n#| fig.cap: \"Verteilungen wenn $\\\\delta$=500 und $\\\\delta$=0 in unserem kleine Welt Beispiel mit n = 3.\"\n\ndat <- tibble(\n  di = c(differences$d + 500, differences$d),\n  hypo = rep(c('H500','H0'), c(n_sim,n_sim))\n)\np_h500 <- ggplot(dat, aes(di, fill=hypo)) +\n  geom_density(alpha=0.5) +\n  labs(x = 'Differenzen[N]', y = 'relative Häufigkeit') +\n  scale_fill_discrete(\"Hypothese\", labels=c(\n    expression(H[0]  ), expression(H[500])\n  ))\nprint(p_h500)\n```\n\n\n## Stichprobengröße von n = 3 auf n = 9 erhöhen?\n\n```{r}\n#| fig.cap: \"Stichprobenverteilungen der Differenz unter $H_0$ und $H_1:\\\\delta=500$N bei einer Stichprobengröße von n = 9\"\n\nsample_k9 <- readr::read_csv('data/sample_k9.csv')\nsigma <- sample_k9$sd[1]\nd <- sample_k9$m[2]\nxx = seq(-4*sigma,d+4*sigma)\nn_pts = length(xx)\ndat_k9 <- tibble(\n  x = rep(xx,2),\n  y = c(dnorm(xx, 0, sigma), dnorm(xx, d, sigma)),\n  hypo = rep(c('H0','H500'), c(n_pts, n_pts))\n)\nggplot(dat_k9, aes(x,y,fill=hypo, ymin=0, ymax=y)) +\n  geom_ribbon(alpha=0.5) +\n  geom_line() +\n  scale_fill_discrete(\"Hypothese\", labels=c(\n    expression(H[0]  ), expression(H[500])\n  )) +  \n  lims(x = c(-750, 1250)) +\n  labs(x = 'Differenzen[N]', y = 'relative Häufigkeiten') \n```\n\n## Standardfehler \n\nDie Standardabweichung der Statistik wird als **Standardfehler** $s_e$ bezeichnet^[Der Standardfehler schätzt die Reliabilität der Statistik ab (@cohen1988)]. Der Standardfehler ist nicht gleich der Standardabweichung in der Population bzw. der Stichprobe. Es gilt für den Mittelwert:\n\n\n\\begin{table}[]\n    \\caption{Standardfehler des Mittelwerts, n = Stichprobengröße}\n    \\centering\n    \\begin{tabular}{ll}\n     \\toprule\n     Population & Stichprobe \\\\\n     \\midrule\n     $\\sigma_{\\bar{X}} =  \\sqrt{\\frac{\\sigma^2}{n}} = \\frac{\\sigma}{\\sqrt{n}}$ & \n     $ s_e =  \\sqrt{\\frac{s^2}{n}} = \\frac{s}{\\sqrt{n}}$ \\\\ \n     \\bottomrule\n    \\end{tabular}\n    \\label{tab:s_e}\n\\end{table}\n\n\n\n# Parameterschätzung \n\n## Problem bei einer dichotomen Betrachtung der Daten\n\n![Auszug aus @cumming2013 [p.1]](../pics/cumming_luck.png)\n\n\n## Wie groß ist der Effekt? \n\n```{r}\n#| fig.cap: \"Stichprobenverteilungen der Differenz unter $H_0$ und $H_1:\\\\delta=500$N bei einer Stichprobengröße von n = 9\"\n\nd_x <- 2 \nsigma <- sample_k9$sd[1]\nd <- sample_k9$m[2]\nxx = seq(-4*sigma,d+4*sigma)\nn_pts = length(xx)\ndat_k9 <- tibble(\n  x = rep(xx,2),\n  y = c(dnorm(xx, 0, sigma), dnorm(xx, d, sigma)),\n  hypo = rep(c('H0','H500'), c(n_pts, n_pts))\n)\nggplot(dat_k9, aes(x,y,fill=hypo, ymin=0, ymax=y)) +\n  geom_ribbon(alpha=0.5) +\n  geom_line() +\n  scale_fill_discrete(\"Hypothese\", labels=c(\n    expression(H[0]  ), expression(H[500])\n  )) +  \n  lims(x = c(-750, 1250)) +\n  labs(x = 'Differenzen[N]', y = 'relative Häufigkeiten') \n```\n\n\n## Schätzung der Populationsparameter\n\n```{r}\nalpha <- 0.05\ndelta <- 500\nmu <- delta\nd_hat <- 350\ns_hat <- 132\ns_e <- round(s_hat/sqrt(9))\nc_i <- d_hat + c(-1,1)*qnorm(1-alpha/2)*s_e\n```\n\nKleine Welt: Experiment wird einmal mit n = 9 durchgeführt \n\n### Beobachtete Stichprobenkennwerte\n\n\\begin{align*}\nd = \\bar{x}_{treat} - \\bar{x}_{con} &= `r d_hat` \\\\\ns &= `r s_hat` \\\\\ns_e &= `r s_e`\n\\end{align*}\n\nWie präzise ist meine Schätzung und welche anderen Unterschiedswerte sind anhand der beobachteten Daten noch plausibel?\n\n## Welche $\\delta$s sind plausibel für $d = `r d_hat`$? \n\n```{r}\n#| fig.cap: \"Verschiedene Verteilungen von Gruppendifferenzen, beobachteter Unterschied (rot)\"\n\ncut_h <- 0.00002\ndat_con <- tibble(\n  x = seq(-500, 1000, length.out=200),\n  d0 = dnorm(x, 0, s_e),\n  dm75 = dnorm(x, -75, s_e),\n  d500 = dnorm(x, 500, s_e),\n  d350 = dnorm(x, 350, s_e),\n  d250 = dnorm(x, 250, s_e)\n) %>% tidyr::pivot_longer(-x, names_to=\"x_bar\", values_to=\"v\") %>% \n  dplyr::filter(v > cut_h)\nggplot(dat_con, aes(x,v,ymin=cut_h, ymax=v, fill=x_bar)) + \n  geom_line() +\n  geom_ribbon(alpha=0.3) +\n  geom_vline(xintercept = d_hat, col = 'red', linetype='dashed') +\n  scale_fill_discrete(\"Verteilungen\",\n                      breaks = c('d0', 'd500', 'd350', 'dm75', 'd250'),\n                      labels = c(expression(delta==0),\n                                 expression(delta==500),\n                                 expression(delta==350),\n                                 expression(delta==-75),\n                                 expression(delta==250))) +\n  labs(x = \"Differenz\", y = \"Dichte\") \n```\n\nPlausibel unter einem gegebenem **$\\alpha$-Level**!\n\n\n## Alle möglichen $\\delta$s die plausibel sind\n\n```{r}\n#| fig.cap: \"Konfidenzintervall (grün), Populationsparameter $\\\\delta$ und $\\\\alpha$-Level für die beobachtete Differenz (gelb).\"\n\nmu_s <- seq(150, 550, length.out=25) \nq_s <- qnorm(alpha, mu_s, s_e)\ndf <- tibble(mu_s = mu_s,\n             lu = qnorm(alpha/2,mu_s, s_e),\n             up = qnorm(1-alpha/2, mu_s, s_e)) %>%\n  dplyr::mutate(inside = dplyr::if_else(mu_s >= c_i[1] & mu_s <= c_i[2], 'ja', 'nein'))\nggplot(df, aes(x = mu_s, y = mu_s, ymin = lu, ymax = up, color = inside)) +\n  geom_hline(yintercept = d_hat, color = 'yellow') +\n  geom_hline(yintercept = c_i, color = 'green') +\n  geom_hline(yintercept = delta, color = 'black') +\n  geom_pointrange(size=0.3) +\n  labs(x = bquote('Mögliche'~delta), y = \"\") +\n  scale_color_manual(\"plausibel\", values = c('green','red')) +\n  scale_y_continuous(breaks = seq(50,700,50)) +\n  scale_x_continuous(breaks = NULL) +\n  annotate(\"text\", y=550,x=100,label=expression(delta==500), size=4) +\n  annotate(\"text\", y=400,x=100,label=expression(d==350), size=4) +\n  coord_flip() \n```\n\n## Was passiert wenn ich das Experiment ganz oft wiederhole?\n\n```{r}\n#| fig.cap: \"Simulation von $n = 100$ Konfidenzintervallen.\"\n#| cache: true\n\nfoo <- function(mu = 500, se = 132, n = 20, alpha = 0.05) {\n  sam <- rnorm(n, mu, se)\n  x_hat <- mean(sam)\n  s_e <- sd(sam)/sqrt(n)\n  q <- qnorm(alpha/2)\n  c(x_hat, x_hat + c(1,-1) * q * s_e)\n}\nN <- 100\nset.seed(2)\nc_is <- t(replicate(N, foo(mu, sigma, 20)))\ncolnames(c_is) <- c(\"x_hat\",\"lo\",\"up\")\ndf_2 <- as_tibble(c_is) %>% dplyr::mutate(id = dplyr::row_number(),\n                                   inside = dplyr::if_else((mu >= lo) & (mu <= up), 'ja','nein'))\nggplot(df_2, aes(id, x_hat, color = inside)) + \n  geom_pointrange(aes(ymin = lo, ymax = up), size=0.3) +\n  geom_hline(yintercept = mu, color = 'black') +\n  scale_color_manual(\"enthalten\", values = c('green','red')) +\n  labs(x = 'Experiment[#]', y = \"d\") +\n  coord_flip()\n```\n\n## Konfidenzintervall - Das Kleingedruckte\n\n- Das Konfidenzintervall für ein gegebenes $\\alpha$-Niveau gibt nicht die Wahrscheinlichkeit an mit der der *wahre* Parameter in dem Intervall liegt.\n- Das Konfidenzintervall gibt alle mit den Daten kompatiblen Populationsparameter an.\n- Das $\\alpha$-Niveau des Konfidenzintervalls gibt an bei welchem Anteil von Wiederholungen davon auszugehen ist, das das Konfidenzintervall den wahren Populationsparameter enthält. \n\n## Konfidenzintervall herleiten nach @spiegelhalter2019 [p.241]\n\\scriptsize\n1. We use probability theory to tell us, for any particular population\nparameter, an interval in which we expect the observed statistic to lie\nwith 95% probability.\n2. Then we observe a particular statistic.\n3. Finally (and this is the difficult bit) we work out the range of possible\npopulation parameters for which our statistic lies in their 95\\%\nintervals. This we call a \"95\\% confidence interval\".\n4. This resulting confidence interval is given the label \"95\\%\" since, with\nrepeated application, 95% of such intervals should contain the true\nvalue.^[Strictly speaking, a 95\\% confidence interval does ***not*** mean there is a 95\\% probability that this particular interval contains the true value [...]]\n\nAll clear? If it isn’t, then please be reassured that you have joined\ngenerations of baffled students.\n\n\n## Konfidenzintervall berechnen (Vorschau)\n\n$$\n\\textrm{CI}_{1-\\alpha} = \\bar{x} \\pm z_{\\alpha/2} \\times s_e \n$$\n\n\n## Dualität von Signifikanztests und Konfidenzintervall\n\nWenn das Konfidenzintervall mit Niveau $1-\\alpha\\%$ die $H_0$ nicht beinhaltet, dann wird auch bei einem Signifikanztest die $H_0$ bei einer Irrtumswahrscheinlichkeit von $\\alpha$ abgelehnt.\n\n\n\n\n## Verteilungen\n```{r}\n#| fig.cap: \"Eine Dichtefunktion\"\n\nd_x <- 0.025\nx <- seq(-3, 3, d_x)\ndat_0 <- tibble(\n  x = x,\n  v = dnorm(x, 0, 1) \n)\nlow <- tibble(\n  x = seq(-3,-2,d_x),\n  v = dnorm(x, 0, 1)\n)\nup <- tibble(\n  x = seq(2, 3, d_x),\n  v = dnorm(x, 0, 1)\n)\nggplot(dat_0, aes(x,v,ymin=0, ymax=v)) +\n  geom_area(fill='green', alpha=.5) +\n  geom_line() +\n  labs(x = 'Werte', y = 'Dichte') \n```\n\n## Eigenschaften von Verteilungen - Mittelwert $\\mu$\n```{r}\n#| fig.cap: \"Verteilungen mit unterschiedlichen Mittelwerten\"\n\nxx <- seq(-3,6,d_x)\nn_pts <- length(xx)\ndat_1 <- tibble(\n  x = rep(xx,2),\n  v = c(dnorm(xx, 0, 1),\n        dnorm(xx, 3, 1)),\n  pos = rep(c('x0','x3'), c(n_pts,n_pts))\n)\nggplot(dat_1, aes(x,v,ymin=0, ymax=v, fill=pos)) +\n  geom_ribbon(alpha=.5) +\n  geom_line() +\n  labs(x = 'Werte', y = 'Dichte') +\n  scale_fill_discrete(\"Lageparameter\",\n                      labels = c(expression(mu == 0), expression(mu == 3))) \n```\n\n^[auch Lageparameter oder Erwartungswert]\n\n## Eigenschaften von Verteilungen - Varianz $\\sigma^2$\n```{r}\n#| fig.cap: \"Verteilungen mit unterschiedlichen Varianzen\"\n\nxx <- seq(-5,5,d_x)\nn_pts <- length(xx)\ndat_2 <- tibble(\n  x = rep(xx,2),\n  v = c(dnorm(xx, 0, 1),\n        dnorm(xx, 0, sqrt(2))),\n  type = rep(c('s1','s0.5'), c(n_pts,n_pts))\n)\nggplot(dat_2, aes(x,v,ymin=0, ymax=v,fill=type)) +\n  geom_ribbon(alpha=.5) +\n  geom_line() +\n  labs(x = 'Werte', y = 'Dichte') +\n  scale_fill_discrete(\"Varianz\",labels = c(\n    expression(sigma^2 == 2),\n    expression(sigma^2 == 1)\n  )) \n```\n\n^[auch Skalenparameter]\n\n## Formeln \n\n\\begin{table}[]\n    \\caption{Parameter einer Verteilung und deren Sch\\\"atzer}\n    \\centering\n    \\begin{tabular}{llr}\n     \\toprule\n     Population & Stichprobe & \\\\\n     \\midrule\n     Mittelwert $\\mu$ & $\\bar{x} = \\frac{1}{n}\\sum_{i=1}^n x_i$  \\\\\n     Varianz $\\sigma^2$ & $s^2 = \\frac{1}{n-1}\\sum_{i=1}^n (x_i - \\bar{x})^2$ \\\\\n     Standardabweichung $\\sigma$ & $s = \\sqrt{s^2}$ \\\\\n     \\bottomrule\n    \\end{tabular}\n\\end{table}\n\nn := Anzahl der Stichprobenelemente, $x_i$ := Messwerte\n\n\n## Nebenbei: Warum der Mittelwert Sinn macht\n```{r}\n#| fig.cap: \"Verteilung der Mittelwerte von Stichproben der Größe $n=10$, Kleine Welt Population $\\\\mu$ (rot)\"\n\nbar <- function(world, k=3) {\n  n <- dim(world)[1]\n  x <- 1:n\n  N <- choose(n,k)\n  x_bars <- numeric(N)\n  # get all permutations\n  id_1 <- t(combn(x,k))\n  for (i in 1:nrow(id_1)) {\n    x_bars[i] <- mean(world$Kraft[id_1[i,]])\n  }\n  x_bars\n}\nx_bars <- bar(world, 10)\nmu <- mean(world$Kraft)\nggplot(tibble(x=x_bars),aes(x)) +\n  geom_histogram(aes(y = stat(density)), bins = 30) +\n  geom_vline(xintercept = mu,\n             color = 'red', linetype = 'dashed') +\n  labs(x = 'Mittelwerte[N]', y = 'Häufigkeit') \n```\n\n\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"stats_significance.html"},"language":{},"metadata":{"lang":"de","fig-responsive":true,"quarto-version":"1.2.258","bibliography":["bibliography.bib"],"theme":"cosmo","callout-icon":true},"extensions":{"book":{"multiFile":true}}},"pdf":{"execute":{"fig-width":5.5,"fig-height":4,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","include-in-header":{"text":"\\usepackage{makeidx,multirow}\n\\makeindex\n"},"include-after-body":{"text":"\\printindex\n"},"output-file":"stats_significance.pdf"},"language":{},"metadata":{"block-headings":true,"bibliography":["bibliography.bib"],"documentclass":"scrreprt"},"extensions":{"book":{}}}}}