{"title":"Inferenz","markdown":{"headingText":"Inferenz","containsRefs":false,"markdown":"\n```{r}\n#| echo: false\n#| warning: false\n#| message: false\nsource('_common.R')\n```\n\nNachdem das Modell gefittet wurde stellt sich die Frage ob tatsächlich ein Zusammenhang zwischen der Prädiktorvariable und der abhängigen Variable besteht. Da das einfache lineare Modelle zwei Parameter $\\beta_0$ und $\\beta_1$ beinhaltet (streng genommen ist $\\sigma^2$ ein dritter Parameter) kann diese Frage auf beide Koeffizienten angewendet werden.\n\nEine kurze Überlegung zeigt, dass wenn zwischen der Prädiktorvariablen und $y$ kein Zusammenhang besteht, dann sollte der Steigungskoeffizient $\\beta_1$ gleich Null sein bzw. auf Grund von Stichprobenvariabilität in der Nähe von Null sein. Daher ist eine plausible Hypothese die sich statistisch Überprüfung lässt:\n\n$$\nH_0: \\beta_1 = 0\n$$\n\n\n```{r defs_reg_02}\njump <- readr::read_delim('data/running_jump.csv',\n                          delim=';',\n                          col_types = 'dd')\nmod <- lm(jump_m ~ v_ms, jump)\n```\n\n\n## Inferenz\n\n### Modellannahmen\n\n\\begin{align*}\ny_i &= \\beta_0 + \\beta_1 x_i + \\epsilon_i \\quad i=1,\\ldots,N \\\\\n\\epsilon_i &\\sim N(0,\\sigma^2) \\quad \\textrm{identisch, unabhängig verteilt}\n\\end{align*}\n\n## Modellannahmen - Verteilung der Werte für gegebene x-Werte\n\n$$\nY|X \\sim N(\\beta_0+ \\beta_1 X,\\sigma^2)\n$$\n\n```{r}\n#| fig.cap: Verteilung der Daten für verschiedene $x$-Werte\n\ninclude_graphics('pics/Stats_Figures.png')\n```\n\n\n## Statistische Hypothesen\n\n### Ungerichtet\n\n\\begin{gather*}\nH_0: \\beta_1 = 0  \\\\\nH_1: \\beta_1 \\neq 0\n\\end{gather*}\n\n### Gerichtet\n\n\\begin{gather*}\nH_0: \\beta_1 \\leq 0  \\\\\nH_1: \\beta_1 > 0\n\\end{gather*}\n\n## Teststatistik informell herleiten\n\n### Simulation unter der $H_0$\n\n\\begin{align*}\nN &= 45 \\\\\nx &\\sim \\mathcal{U}(-1,1) \\\\\ny &\\sim \\mathcal{N}(0,\\sigma) \\\\\n\\sigma &= 1 \\\\\nH_0: & \\beta_1 = 0\n\\end{align*}\n\n## Teststatistik informell herleiten\n\n```{r}\n#| fig.cap=\"Acht Zufallsziehung unter der $H_0$\",\n \nset.seed(123)\nN <- 45 \nn <- 8\nr_dat <- data.frame(\n        x = rep(runif(N, -1, 1), n),\n        y = rnorm(n*N),\n        i = rep(1:n, each=N)\n      ) \nggplot(r_dat, aes(x,y)) + geom_point(size=.3) + \n  geom_smooth(method='lm', formula = y ~ x, se=F, col='red') +\n  scale_x_continuous(breaks = c(-0.5,0.5)) +\n  facet_wrap(~i, labeller = labeller(.cols = function(i) { paste('Ziehung', i)}), ncol=4) \n```\n\n## Stichprobenverteilung von $\\beta_1$ unter der Annahme $\\beta_1 = 0$ \n\n```{r}\n#| fig.cap=\"Verteilung der $\\\\beta_1$s - 1000 Simulationen unter der Annahme der $H_0$.\",\n#| fig.height=2.5\n\nset.seed(123)\nn <- 45\nN <- 1000\nx <- runif(n, -1, 1)\nsigma <- 1\nfoo <- function() {\n  y <- rnorm(n, mean = 0, sd = sigma)\n  mod <- lm(y~x)\n  b <- coef(mod)[2]\n  c(b, sigma(mod))\n}\n\nbetas <- replicate(N, foo())\nggplot(data.frame(b = betas[1,]), aes(b)) +\n  geom_histogram(aes(y = ..density..), bins = 20) +\n  labs(x = expression(beta[1]), y = 'Relative Häufigkeit') \n```\n\n## Verteilung der Statistik unter der $H_0$\n\n\n:::: columns\n::: column\n\n#### Standardfehler von $\\beta_1$ \n$$ \\sigma_{\\beta_1} = \\sqrt{\\frac{\\sigma^2}{\\sum{(X_i - \\bar{X})^2}}}$$\n\n$\\sigma$ lässt sich abschätzen mit:\n\n$$\n\\hat{\\sigma} = \\sqrt{\\sum_{i=1}^N e_i^2/(N-K)}\n$$\n:::\n::: column\n\n### in `R`\n\n```{r, echo=T}\nsigma(mod)\n```\n\n\n:::\n::::\n\n## Verteilung der Statistik unter der $H_0$\n\nUnter den Annahmen des Regressionsmodells und der $H_0$ gilt:\n\n$$\n\\frac{\\beta_1}{\\sigma_{\\beta_1}} \\sim t_{N-2}\n$$\n\nMittels $\\alpha$ lässt sich daher wieder ein kritischer Wert bestimmen ab dem die $H_0$ verworfen wird.\n\n\n\n## Teststatistik\n\n\n```{r}\n#| fig.cap=\"Verteilung von $\\\\frac{\\\\beta_1}{s_{\\\\beta_1}}$,Dichtefunktion der t-Verteilung (rot) mit $df = n - 2$\",\n#| fig.height=2.5\n#| \ns_e_beta_1 <- sqrt(betas[2,]**2/sum( (x - mean(x))**2))\ndf_2 <- tibble::tibble(\n  b = seq(-4,4,length.out=100),\n  y = dt(b, 23)\n)\nggplot(data.frame(b = betas[1,]/s_e_beta_1), aes(b)) +\n  geom_histogram(aes(y = ..density..), bins = 20) +\n  geom_line(data = df_2, aes(b,y), color='red') +\n  labs(x = expression(frac(hat(beta)[1],s[beta[1]])), y = 'Relative Häufigkeit') \n```\n\n## Verteilung der $\\hat{\\sigma} = \\sqrt{\\sum_{i=1}^N e_i^2/(N-K)}$\n\n```{r}\n#| fig.cap=\"Verteilung von $\\\\hat{\\\\sigma}$\",\n#| fig.height=2.5\n\nggplot(data.frame(b = betas[2,]), aes(b)) +\n  geom_histogram(aes(y = ..density..), bins = 20) +\n  geom_vline(xintercept = 1, col = 'red', linetype = 'dashed') +\n  labs(x = expression(hat(sigma)[i]), y = 'Relative Häufigkeit') \n```\n\n\n## Nochmal `summary()`\n\\tiny\n```{r, echo=T}\nsummary(mod)\n```\n\n## Konfidenzintervalle für die Koeffizienten\n\n### Formel\n\n$$\n\\hat{\\beta_j} \\pm q_{t_{\\alpha/2,df=N-2}} \\times \\hat{\\sigma}_{\\beta_j}\n$$\n\n### In R\n\n```{r, echo=T}\nconfint(mod)\n```\n\n## Zum Nacharbeiten\n\n@pos_simple_regression und @kutner2005 [p.40-48]\n\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"slm_inference.html"},"language":{},"metadata":{"lang":"de","fig-responsive":true,"quarto-version":"1.2.258","bibliography":["bibliography.bib"],"theme":"cosmo","callout-icon":true},"extensions":{"book":{"multiFile":true}}},"pdf":{"execute":{"fig-width":5.5,"fig-height":4,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","include-in-header":{"text":"\\usepackage{makeidx,multirow}\n\\makeindex\n"},"include-after-body":{"text":"\\printindex\n"},"output-file":"slm_inference.pdf"},"language":{},"metadata":{"block-headings":true,"bibliography":["bibliography.bib"],"documentclass":"scrreprt"},"extensions":{"book":{}}}}}