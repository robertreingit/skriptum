{"title":"Verteilungen","markdown":{"headingText":"Verteilungen","containsRefs":false,"markdown":"\n```{r}\n#| echo: false\n#| warning: false\n#| message: false\nsource('_common.R')\n```\n\n# Die Normalverteilung\n\n## Normalverteilung - $f(x|\\mu,\\sigma^2) = \\frac{1}{\\sqrt{2 \\pi \\sigma^2}}e^{\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right)}$\n\n```{r}\n#| fig.cap=\"Dichtefunktion der Normalverteilung mit\\nParametern $\\\\mu$ und $\\\\sigma$.\"\n\nx <- seq(-3, 3, 0.01)\np <- dnorm(x)\ndf <- data.frame(x, p) \nggplot(df, aes(x,p)) +\n  geom_ribbon(aes(ymin = 0, ymax = p), fill = 'red', alpha=.3) +\n  geom_line(size=2, col='red') + \n  labs(x = 'Werte', y = 'Dichte') \n```\n\n## Zentraler Grenzwertsatz oder *Warum die Normalverteilung überall auftaucht*.\n\nSeien $X_1, X_2, \\ldots, X_n$ n unabhängige, gleichverteilte Zufallsvariablen mit $E(X_i)=\\mu$ und $Var(X_i)=\\sigma^2$. \n$$\n \\lim_{n\\to\\infty}\\frac{\\bar{x} - \\mu}{\\frac{\\sigma}{\\sqrt{n}}}\\ \\rightarrow\\ \\mathcal{N}(\\mu=0,\\sigma^2=1)\n$$\n\n## Normalverteilung und Standardabweichung\n\n```{r}\n#| fig.cap=\"Dichtefunktion von $\\\\mathcal{N}(\\\\mu,\\\\sigma^2)$\"\n\nx <- seq(-4, 4, 0.01)\nsigma <- 1.3\nmu <- 0\np <- dnorm(x, mean = mu, sd = sigma)\ndf <- data.frame(x, p) \nlab_dat <- tibble(x = c(-3,-2,-1,1,2,3)*sigma, p = 0.05, \n                  labels = c(bquote(-3~sigma),bquote(-2~sigma), bquote(-sigma),\n                             'sigma',bquote(2~sigma),bquote(3~sigma)))\nggplot(df, aes(x,p, ymin = 0, ymax = p)) +\n#  geom_ribbon(aes(ymin = 0, ymax = p), fill = 'red', alpha=.3) +\n  geom_ribbon(data = tibble(x = seq(-1*sigma,1*sigma,0.01), p = dnorm(x, mu, sigma)), fill = 'green', alpha = .3) +\n  geom_ribbon(data = tibble(x = seq(-2*sigma,-1*sigma,0.01), p = dnorm(x, mu, sigma)), fill = 'magenta', alpha = .3) +\n  geom_ribbon(data = tibble(x = seq(1*sigma,2*sigma,0.01), p = dnorm(x, mu, sigma)), fill = 'magenta', alpha = .3) +\n  geom_ribbon(data = tibble(x = seq(2*sigma,3*sigma,0.01), p = dnorm(x, mu, sigma)), fill = 'blue', alpha = .3) +\n  geom_ribbon(data = tibble(x = seq(-3*sigma,-2*sigma,0.01), p = dnorm(x, mu, sigma)), fill = 'blue', alpha = .3) +\n  geom_line() + \n  geom_label(data = lab_dat, aes(x = x, label = labels), parse = T) +\n  scale_x_continuous(breaks=0, labels = expression(mu)) +\n  labs(x = 'Werte', y = 'Dichte') \n```\n\n## Normalverteilung und Standardabweichung\n\n\\begin{table}[]\n  \\caption{Wahrscheinlichkeiten P für verschiedene Bereiche der Normalverteilung.}\n  \\centering\n  \\begin{tabular}{ll}\n   \\toprule\n   Bereich & P \\\\\n   \\midrule\n    $[\\mu -\\sigma ,\\mu + \\sigma]$  & 0.682  \\\\\n    $[\\mu -2\\sigma,\\mu + 2\\sigma]$ & 0.955 \\\\\n    $[\\mu -3\\sigma,\\mu + 3\\sigma]$ & 0.997 \\\\\n    \\bottomrule\n  \\end{tabular}\n  \\label{tab:zscore}\n\\end{table}\n\n$$P(x\\in[\\mu-1.96\\sigma, \\mu+1.96\\sigma]) = 0.95$$\n\n\n\n## Standardnormalverteilung $\\phi(x)$\n\n```{r}\n#| fig.cap: \"Dichtefunktion der Standardnormalverteilung $\\\\phi(x)$ mit $\\\\mu=0$ und $\\\\sigma^2=1$\"\n\nx <- seq(-3, 3, 0.01)\nsigma <- 1\nmu <- 0\np <- dnorm(x, mean = mu, sd = sigma)\ndf <- data.frame(x, p) \nlab_dat <- tibble(x = c(-3,-2,-1,1,2,3)*sigma, p = 0.05, \n                  labels = c(bquote(-3~sigma),bquote(-2~sigma), bquote(-sigma),\n                             'sigma',bquote(2~sigma),bquote(3~sigma)))\nggplot(df, aes(x,p, ymin = 0, ymax = p)) +\n#  geom_ribbon(aes(ymin = 0, ymax = p), fill = 'red', alpha=.3) +\n  geom_ribbon(data = tibble(x = seq(-1*sigma,1*sigma,0.01), p = dnorm(x, mu, sigma)), fill = 'green', alpha = .3) +\n  geom_ribbon(data = tibble(x = seq(-2*sigma,-1*sigma,0.01), p = dnorm(x, mu, sigma)), fill = 'magenta', alpha = .3) +\n  geom_ribbon(data = tibble(x = seq(1*sigma,2*sigma,0.01), p = dnorm(x, mu, sigma)), fill = 'magenta', alpha = .3) +\n  geom_ribbon(data = tibble(x = seq(2*sigma,3*sigma,0.01), p = dnorm(x, mu, sigma)), fill = 'blue', alpha = .3) +\n  geom_ribbon(data = tibble(x = seq(-3*sigma,-2*sigma,0.01), p = dnorm(x, mu, sigma)), fill = 'blue', alpha = .3) +\n  geom_line(size=2) + \n  geom_label(data = lab_dat, aes(x = x, label = labels), parse = T) +\n  scale_x_continuous(breaks = -3:3) +\n  labs(x = 'Werte', y = 'Dichte') \n```\n\n\n## Abbildung N($\\mu$,$\\sigma$) auf N($0$,$1$) \n\n```{r}\n#| fig.cap: \"Standardnormalverteilung mit $\\\\mu=12, \\\\sigma^2=2$\"\n\nx <- seq(6, 18, 0.01)\np <- dnorm(x, 12, 2)\ndf <- data.frame(x, p) \nggplot(df, aes(x,p)) +\n  geom_ribbon(aes(ymin = 0, ymax = p), fill = 'red', alpha=.3) +\n  geom_line(size=2, col='red') + \n  labs(x = 'Werte', y = 'Dichte') +\n  lims(y = c(0,.5)) \n```\n\n```{r}\n#| fig.cap: \"Normalverteilung mit $\\\\mu=0, \\\\sigma=1$\"\n\nx <- seq(-6, 6, 0.01)\np <- dnorm(x)\ndf <- data.frame(x, p) \nggplot(df, aes(x,p)) +\n  geom_ribbon(aes(ymin = 0, ymax = p), fill = 'red', alpha=.3) +\n  geom_line(size=2, col='red') + \n  labs(x = 'Werte', y = 'Dichte') +\n  lims(y = c(0,.5)) \n```\n\n## z-Transformation allgemein bzw. Standardisierung \n\n\\begin{table}[]\n    \\caption{z-Transformation}\n    \\centering\n    \\begin{tabular}{ll}\n     \\toprule\n     Population & Stichprobe \\\\\n     \\midrule\n     $z = \\frac{x - \\mu}{\\sigma}$ & $z = \\frac{x - \\bar{x}}{s}$ \\\\\n     \\bottomrule\n    \\end{tabular}\n    \\label{tab:zscore}\n\\end{table}\n\\vspace{2cm}\n\n\n\n# Verteilungszoo\n\n## t-Verteilung\n\n```{r}\n#| fig.cap: \"Beispiel für verschiedene Dichtefunktionen der t-Verteilung\"\n\nn_fig_pts <- 130\nt_dist <- tibble(\n  x = seq(-5,5,length.out=n_fig_pts),\n  t1 = dt(x,1),\n  t3 = dt(x,3),\n  t10 = dt(x,10)\n) %>% tidyr::pivot_longer(-x, names_to='dist', values_to='v')\nggplot(t_dist, aes(x,v,fill=dist, ymin=0, ymax=v)) +\n  geom_ribbon(alpha=0.3) +\n  geom_line() + \n  scale_fill_discrete(\"Verteilungen\",\n                      breaks = c('t1', 't3', 't10'),\n                      labels = c(expression(df==1),\n                                 expression(df==3),\n                                 expression(df==10))) +\n  labs(x = 'Werte', y = 'Dichte') \n```\n\n\n## $\\chi^2$-Verteilung\n\n```{r}\n#| fig.cap: \"Beispiele für verschiedene Dichtefunktion der $\\\\chi^2$-Verteilung.\"\n\nchi_dist <- tibble(\n  x = seq(0, 10, length.out=n_fig_pts),\n  d1 = dchisq(x,1),\n  d2 = dchisq(x,3),\n  d3 = dchisq(x,5)\n) %>% tidyr::pivot_longer(-x, names_to='dist', values_to='v')\nggplot(chi_dist, aes(x,v,fill=dist, ymin=0, ymax=v)) +\n  geom_ribbon(alpha=0.3) +\n  geom_line() + \n  scale_fill_discrete(\"Verteilungen\",\n                      breaks = c('d1', 'd2', 'd3'),\n                      labels = c(expression(df==1),\n                                 expression(df==3),\n                                 expression(df==5))) +\n  labs(x = 'Werte', y = 'Dichte') \n```\n\n## F-Verteilung\n\n```{r}\n#| fig.cap: \"Beispiele für verschiedene Dichtefunktion der F-Verteilung.\"\n\nchi_dist <- tibble(\n  x = seq(0, 10, length.out=n_fig_pts),\n  d1 = df(x,1,1),\n  d2 = df(x,3,5),\n  d3 = df(x,10,10)\n) %>% tidyr::pivot_longer(-x, names_to='dist', values_to='v')\nggplot(chi_dist, aes(x,v,fill=dist, ymin=0, ymax=v)) +\n  geom_ribbon(alpha=0.3) +\n  geom_line() + \n  scale_fill_discrete(\"Verteilungen\",\n                      breaks = c('d1', 'd2', 'd3'),\n                      labels = c(expression(paste(df[1],\"=1,\",df[2],\"=1\")),\n                                 expression(paste(df[1],\"=3,\",df[2],\"=5\")),\n                                 expression(paste(df[1],\"=10,\",df[2],\"=10\")))) +\n  labs(x = 'Werte', y = 'Dichte') \n```\n\n\n\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":3,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"stats_distributions.html"},"language":{},"metadata":{"lang":"de","fig-responsive":true,"quarto-version":"1.2.258","bibliography":["bibliography.bib"],"theme":"cosmo","callout-icon":true},"extensions":{"book":{"multiFile":true}}},"pdf":{"execute":{"fig-width":5.5,"fig-height":4,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","include-in-header":{"text":"\\usepackage{makeidx,multirow}\n\\makeindex\n"},"include-after-body":{"text":"\\printindex\n"},"output-file":"stats_distributions.pdf"},"language":{},"metadata":{"block-headings":true,"bibliography":["bibliography.bib"],"documentclass":"scrreprt"},"extensions":{"book":{}}}}}